/*! For license information please see grumpycat.bundle.js.LICENSE.txt */
(()=>{var t={1983:(t,e,n)=>{"use strict";n(6266),n(990),n(911),n(4160),n(6197),n(6728),n(4039),n(3568),n(8051),n(8250),n(5434),n(4952),n(6337),n(5666)},6266:(t,e,n)=>{n(5767),n(8132),n(8388),n(7470),n(4882),n(1520),n(7476),n(9622),n(9375),n(3533),n(4672),n(4157),n(5095),n(9892),n(5115),n(9176),n(8838),n(6253),n(9730),n(6059),n(8377),n(1084),n(4299),n(1246),n(726),n(1901),n(5972),n(3403),n(2516),n(9371),n(6479),n(1736),n(1889),n(5177),n(6943),n(6503),n(6786),n(932),n(7526),n(1591),n(9073),n(347),n(579),n(4669),n(7710),n(5789),n(3514),n(9978),n(8472),n(6946),n(5068),n(413),n(191),n(8306),n(4564),n(9115),n(9539),n(6620),n(2850),n(823),n(7732),n(856),n(703),n(1539),n(5292),n(6629),n(3694),n(7648),n(7795),n(4531),n(3605),n(6780),n(9937),n(511),n(1822),n(9977),n(1031),n(6331),n(1560),n(774),n(522),n(8295),n(7842),n(110),n(75),n(4336),n(1802),n(8837),n(6773),n(5745),n(3057),n(3750),n(3369),n(9564),n(2e3),n(8977),n(2310),n(4899),n(1842),n(6997),n(3946),n(8269),n(6108),n(6774),n(1466),n(9357),n(6142),n(1876),n(851),n(8416),n(8184),n(147),n(9192),n(142),n(1786),n(5368),n(6964),n(2152),n(4821),n(9103),n(1303),n(3318),n(162),n(3834),n(1572),n(2139),n(685),n(5535),n(7347),n(3049),n(6633),n(8989),n(8270),n(4510),n(3984),n(5769),n(55),n(6014),t.exports=n(5645)},911:(t,e,n)=>{n(1268),t.exports=n(5645).Array.flatMap},990:(t,e,n)=>{n(2773),t.exports=n(5645).Array.includes},5434:(t,e,n)=>{n(3276),t.exports=n(5645).Object.entries},8051:(t,e,n)=>{n(8351),t.exports=n(5645).Object.getOwnPropertyDescriptors},8250:(t,e,n)=>{n(6409),t.exports=n(5645).Object.values},4952:(t,e,n)=>{"use strict";n(851),n(9865),t.exports=n(5645).Promise.finally},6197:(t,e,n)=>{n(2770),t.exports=n(5645).String.padEnd},4160:(t,e,n)=>{n(1784),t.exports=n(5645).String.padStart},4039:(t,e,n)=>{n(4325),t.exports=n(5645).String.trimRight},6728:(t,e,n)=>{n(5869),t.exports=n(5645).String.trimLeft},3568:(t,e,n)=>{n(9665),t.exports=n(8787).f("asyncIterator")},115:(t,e,n)=>{n(4579),t.exports=n(1327).global},5663:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},2159:(t,e,n)=>{var i=n(6727);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},1327:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},9216:(t,e,n)=>{var i=n(5663);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},9666:(t,e,n)=>{t.exports=!n(7929)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},7467:(t,e,n)=>{var i=n(6727),r=n(3938).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},3856:(t,e,n)=>{var i=n(3938),r=n(1327),o=n(9216),s=n(1818),a=n(7069),u=function(t,e,n){var l,h,c,f=t&u.F,d=t&u.G,p=t&u.S,v=t&u.P,y=t&u.B,g=t&u.W,m=d?r:r[e]||(r[e]={}),b=m.prototype,x=d?i:p?i[e]:(i[e]||{}).prototype;for(l in d&&(n=e),n)(h=!f&&x&&void 0!==x[l])&&a(m,l)||(c=h?x[l]:n[l],m[l]=d&&"function"!=typeof x[l]?n[l]:y&&h?o(c,i):g&&x[l]==c?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(c):v&&"function"==typeof c?o(Function.call,c):c,v&&((m.virtual||(m.virtual={}))[l]=c,t&u.R&&b&&!b[l]&&s(b,l,c)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},7929:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},3938:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},7069:t=>{var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},1818:(t,e,n)=>{var i=n(4743),r=n(3101);t.exports=n(9666)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},3758:(t,e,n)=>{t.exports=!n(9666)&&!n(7929)((function(){return 7!=Object.defineProperty(n(7467)("div"),"a",{get:function(){return 7}}).a}))},6727:t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},4743:(t,e,n)=>{var i=n(2159),r=n(3758),o=n(3206),s=Object.defineProperty;e.f=n(9666)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},3101:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},3206:(t,e,n)=>{var i=n(6727);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},4579:(t,e,n)=>{var i=n(3856);i(i.G,{global:n(3938)})},4963:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},3365:(t,e,n)=>{var i=n(2032);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=i(t))throw TypeError(e);return+t}},7722:(t,e,n)=>{var i=n(6314)("unscopables"),r=Array.prototype;null==r[i]&&n(7728)(r,i,{}),t.exports=function(t){r[i][t]=!0}},6793:(t,e,n)=>{"use strict";var i=n(4496)(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},3328:t=>{t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},7007:(t,e,n)=>{var i=n(5286);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},5216:(t,e,n)=>{"use strict";var i=n(508),r=n(2337),o=n(875);t.exports=[].copyWithin||function(t,e){var n=i(this),s=o(n.length),a=r(t,s),u=r(e,s),l=arguments.length>2?arguments[2]:void 0,h=Math.min((void 0===l?s:r(l,s))-u,s-a),c=1;for(u<a&&a<u+h&&(c=-1,u+=h-1,a+=h-1);h-- >0;)u in n?n[a]=n[u]:delete n[a],a+=c,u+=c;return n}},6852:(t,e,n)=>{"use strict";var i=n(508),r=n(2337),o=n(875);t.exports=function(t){for(var e=i(this),n=o(e.length),s=arguments.length,a=r(s>1?arguments[1]:void 0,n),u=s>2?arguments[2]:void 0,l=void 0===u?n:r(u,n);l>a;)e[a++]=t;return e}},9315:(t,e,n)=>{var i=n(2110),r=n(875),o=n(2337);t.exports=function(t){return function(e,n,s){var a,u=i(e),l=r(u.length),h=o(s,l);if(t&&n!=n){for(;l>h;)if((a=u[h++])!=a)return!0}else for(;l>h;h++)if((t||h in u)&&u[h]===n)return t||h||0;return!t&&-1}}},50:(t,e,n)=>{var i=n(741),r=n(9797),o=n(508),s=n(875),a=n(6886);t.exports=function(t,e){var n=1==t,u=2==t,l=3==t,h=4==t,c=6==t,f=5==t||c,d=e||a;return function(e,a,p){for(var v,y,g=o(e),m=r(g),b=i(a,p,3),x=s(m.length),w=0,_=n?d(e,x):u?d(e,0):void 0;x>w;w++)if((f||w in m)&&(y=b(v=m[w],w,g),t))if(n)_[w]=y;else if(y)switch(t){case 3:return!0;case 5:return v;case 6:return w;case 2:_.push(v)}else if(h)return!1;return c?-1:l||h?h:_}}},7628:(t,e,n)=>{var i=n(4963),r=n(508),o=n(9797),s=n(875);t.exports=function(t,e,n,a,u){i(e);var l=r(t),h=o(l),c=s(l.length),f=u?c-1:0,d=u?-1:1;if(n<2)for(;;){if(f in h){a=h[f],f+=d;break}if(f+=d,u?f<0:c<=f)throw TypeError("Reduce of empty array with no initial value")}for(;u?f>=0:c>f;f+=d)f in h&&(a=e(a,h[f],f,l));return a}},2736:(t,e,n)=>{var i=n(5286),r=n(4302),o=n(6314)("species");t.exports=function(t){var e;return r(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},6886:(t,e,n)=>{var i=n(2736);t.exports=function(t,e){return new(i(t))(e)}},4398:(t,e,n)=>{"use strict";var i=n(4963),r=n(5286),o=n(7242),s=[].slice,a={},u=function(t,e,n){if(!(e in a)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";a[e]=Function("F,a","return new F("+i.join(",")+")")}return a[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=s.call(arguments,1),a=function(){var i=n.concat(s.call(arguments));return this instanceof a?u(e,i.length,i):o(e,i,t)};return r(e.prototype)&&(a.prototype=e.prototype),a}},1488:(t,e,n)=>{var i=n(2032),r=n(6314)("toStringTag"),o="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),r))?n:o?i(e):"Object"==(s=i(e))&&"function"==typeof e.callee?"Arguments":s}},2032:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},9824:(t,e,n)=>{"use strict";var i=n(9275).f,r=n(2503),o=n(4408),s=n(741),a=n(3328),u=n(3531),l=n(2923),h=n(5436),c=n(2974),f=n(7057),d=n(4728).fastKey,p=n(1616),v=f?"_s":"size",y=function(t,e){var n,i=d(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,l){var h=t((function(t,i){a(t,h,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,null!=i&&u(i,n,t[l],t)}));return o(h.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),i=y(n,t);if(i){var r=i.n,o=i.p;delete n._i[i.i],i.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==i&&(n._f=r),n._l==i&&(n._l=o),n[v]--}return!!i},forEach:function(t){p(this,e);for(var n,i=s(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(p(this,e),t)}}),f&&i(h.prototype,"size",{get:function(){return p(this,e)[v]}}),h},def:function(t,e,n){var i,r,o=y(t,e);return o?o.v=n:(t._l=o={i:r=d(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=o),i&&(i.n=o),t[v]++,"F"!==r&&(t._i[r]=o)),t},getEntry:y,setStrong:function(t,e,n){l(t,e,(function(t,n){this._t=p(t,e),this._k=n,this._l=void 0}),(function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?h(0,"keys"==e?n.k:"values"==e?n.v:[n.k,n.v]):(t._t=void 0,h(1))}),n?"entries":"values",!n,!0),c(e)}}},3657:(t,e,n)=>{"use strict";var i=n(4408),r=n(4728).getWeak,o=n(7007),s=n(5286),a=n(3328),u=n(3531),l=n(50),h=n(9181),c=n(1616),f=l(5),d=l(6),p=0,v=function(t){return t._l||(t._l=new y)},y=function(){this.a=[]},g=function(t,e){return f(t.a,(function(t){return t[0]===e}))};y.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var n=g(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=d(this.a,(function(e){return e[0]===t}));return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var l=t((function(t,i){a(t,l,e,"_i"),t._t=e,t._i=p++,t._l=void 0,null!=i&&u(i,n,t[o],t)}));return i(l.prototype,{delete:function(t){if(!s(t))return!1;var n=r(t);return!0===n?v(c(this,e)).delete(t):n&&h(n,this._i)&&delete n[this._i]},has:function(t){if(!s(t))return!1;var n=r(t);return!0===n?v(c(this,e)).has(t):n&&h(n,this._i)}}),l},def:function(t,e,n){var i=r(o(e),!0);return!0===i?v(t).set(e,n):i[t._i]=n,t},ufstore:v}},5795:(t,e,n)=>{"use strict";var i=n(3816),r=n(2985),o=n(7234),s=n(4408),a=n(4728),u=n(3531),l=n(3328),h=n(5286),c=n(4253),f=n(7462),d=n(2943),p=n(266);t.exports=function(t,e,n,v,y,g){var m=i[t],b=m,x=y?"set":"add",w=b&&b.prototype,_={},k=function(t){var e=w[t];o(w,t,"delete"==t||"has"==t?function(t){return!(g&&!h(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!h(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(g||w.forEach&&!c((function(){(new b).entries().next()})))){var T=new b,E=T[x](g?{}:-0,1)!=T,S=c((function(){T.has(1)})),A=f((function(t){new b(t)})),P=!g&&c((function(){for(var t=new b,e=5;e--;)t[x](e,e);return!t.has(-0)}));A||((b=e((function(e,n){l(e,b,t);var i=p(new m,e,b);return null!=n&&u(n,y,i[x],i),i}))).prototype=w,w.constructor=b),(S||P)&&(k("delete"),k("has"),y&&k("get")),(P||E)&&k(x),g&&w.clear&&delete w.clear}else b=v.getConstructor(e,t,y,x),s(b.prototype,n),a.NEED=!0;return d(b,t),_[t]=b,r(r.G+r.W+r.F*(b!=m),_),g||v.setStrong(b,t,y),b}},5645:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},2811:(t,e,n)=>{"use strict";var i=n(9275),r=n(681);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},741:(t,e,n)=>{var i=n(4963);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},3537:(t,e,n)=>{"use strict";var i=n(4253),r=Date.prototype.getTime,o=Date.prototype.toISOString,s=function(t){return t>9?t:"0"+t};t.exports=i((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!i((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(r.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),i=e<0?"-":e>9999?"+":"";return i+("00000"+Math.abs(e)).slice(i?-6:-4)+"-"+s(t.getUTCMonth()+1)+"-"+s(t.getUTCDate())+"T"+s(t.getUTCHours())+":"+s(t.getUTCMinutes())+":"+s(t.getUTCSeconds())+"."+(n>99?n:"0"+s(n))+"Z"}:o},870:(t,e,n)=>{"use strict";var i=n(7007),r=n(1689),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return r(i(this),t!=o)}},1355:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},7057:(t,e,n)=>{t.exports=!n(4253)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},2457:(t,e,n)=>{var i=n(5286),r=n(3816).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},4430:t=>{t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},5541:(t,e,n)=>{var i=n(7184),r=n(4548),o=n(4682);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var s,a=n(t),u=o.f,l=0;a.length>l;)u.call(t,s=a[l++])&&e.push(s);return e}},2985:(t,e,n)=>{var i=n(3816),r=n(5645),o=n(7728),s=n(7234),a=n(741),u=function(t,e,n){var l,h,c,f,d=t&u.F,p=t&u.G,v=t&u.S,y=t&u.P,g=t&u.B,m=p?i:v?i[e]||(i[e]={}):(i[e]||{}).prototype,b=p?r:r[e]||(r[e]={}),x=b.prototype||(b.prototype={});for(l in p&&(n=e),n)c=((h=!d&&m&&void 0!==m[l])?m:n)[l],f=g&&h?a(c,i):y&&"function"==typeof c?a(Function.call,c):c,m&&s(m,l,c,t&u.U),b[l]!=c&&o(b,l,f),y&&x[l]!=c&&(x[l]=c)};i.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},8852:(t,e,n)=>{var i=n(6314)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},4253:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},8082:(t,e,n)=>{"use strict";n(8269);var i=n(7234),r=n(7728),o=n(4253),s=n(1355),a=n(6314),u=n(1165),l=a("species"),h=!o((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),c=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var f=a(t),d=!o((function(){var e={};return e[f]=function(){return 7},7!=""[t](e)})),p=d?!o((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[l]=function(){return n}),n[f](""),!e})):void 0;if(!d||!p||"replace"===t&&!h||"split"===t&&!c){var v=/./[f],y=n(s,f,""[t],(function(t,e,n,i,r){return e.exec===u?d&&!r?{done:!0,value:v.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}})),g=y[0],m=y[1];i(String.prototype,t,g),r(RegExp.prototype,f,2==e?function(t,e){return m.call(t,this,e)}:function(t){return m.call(t,this)})}}},3218:(t,e,n)=>{"use strict";var i=n(7007);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},3325:(t,e,n)=>{"use strict";var i=n(4302),r=n(5286),o=n(875),s=n(741),a=n(6314)("isConcatSpreadable");t.exports=function t(e,n,u,l,h,c,f,d){for(var p,v,y=h,g=0,m=!!f&&s(f,d,3);g<l;){if(g in u){if(p=m?m(u[g],g,n):u[g],v=!1,r(p)&&(v=void 0!==(v=p[a])?!!v:i(p)),v&&c>0)y=t(e,n,p,o(p.length),y,c-1)-1;else{if(y>=9007199254740991)throw TypeError();e[y]=p}y++}g++}return y}},3531:(t,e,n)=>{var i=n(741),r=n(8851),o=n(6555),s=n(7007),a=n(875),u=n(9002),l={},h={},c=t.exports=function(t,e,n,c,f){var d,p,v,y,g=f?function(){return t}:u(t),m=i(n,c,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(d=a(t.length);d>b;b++)if((y=e?m(s(p=t[b])[0],p[1]):m(t[b]))===l||y===h)return y}else for(v=g.call(t);!(p=v.next()).done;)if((y=r(v,m,p.value,e))===l||y===h)return y};c.BREAK=l,c.RETURN=h},18:(t,e,n)=>{t.exports=n(3825)("native-function-to-string",Function.toString)},3816:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},9181:t=>{var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},7728:(t,e,n)=>{var i=n(9275),r=n(681);t.exports=n(7057)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},639:(t,e,n)=>{var i=n(3816).document;t.exports=i&&i.documentElement},1734:(t,e,n)=>{t.exports=!n(7057)&&!n(4253)((function(){return 7!=Object.defineProperty(n(2457)("div"),"a",{get:function(){return 7}}).a}))},266:(t,e,n)=>{var i=n(5286),r=n(7375).set;t.exports=function(t,e,n){var o,s=e.constructor;return s!==n&&"function"==typeof s&&(o=s.prototype)!==n.prototype&&i(o)&&r&&r(t,o),t}},7242:t=>{t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},9797:(t,e,n)=>{var i=n(2032);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},6555:(t,e,n)=>{var i=n(2803),r=n(6314)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},4302:(t,e,n)=>{var i=n(2032);t.exports=Array.isArray||function(t){return"Array"==i(t)}},8367:(t,e,n)=>{var i=n(5286),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},5286:t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},5364:(t,e,n)=>{var i=n(5286),r=n(2032),o=n(6314)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},8851:(t,e,n)=>{var i=n(7007);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&i(o.call(t)),e}}},9988:(t,e,n)=>{"use strict";var i=n(2503),r=n(681),o=n(2943),s={};n(7728)(s,n(6314)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),o(t,e+" Iterator")}},2923:(t,e,n)=>{"use strict";var i=n(4461),r=n(2985),o=n(7234),s=n(7728),a=n(2803),u=n(9988),l=n(2943),h=n(468),c=n(6314)("iterator"),f=!([].keys&&"next"in[].keys()),d="keys",p="values",v=function(){return this};t.exports=function(t,e,n,y,g,m,b){u(n,e,y);var x,w,_,k=function(t){if(!f&&t in A)return A[t];switch(t){case d:case p:return function(){return new n(this,t)}}return function(){return new n(this,t)}},T=e+" Iterator",E=g==p,S=!1,A=t.prototype,P=A[c]||A["@@iterator"]||g&&A[g],O=P||k(g),C=g?E?k("entries"):O:void 0,M="Array"==e&&A.entries||P;if(M&&(_=h(M.call(new t)))!==Object.prototype&&_.next&&(l(_,T,!0),i||"function"==typeof _[c]||s(_,c,v)),E&&P&&P.name!==p&&(S=!0,O=function(){return P.call(this)}),i&&!b||!f&&!S&&A[c]||s(A,c,O),a[e]=O,a[T]=v,g)if(x={values:E?O:k(p),keys:m?O:k(d),entries:C},b)for(w in x)w in A||o(A,w,x[w]);else r(r.P+r.F*(f||S),e,x);return x}},7462:(t,e,n)=>{var i=n(6314)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var o=[7],s=o[i]();s.next=function(){return{done:n=!0}},o[i]=function(){return s},t(o)}catch(t){}return n}},5436:t=>{t.exports=function(t,e){return{value:e,done:!!t}}},2803:t=>{t.exports={}},4461:t=>{t.exports=!1},3086:t=>{var e=Math.expm1;t.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||-2e-17!=e(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:e},4934:(t,e,n)=>{var i=n(1801),r=Math.pow,o=r(2,-52),s=r(2,-23),a=r(2,127)*(2-s),u=r(2,-126);t.exports=Math.fround||function(t){var e,n,r=Math.abs(t),l=i(t);return r<u?l*(r/u/s+1/o-1/o)*u*s:(n=(e=(1+s/o)*r)-(e-r))>a||n!=n?l*(1/0):l*n}},6206:t=>{t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},1801:t=>{t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},4728:(t,e,n)=>{var i=n(3953)("meta"),r=n(5286),o=n(9181),s=n(9275).f,a=0,u=Object.isExtensible||function(){return!0},l=!n(4253)((function(){return u(Object.preventExtensions({}))})),h=function(t){s(t,i,{value:{i:"O"+ ++a,w:{}}})},c=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!u(t))return"F";if(!e)return"E";h(t)}return t[i].i},getWeak:function(t,e){if(!o(t,i)){if(!u(t))return!0;if(!e)return!1;h(t)}return t[i].w},onFreeze:function(t){return l&&c.NEED&&u(t)&&!o(t,i)&&h(t),t}}},4351:(t,e,n)=>{var i=n(3816),r=n(4193).set,o=i.MutationObserver||i.WebKitMutationObserver,s=i.process,a=i.Promise,u="process"==n(2032)(s);t.exports=function(){var t,e,n,l=function(){var i,r;for(u&&(i=s.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(u)n=function(){s.nextTick(l)};else if(!o||i.navigator&&i.navigator.standalone)if(a&&a.resolve){var h=a.resolve(void 0);n=function(){h.then(l)}}else n=function(){r.call(i,l)};else{var c=!0,f=document.createTextNode("");new o(l).observe(f,{characterData:!0}),n=function(){f.data=c=!c}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},3499:(t,e,n)=>{"use strict";var i=n(4963);function r(t){var e,n;this.promise=new t((function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i})),this.resolve=i(e),this.reject=i(n)}t.exports.f=function(t){return new r(t)}},5345:(t,e,n)=>{"use strict";var i=n(7057),r=n(7184),o=n(4548),s=n(4682),a=n(508),u=n(9797),l=Object.assign;t.exports=!l||n(4253)((function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i}))?function(t,e){for(var n=a(t),l=arguments.length,h=1,c=o.f,f=s.f;l>h;)for(var d,p=u(arguments[h++]),v=c?r(p).concat(c(p)):r(p),y=v.length,g=0;y>g;)d=v[g++],i&&!f.call(p,d)||(n[d]=p[d]);return n}:l},2503:(t,e,n)=>{var i=n(7007),r=n(5588),o=n(4430),s=n(9335)("IE_PROTO"),a=function(){},u=function(){var t,e=n(2457)("iframe"),i=o.length;for(e.style.display="none",n(639).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;i--;)delete u.prototype[o[i]];return u()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=i(t),n=new a,a.prototype=null,n[s]=t):n=u(),void 0===e?n:r(n,e)}},9275:(t,e,n)=>{var i=n(7007),r=n(1734),o=n(1689),s=Object.defineProperty;e.f=n(7057)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},5588:(t,e,n)=>{var i=n(9275),r=n(7007),o=n(7184);t.exports=n(7057)?Object.defineProperties:function(t,e){r(t);for(var n,s=o(e),a=s.length,u=0;a>u;)i.f(t,n=s[u++],e[n]);return t}},8693:(t,e,n)=>{var i=n(4682),r=n(681),o=n(2110),s=n(1689),a=n(9181),u=n(1734),l=Object.getOwnPropertyDescriptor;e.f=n(7057)?l:function(t,e){if(t=o(t),e=s(e,!0),u)try{return l(t,e)}catch(t){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},9327:(t,e,n)=>{var i=n(2110),r=n(616).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==o.call(t)?function(t){try{return r(t)}catch(t){return s.slice()}}(t):r(i(t))}},616:(t,e,n)=>{var i=n(189),r=n(4430).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},4548:(t,e)=>{e.f=Object.getOwnPropertySymbols},468:(t,e,n)=>{var i=n(9181),r=n(508),o=n(9335)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},189:(t,e,n)=>{var i=n(9181),r=n(2110),o=n(9315)(!1),s=n(9335)("IE_PROTO");t.exports=function(t,e){var n,a=r(t),u=0,l=[];for(n in a)n!=s&&i(a,n)&&l.push(n);for(;e.length>u;)i(a,n=e[u++])&&(~o(l,n)||l.push(n));return l}},7184:(t,e,n)=>{var i=n(189),r=n(4430);t.exports=Object.keys||function(t){return i(t,r)}},4682:(t,e)=>{e.f={}.propertyIsEnumerable},3160:(t,e,n)=>{var i=n(2985),r=n(5645),o=n(4253);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],s={};s[t]=e(n),i(i.S+i.F*o((function(){n(1)})),"Object",s)}},1131:(t,e,n)=>{var i=n(7057),r=n(7184),o=n(2110),s=n(4682).f;t.exports=function(t){return function(e){for(var n,a=o(e),u=r(a),l=u.length,h=0,c=[];l>h;)n=u[h++],i&&!s.call(a,n)||c.push(t?[n,a[n]]:a[n]);return c}}},7643:(t,e,n)=>{var i=n(616),r=n(4548),o=n(7007),s=n(3816).Reflect;t.exports=s&&s.ownKeys||function(t){var e=i.f(o(t)),n=r.f;return n?e.concat(n(t)):e}},7743:(t,e,n)=>{var i=n(3816).parseFloat,r=n(9599).trim;t.exports=1/i(n(4644)+"-0")!=-1/0?function(t){var e=r(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},5960:(t,e,n)=>{var i=n(3816).parseInt,r=n(9599).trim,o=n(4644),s=/^[-+]?0[xX]/;t.exports=8!==i(o+"08")||22!==i(o+"0x16")?function(t,e){var n=r(String(t),3);return i(n,e>>>0||(s.test(n)?16:10))}:i},188:t=>{t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},94:(t,e,n)=>{var i=n(7007),r=n(5286),o=n(3499);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},681:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},4408:(t,e,n)=>{var i=n(7234);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},7234:(t,e,n)=>{var i=n(3816),r=n(7728),o=n(9181),s=n(3953)("src"),a=n(18),u="toString",l=(""+a).split(u);n(5645).inspectSource=function(t){return a.call(t)},(t.exports=function(t,e,n,a){var u="function"==typeof n;u&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(u&&(o(n,s)||r(n,s,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=n:a?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[s]||a.call(this)}))},7787:(t,e,n)=>{"use strict";var i=n(1488),r=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var o=n.call(t,e);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},1165:(t,e,n)=>{"use strict";var i,r,o=n(3218),s=RegExp.prototype.exec,a=String.prototype.replace,u=s,l=(i=/a/,r=/b*/g,s.call(i,"a"),s.call(r,"a"),0!==i.lastIndex||0!==r.lastIndex),h=void 0!==/()??/.exec("")[1];(l||h)&&(u=function(t){var e,n,i,r,u=this;return h&&(n=new RegExp("^"+u.source+"$(?!\\s)",o.call(u))),l&&(e=u.lastIndex),i=s.call(u,t),l&&i&&(u.lastIndex=u.global?i.index+i[0].length:e),h&&i&&i.length>1&&a.call(i[0],n,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)})),i}),t.exports=u},7195:t=>{t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},7375:(t,e,n)=>{var i=n(5286),r=n(7007),o=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(741)(Function.call,n(8693).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},2974:(t,e,n)=>{"use strict";var i=n(3816),r=n(9275),o=n(7057),s=n(6314)("species");t.exports=function(t){var e=i[t];o&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},2943:(t,e,n)=>{var i=n(9275).f,r=n(9181),o=n(6314)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},9335:(t,e,n)=>{var i=n(3825)("keys"),r=n(3953);t.exports=function(t){return i[t]||(i[t]=r(t))}},3825:(t,e,n)=>{var i=n(5645),r=n(3816),o="__core-js_shared__",s=r[o]||(r[o]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(4461)?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},8364:(t,e,n)=>{var i=n(7007),r=n(4963),o=n(6314)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||null==(n=i(s)[o])?e:r(n)}},7717:(t,e,n)=>{"use strict";var i=n(4253);t.exports=function(t,e){return!!t&&i((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},4496:(t,e,n)=>{var i=n(1467),r=n(1355);t.exports=function(t){return function(e,n){var o,s,a=String(r(e)),u=i(n),l=a.length;return u<0||u>=l?t?"":void 0:(o=a.charCodeAt(u))<55296||o>56319||u+1===l||(s=a.charCodeAt(u+1))<56320||s>57343?t?a.charAt(u):o:t?a.slice(u,u+2):s-56320+(o-55296<<10)+65536}}},2094:(t,e,n)=>{var i=n(5364),r=n(1355);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},9395:(t,e,n)=>{var i=n(2985),r=n(4253),o=n(1355),s=/"/g,a=function(t,e,n,i){var r=String(o(t)),a="<"+e;return""!==n&&(a+=" "+n+'="'+String(i).replace(s,"&quot;")+'"'),a+">"+r+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(a),i(i.P+i.F*r((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",n)}},5442:(t,e,n)=>{var i=n(875),r=n(8595),o=n(1355);t.exports=function(t,e,n,s){var a=String(o(t)),u=a.length,l=void 0===n?" ":String(n),h=i(e);if(h<=u||""==l)return a;var c=h-u,f=r.call(l,Math.ceil(c/l.length));return f.length>c&&(f=f.slice(0,c)),s?f+a:a+f}},8595:(t,e,n)=>{"use strict";var i=n(1467),r=n(1355);t.exports=function(t){var e=String(r(this)),n="",o=i(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},9599:(t,e,n)=>{var i=n(2985),r=n(1355),o=n(4253),s=n(4644),a="["+s+"]",u=RegExp("^"+a+a+"*"),l=RegExp(a+a+"*$"),h=function(t,e,n){var r={},a=o((function(){return!!s[t]()||"​"!="​"[t]()})),u=r[t]=a?e(c):s[t];n&&(r[n]=u),i(i.P+i.F*a,"String",r)},c=h.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=h},4644:t=>{t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},4193:(t,e,n)=>{var i,r,o,s=n(741),a=n(7242),u=n(639),l=n(2457),h=n(3816),c=h.process,f=h.setImmediate,d=h.clearImmediate,p=h.MessageChannel,v=h.Dispatch,y=0,g={},m=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},b=function(t){m.call(t.data)};f&&d||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++y]=function(){a("function"==typeof t?t:Function(t),e)},i(y),y},d=function(t){delete g[t]},"process"==n(2032)(c)?i=function(t){c.nextTick(s(m,t,1))}:v&&v.now?i=function(t){v.now(s(m,t,1))}:p?(o=(r=new p).port2,r.port1.onmessage=b,i=s(o.postMessage,o,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(i=function(t){h.postMessage(t+"","*")},h.addEventListener("message",b,!1)):i="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(s(m,t,1),0)}),t.exports={set:f,clear:d}},2337:(t,e,n)=>{var i=n(1467),r=Math.max,o=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):o(t,e)}},4843:(t,e,n)=>{var i=n(1467),r=n(875);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=r(e);if(e!==n)throw RangeError("Wrong length!");return n}},1467:t=>{var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},2110:(t,e,n)=>{var i=n(9797),r=n(1355);t.exports=function(t){return i(r(t))}},875:(t,e,n)=>{var i=n(1467),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},508:(t,e,n)=>{var i=n(1355);t.exports=function(t){return Object(i(t))}},1689:(t,e,n)=>{var i=n(5286);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},8440:(t,e,n)=>{"use strict";if(n(7057)){var i=n(4461),r=n(3816),o=n(4253),s=n(2985),a=n(9383),u=n(1125),l=n(741),h=n(3328),c=n(681),f=n(7728),d=n(4408),p=n(1467),v=n(875),y=n(4843),g=n(2337),m=n(1689),b=n(9181),x=n(1488),w=n(5286),_=n(508),k=n(6555),T=n(2503),E=n(468),S=n(616).f,A=n(9002),P=n(3953),O=n(6314),C=n(50),M=n(9315),R=n(8364),I=n(6997),L=n(2803),j=n(7462),B=n(2974),D=n(6852),F=n(5216),N=n(9275),z=n(8693),U=N.f,V=z.f,G=r.RangeError,H=r.TypeError,Y=r.Uint8Array,W="ArrayBuffer",X="SharedArrayBuffer",K="BYTES_PER_ELEMENT",q=Array.prototype,Z=u.ArrayBuffer,J=u.DataView,Q=C(0),$=C(2),tt=C(3),et=C(4),nt=C(5),it=C(6),rt=M(!0),ot=M(!1),st=I.values,at=I.keys,ut=I.entries,lt=q.lastIndexOf,ht=q.reduce,ct=q.reduceRight,ft=q.join,dt=q.sort,pt=q.slice,vt=q.toString,yt=q.toLocaleString,gt=O("iterator"),mt=O("toStringTag"),bt=P("typed_constructor"),xt=P("def_constructor"),wt=a.CONSTR,_t=a.TYPED,kt=a.VIEW,Tt="Wrong length!",Et=C(1,(function(t,e){return Ct(R(t,t[xt]),e)})),St=o((function(){return 1===new Y(new Uint16Array([1]).buffer)[0]})),At=!!Y&&!!Y.prototype.set&&o((function(){new Y(1).set({})})),Pt=function(t,e){var n=p(t);if(n<0||n%e)throw G("Wrong offset!");return n},Ot=function(t){if(w(t)&&_t in t)return t;throw H(t+" is not a typed array!")},Ct=function(t,e){if(!w(t)||!(bt in t))throw H("It is not a typed array constructor!");return new t(e)},Mt=function(t,e){return Rt(R(t,t[xt]),e)},Rt=function(t,e){for(var n=0,i=e.length,r=Ct(t,i);i>n;)r[n]=e[n++];return r},It=function(t,e,n){U(t,e,{get:function(){return this._d[n]}})},Lt=function(t){var e,n,i,r,o,s,a=_(t),u=arguments.length,h=u>1?arguments[1]:void 0,c=void 0!==h,f=A(a);if(null!=f&&!k(f)){for(s=f.call(a),i=[],e=0;!(o=s.next()).done;e++)i.push(o.value);a=i}for(c&&u>2&&(h=l(h,arguments[2],2)),e=0,n=v(a.length),r=Ct(this,n);n>e;e++)r[e]=c?h(a[e],e):a[e];return r},jt=function(){for(var t=0,e=arguments.length,n=Ct(this,e);e>t;)n[t]=arguments[t++];return n},Bt=!!Y&&o((function(){yt.call(new Y(1))})),Dt=function(){return yt.apply(Bt?pt.call(Ot(this)):Ot(this),arguments)},Ft={copyWithin:function(t,e){return F.call(Ot(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return et(Ot(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return D.apply(Ot(this),arguments)},filter:function(t){return Mt(this,$(Ot(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return nt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Ot(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Q(Ot(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ot(Ot(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return rt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ft.apply(Ot(this),arguments)},lastIndexOf:function(t){return lt.apply(Ot(this),arguments)},map:function(t){return Et(Ot(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ht.apply(Ot(this),arguments)},reduceRight:function(t){return ct.apply(Ot(this),arguments)},reverse:function(){for(var t,e=this,n=Ot(e).length,i=Math.floor(n/2),r=0;r<i;)t=e[r],e[r++]=e[--n],e[n]=t;return e},some:function(t){return tt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return dt.call(Ot(this),t)},subarray:function(t,e){var n=Ot(this),i=n.length,r=g(t,i);return new(R(n,n[xt]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,v((void 0===e?i:g(e,i))-r))}},Nt=function(t,e){return Mt(this,pt.call(Ot(this),t,e))},zt=function(t){Ot(this);var e=Pt(arguments[1],1),n=this.length,i=_(t),r=v(i.length),o=0;if(r+e>n)throw G(Tt);for(;o<r;)this[e+o]=i[o++]},Ut={entries:function(){return ut.call(Ot(this))},keys:function(){return at.call(Ot(this))},values:function(){return st.call(Ot(this))}},Vt=function(t,e){return w(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Gt=function(t,e){return Vt(t,e=m(e,!0))?c(2,t[e]):V(t,e)},Ht=function(t,e,n){return!(Vt(t,e=m(e,!0))&&w(n)&&b(n,"value"))||b(n,"get")||b(n,"set")||n.configurable||b(n,"writable")&&!n.writable||b(n,"enumerable")&&!n.enumerable?U(t,e,n):(t[e]=n.value,t)};wt||(z.f=Gt,N.f=Ht),s(s.S+s.F*!wt,"Object",{getOwnPropertyDescriptor:Gt,defineProperty:Ht}),o((function(){vt.call({})}))&&(vt=yt=function(){return ft.call(this)});var Yt=d({},Ft);d(Yt,Ut),f(Yt,gt,Ut.values),d(Yt,{slice:Nt,set:zt,constructor:function(){},toString:vt,toLocaleString:Dt}),It(Yt,"buffer","b"),It(Yt,"byteOffset","o"),It(Yt,"byteLength","l"),It(Yt,"length","e"),U(Yt,mt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,u){var l=t+((u=!!u)?"Clamped":"")+"Array",c="get"+t,d="set"+t,p=r[l],g=p||{},m=p&&E(p),b=!p||!a.ABV,_={},k=p&&p.prototype,A=function(t,n){U(t,n,{get:function(){return function(t,n){var i=t._d;return i.v[c](n*e+i.o,St)}(this,n)},set:function(t){return function(t,n,i){var r=t._d;u&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),r.v[d](n*e+r.o,i,St)}(this,n,t)},enumerable:!0})};b?(p=n((function(t,n,i,r){h(t,p,l,"_d");var o,s,a,u,c=0,d=0;if(w(n)){if(!(n instanceof Z||(u=x(n))==W||u==X))return _t in n?Rt(p,n):Lt.call(p,n);o=n,d=Pt(i,e);var g=n.byteLength;if(void 0===r){if(g%e)throw G(Tt);if((s=g-d)<0)throw G(Tt)}else if((s=v(r)*e)+d>g)throw G(Tt);a=s/e}else a=y(n),o=new Z(s=a*e);for(f(t,"_d",{b:o,o:d,l:s,e:a,v:new J(o)});c<a;)A(t,c++)})),k=p.prototype=T(Yt),f(k,"constructor",p)):o((function(){p(1)}))&&o((function(){new p(-1)}))&&j((function(t){new p,new p(null),new p(1.5),new p(t)}),!0)||(p=n((function(t,n,i,r){var o;return h(t,p,l),w(n)?n instanceof Z||(o=x(n))==W||o==X?void 0!==r?new g(n,Pt(i,e),r):void 0!==i?new g(n,Pt(i,e)):new g(n):_t in n?Rt(p,n):Lt.call(p,n):new g(y(n))})),Q(m!==Function.prototype?S(g).concat(S(m)):S(g),(function(t){t in p||f(p,t,g[t])})),p.prototype=k,i||(k.constructor=p));var P=k[gt],O=!!P&&("values"==P.name||null==P.name),C=Ut.values;f(p,bt,!0),f(k,_t,l),f(k,kt,!0),f(k,xt,p),(u?new p(1)[mt]==l:mt in k)||U(k,mt,{get:function(){return l}}),_[l]=p,s(s.G+s.W+s.F*(p!=g),_),s(s.S,l,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*o((function(){g.of.call(p,1)})),l,{from:Lt,of:jt}),K in k||f(k,K,e),s(s.P,l,Ft),B(l),s(s.P+s.F*At,l,{set:zt}),s(s.P+s.F*!O,l,Ut),i||k.toString==vt||(k.toString=vt),s(s.P+s.F*o((function(){new p(1).slice()})),l,{slice:Nt}),s(s.P+s.F*(o((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!o((function(){k.toLocaleString.call([1,2])}))),l,{toLocaleString:Dt}),L[l]=O?P:C,i||O||f(k,gt,C)}}else t.exports=function(){}},1125:(t,e,n)=>{"use strict";var i=n(3816),r=n(7057),o=n(4461),s=n(9383),a=n(7728),u=n(4408),l=n(4253),h=n(3328),c=n(1467),f=n(875),d=n(4843),p=n(616).f,v=n(9275).f,y=n(6852),g=n(2943),m="ArrayBuffer",b="DataView",x="Wrong index!",w=i.ArrayBuffer,_=i.DataView,k=i.Math,T=i.RangeError,E=i.Infinity,S=w,A=k.abs,P=k.pow,O=k.floor,C=k.log,M=k.LN2,R="buffer",I="byteLength",L="byteOffset",j=r?"_b":R,B=r?"_l":I,D=r?"_o":L;function F(t,e,n){var i,r,o,s=new Array(n),a=8*n-e-1,u=(1<<a)-1,l=u>>1,h=23===e?P(2,-24)-P(2,-77):0,c=0,f=t<0||0===t&&1/t<0?1:0;for((t=A(t))!=t||t===E?(r=t!=t?1:0,i=u):(i=O(C(t)/M),t*(o=P(2,-i))<1&&(i--,o*=2),(t+=i+l>=1?h/o:h*P(2,1-l))*o>=2&&(i++,o/=2),i+l>=u?(r=0,i=u):i+l>=1?(r=(t*o-1)*P(2,e),i+=l):(r=t*P(2,l-1)*P(2,e),i=0));e>=8;s[c++]=255&r,r/=256,e-=8);for(i=i<<e|r,a+=e;a>0;s[c++]=255&i,i/=256,a-=8);return s[--c]|=128*f,s}function N(t,e,n){var i,r=8*n-e-1,o=(1<<r)-1,s=o>>1,a=r-7,u=n-1,l=t[u--],h=127&l;for(l>>=7;a>0;h=256*h+t[u],u--,a-=8);for(i=h&(1<<-a)-1,h>>=-a,a+=e;a>0;i=256*i+t[u],u--,a-=8);if(0===h)h=1-s;else{if(h===o)return i?NaN:l?-E:E;i+=P(2,e),h-=s}return(l?-1:1)*i*P(2,h-e)}function z(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function U(t){return[255&t]}function V(t){return[255&t,t>>8&255]}function G(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function H(t){return F(t,52,8)}function Y(t){return F(t,23,4)}function W(t,e,n){v(t.prototype,e,{get:function(){return this[n]}})}function X(t,e,n,i){var r=d(+n);if(r+e>t[B])throw T(x);var o=t[j]._b,s=r+t[D],a=o.slice(s,s+e);return i?a:a.reverse()}function K(t,e,n,i,r,o){var s=d(+n);if(s+e>t[B])throw T(x);for(var a=t[j]._b,u=s+t[D],l=i(+r),h=0;h<e;h++)a[u+h]=l[o?h:e-h-1]}if(s.ABV){if(!l((function(){w(1)}))||!l((function(){new w(-1)}))||l((function(){return new w,new w(1.5),new w(NaN),w.name!=m}))){for(var q,Z=(w=function(t){return h(this,w),new S(d(t))}).prototype=S.prototype,J=p(S),Q=0;J.length>Q;)(q=J[Q++])in w||a(w,q,S[q]);o||(Z.constructor=w)}var $=new _(new w(2)),tt=_.prototype.setInt8;$.setInt8(0,2147483648),$.setInt8(1,2147483649),!$.getInt8(0)&&$.getInt8(1)||u(_.prototype,{setInt8:function(t,e){tt.call(this,t,e<<24>>24)},setUint8:function(t,e){tt.call(this,t,e<<24>>24)}},!0)}else w=function(t){h(this,w,m);var e=d(t);this._b=y.call(new Array(e),0),this[B]=e},_=function(t,e,n){h(this,_,b),h(t,w,b);var i=t[B],r=c(e);if(r<0||r>i)throw T("Wrong offset!");if(r+(n=void 0===n?i-r:f(n))>i)throw T("Wrong length!");this[j]=t,this[D]=r,this[B]=n},r&&(W(w,I,"_l"),W(_,R,"_b"),W(_,I,"_l"),W(_,L,"_o")),u(_.prototype,{getInt8:function(t){return X(this,1,t)[0]<<24>>24},getUint8:function(t){return X(this,1,t)[0]},getInt16:function(t){var e=X(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=X(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return z(X(this,4,t,arguments[1]))},getUint32:function(t){return z(X(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return N(X(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return N(X(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){K(this,1,t,U,e)},setUint8:function(t,e){K(this,1,t,U,e)},setInt16:function(t,e){K(this,2,t,V,e,arguments[2])},setUint16:function(t,e){K(this,2,t,V,e,arguments[2])},setInt32:function(t,e){K(this,4,t,G,e,arguments[2])},setUint32:function(t,e){K(this,4,t,G,e,arguments[2])},setFloat32:function(t,e){K(this,4,t,Y,e,arguments[2])},setFloat64:function(t,e){K(this,8,t,H,e,arguments[2])}});g(w,m),g(_,b),a(_.prototype,s.VIEW,!0),e.ArrayBuffer=w,e.DataView=_},9383:(t,e,n)=>{for(var i,r=n(3816),o=n(7728),s=n(3953),a=s("typed_array"),u=s("view"),l=!(!r.ArrayBuffer||!r.DataView),h=l,c=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");c<9;)(i=r[f[c++]])?(o(i.prototype,a,!0),o(i.prototype,u,!0)):h=!1;t.exports={ABV:l,CONSTR:h,TYPED:a,VIEW:u}},3953:t=>{var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))}},575:(t,e,n)=>{var i=n(3816).navigator;t.exports=i&&i.userAgent||""},1616:(t,e,n)=>{var i=n(5286);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},6074:(t,e,n)=>{var i=n(3816),r=n(5645),o=n(4461),s=n(8787),a=n(9275).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:s.f(t)})}},8787:(t,e,n)=>{e.f=n(6314)},6314:(t,e,n)=>{var i=n(3825)("wks"),r=n(3953),o=n(3816).Symbol,s="function"==typeof o;(t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))}).store=i},9002:(t,e,n)=>{var i=n(1488),r=n(6314)("iterator"),o=n(2803);t.exports=n(5645).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},2e3:(t,e,n)=>{var i=n(2985);i(i.P,"Array",{copyWithin:n(5216)}),n(7722)("copyWithin")},5745:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(4);i(i.P+i.F*!n(7717)([].every,!0),"Array",{every:function(t){return r(this,t,arguments[1])}})},8977:(t,e,n)=>{var i=n(2985);i(i.P,"Array",{fill:n(6852)}),n(7722)("fill")},8837:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(2);i(i.P+i.F*!n(7717)([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},4899:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(6),o="findIndex",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),i(i.P+i.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(7722)(o)},2310:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(5),o="find",s=!0;o in[]&&Array(1).find((function(){s=!1})),i(i.P+i.F*s,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(7722)(o)},4336:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(0),o=n(7717)([].forEach,!0);i(i.P+i.F*!o,"Array",{forEach:function(t){return r(this,t,arguments[1])}})},522:(t,e,n)=>{"use strict";var i=n(741),r=n(2985),o=n(508),s=n(8851),a=n(6555),u=n(875),l=n(2811),h=n(9002);r(r.S+r.F*!n(7462)((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,c,f=o(t),d="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,y=void 0!==v,g=0,m=h(f);if(y&&(v=i(v,p>2?arguments[2]:void 0,2)),null==m||d==Array&&a(m))for(n=new d(e=u(f.length));e>g;g++)l(n,g,y?v(f[g],g):f[g]);else for(c=m.call(f),n=new d;!(r=c.next()).done;g++)l(n,g,y?s(c,v,[r.value,g],!0):r.value);return n.length=g,n}})},3369:(t,e,n)=>{"use strict";var i=n(2985),r=n(9315)(!1),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(s||!n(7717)(o)),"Array",{indexOf:function(t){return s?o.apply(this,arguments)||0:r(this,t,arguments[1])}})},774:(t,e,n)=>{var i=n(2985);i(i.S,"Array",{isArray:n(4302)})},6997:(t,e,n)=>{"use strict";var i=n(7722),r=n(5436),o=n(2803),s=n(2110);t.exports=n(2923)(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},7842:(t,e,n)=>{"use strict";var i=n(2985),r=n(2110),o=[].join;i(i.P+i.F*(n(9797)!=Object||!n(7717)(o)),"Array",{join:function(t){return o.call(r(this),void 0===t?",":t)}})},9564:(t,e,n)=>{"use strict";var i=n(2985),r=n(2110),o=n(1467),s=n(875),a=[].lastIndexOf,u=!!a&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(u||!n(7717)(a)),"Array",{lastIndexOf:function(t){if(u)return a.apply(this,arguments)||0;var e=r(this),n=s(e.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,o(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in e&&e[i]===t)return i||0;return-1}})},1802:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(1);i(i.P+i.F*!n(7717)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},8295:(t,e,n)=>{"use strict";var i=n(2985),r=n(2811);i(i.S+i.F*n(4253)((function(){function t(){}return!(Array.of.call(t)instanceof t)})),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)r(n,t,arguments[t++]);return n.length=e,n}})},3750:(t,e,n)=>{"use strict";var i=n(2985),r=n(7628);i(i.P+i.F*!n(7717)([].reduceRight,!0),"Array",{reduceRight:function(t){return r(this,t,arguments.length,arguments[1],!0)}})},3057:(t,e,n)=>{"use strict";var i=n(2985),r=n(7628);i(i.P+i.F*!n(7717)([].reduce,!0),"Array",{reduce:function(t){return r(this,t,arguments.length,arguments[1],!1)}})},110:(t,e,n)=>{"use strict";var i=n(2985),r=n(639),o=n(2032),s=n(2337),a=n(875),u=[].slice;i(i.P+i.F*n(4253)((function(){r&&u.call(r)})),"Array",{slice:function(t,e){var n=a(this.length),i=o(this);if(e=void 0===e?n:e,"Array"==i)return u.call(this,t,e);for(var r=s(t,n),l=s(e,n),h=a(l-r),c=new Array(h),f=0;f<h;f++)c[f]="String"==i?this.charAt(r+f):this[r+f];return c}})},6773:(t,e,n)=>{"use strict";var i=n(2985),r=n(50)(3);i(i.P+i.F*!n(7717)([].some,!0),"Array",{some:function(t){return r(this,t,arguments[1])}})},75:(t,e,n)=>{"use strict";var i=n(2985),r=n(4963),o=n(508),s=n(4253),a=[].sort,u=[1,2,3];i(i.P+i.F*(s((function(){u.sort(void 0)}))||!s((function(){u.sort(null)}))||!n(7717)(a)),"Array",{sort:function(t){return void 0===t?a.call(o(this)):a.call(o(this),r(t))}})},1842:(t,e,n)=>{n(2974)("Array")},1822:(t,e,n)=>{var i=n(2985);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},1031:(t,e,n)=>{var i=n(2985),r=n(3537);i(i.P+i.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},9977:(t,e,n)=>{"use strict";var i=n(2985),r=n(508),o=n(1689);i(i.P+i.F*n(4253)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(t){var e=r(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},1560:(t,e,n)=>{var i=n(6314)("toPrimitive"),r=Date.prototype;i in r||n(7728)(r,i,n(870))},6331:(t,e,n)=>{var i=Date.prototype,r="Invalid Date",o=i.toString,s=i.getTime;new Date(NaN)+""!=r&&n(7234)(i,"toString",(function(){var t=s.call(this);return t==t?o.call(this):r}))},9730:(t,e,n)=>{var i=n(2985);i(i.P,"Function",{bind:n(4398)})},8377:(t,e,n)=>{"use strict";var i=n(5286),r=n(468),o=n(6314)("hasInstance"),s=Function.prototype;o in s||n(9275).f(s,o,{value:function(t){if("function"!=typeof this||!i(t))return!1;if(!i(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}})},6059:(t,e,n)=>{var i=n(9275).f,r=Function.prototype,o=/^\s*function ([^ (]*)/,s="name";s in r||n(7057)&&i(r,s,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},8416:(t,e,n)=>{"use strict";var i=n(9824),r=n(1616),o="Map";t.exports=n(5795)(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(r(this,o),t);return e&&e.v},set:function(t,e){return i.def(r(this,o),0===t?0:t,e)}},i,!0)},6503:(t,e,n)=>{var i=n(2985),r=n(6206),o=Math.sqrt,s=Math.acosh;i(i.S+i.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+o(t-1)*o(t+1))}})},6786:(t,e,n)=>{var i=n(2985),r=Math.asinh;i(i.S+i.F*!(r&&1/r(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},932:(t,e,n)=>{var i=n(2985),r=Math.atanh;i(i.S+i.F*!(r&&1/r(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},7526:(t,e,n)=>{var i=n(2985),r=n(1801);i(i.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},1591:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},9073:(t,e,n)=>{var i=n(2985),r=Math.exp;i(i.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},347:(t,e,n)=>{var i=n(2985),r=n(3086);i(i.S+i.F*(r!=Math.expm1),"Math",{expm1:r})},579:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{fround:n(4934)})},4669:(t,e,n)=>{var i=n(2985),r=Math.abs;i(i.S,"Math",{hypot:function(t,e){for(var n,i,o=0,s=0,a=arguments.length,u=0;s<a;)u<(n=r(arguments[s++]))?(o=o*(i=u/n)*i+1,u=n):o+=n>0?(i=n/u)*i:n;return u===1/0?1/0:u*Math.sqrt(o)}})},7710:(t,e,n)=>{var i=n(2985),r=Math.imul;i(i.S+i.F*n(4253)((function(){return-5!=r(4294967295,5)||2!=r.length})),"Math",{imul:function(t,e){var n=65535,i=+t,r=+e,o=n&i,s=n&r;return 0|o*s+((n&i>>>16)*s+o*(n&r>>>16)<<16>>>0)}})},5789:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},3514:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{log1p:n(6206)})},9978:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},8472:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{sign:n(1801)})},6946:(t,e,n)=>{var i=n(2985),r=n(3086),o=Math.exp;i(i.S+i.F*n(4253)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},5068:(t,e,n)=>{var i=n(2985),r=n(3086),o=Math.exp;i(i.S,"Math",{tanh:function(t){var e=r(t=+t),n=r(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},413:(t,e,n)=>{var i=n(2985);i(i.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},1246:(t,e,n)=>{"use strict";var i=n(3816),r=n(9181),o=n(2032),s=n(266),a=n(1689),u=n(4253),l=n(616).f,h=n(8693).f,c=n(9275).f,f=n(9599).trim,d="Number",p=i.Number,v=p,y=p.prototype,g=o(n(2503)(y))==d,m="trim"in String.prototype,b=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){var n,i,r,o=(e=m?e.trim():f(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var s,u=e.slice(2),l=0,h=u.length;l<h;l++)if((s=u.charCodeAt(l))<48||s>r)return NaN;return parseInt(u,i)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(g?u((function(){y.valueOf.call(n)})):o(n)!=d)?s(new v(b(e)),n,p):b(e)};for(var x,w=n(7057)?l(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;w.length>_;_++)r(v,x=w[_])&&!r(p,x)&&c(p,x,h(v,x));p.prototype=y,y.constructor=p,n(7234)(i,d,p)}},5972:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},3403:(t,e,n)=>{var i=n(2985),r=n(3816).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},2516:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{isInteger:n(8367)})},9371:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{isNaN:function(t){return t!=t}})},6479:(t,e,n)=>{var i=n(2985),r=n(8367),o=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return r(t)&&o(t)<=9007199254740991}})},1736:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},1889:(t,e,n)=>{var i=n(2985);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},5177:(t,e,n)=>{var i=n(2985),r=n(7743);i(i.S+i.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},6943:(t,e,n)=>{var i=n(2985),r=n(5960);i(i.S+i.F*(Number.parseInt!=r),"Number",{parseInt:r})},726:(t,e,n)=>{"use strict";var i=n(2985),r=n(1467),o=n(3365),s=n(8595),a=1..toFixed,u=Math.floor,l=[0,0,0,0,0,0],h="Number.toFixed: incorrect invocation!",c="0",f=function(t,e){for(var n=-1,i=e;++n<6;)i+=t*l[n],l[n]=i%1e7,i=u(i/1e7)},d=function(t){for(var e=6,n=0;--e>=0;)n+=l[e],l[e]=u(n/t),n=n%t*1e7},p=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==l[t]){var n=String(l[t]);e=""===e?n:e+s.call(c,7-n.length)+n}return e},v=function(t,e,n){return 0===e?n:e%2==1?v(t,e-1,n*t):v(t*t,e/2,n)};i(i.P+i.F*(!!a&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(4253)((function(){a.call({})}))),"Number",{toFixed:function(t){var e,n,i,a,u=o(this,h),l=r(t),y="",g=c;if(l<0||l>20)throw RangeError(h);if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(y="-",u=-u),u>1e-21)if(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(u*v(2,69,1))-69,n=e<0?u*v(2,-e,1):u/v(2,e,1),n*=4503599627370496,(e=52-e)>0){for(f(0,n),i=l;i>=7;)f(1e7,0),i-=7;for(f(v(10,i,1),0),i=e-1;i>=23;)d(1<<23),i-=23;d(1<<i),f(1,1),d(2),g=p()}else f(0,n),f(1<<-e,0),g=p()+s.call(c,l);return l>0?y+((a=g.length)<=l?"0."+s.call(c,l-a)+g:g.slice(0,a-l)+"."+g.slice(a-l)):y+g}})},1901:(t,e,n)=>{"use strict";var i=n(2985),r=n(4253),o=n(3365),s=1..toPrecision;i(i.P+i.F*(r((function(){return"1"!==s.call(1,void 0)}))||!r((function(){s.call({})}))),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?s.call(e):s.call(e,t)}})},5115:(t,e,n)=>{var i=n(2985);i(i.S+i.F,"Object",{assign:n(5345)})},8132:(t,e,n)=>{var i=n(2985);i(i.S,"Object",{create:n(2503)})},7470:(t,e,n)=>{var i=n(2985);i(i.S+i.F*!n(7057),"Object",{defineProperties:n(5588)})},8388:(t,e,n)=>{var i=n(2985);i(i.S+i.F*!n(7057),"Object",{defineProperty:n(9275).f})},9375:(t,e,n)=>{var i=n(5286),r=n(4728).onFreeze;n(3160)("freeze",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},4882:(t,e,n)=>{var i=n(2110),r=n(8693).f;n(3160)("getOwnPropertyDescriptor",(function(){return function(t,e){return r(i(t),e)}}))},9622:(t,e,n)=>{n(3160)("getOwnPropertyNames",(function(){return n(9327).f}))},1520:(t,e,n)=>{var i=n(508),r=n(468);n(3160)("getPrototypeOf",(function(){return function(t){return r(i(t))}}))},9892:(t,e,n)=>{var i=n(5286);n(3160)("isExtensible",(function(t){return function(e){return!!i(e)&&(!t||t(e))}}))},4157:(t,e,n)=>{var i=n(5286);n(3160)("isFrozen",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},5095:(t,e,n)=>{var i=n(5286);n(3160)("isSealed",(function(t){return function(e){return!i(e)||!!t&&t(e)}}))},9176:(t,e,n)=>{var i=n(2985);i(i.S,"Object",{is:n(7195)})},7476:(t,e,n)=>{var i=n(508),r=n(7184);n(3160)("keys",(function(){return function(t){return r(i(t))}}))},4672:(t,e,n)=>{var i=n(5286),r=n(4728).onFreeze;n(3160)("preventExtensions",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},3533:(t,e,n)=>{var i=n(5286),r=n(4728).onFreeze;n(3160)("seal",(function(t){return function(e){return t&&i(e)?t(r(e)):e}}))},8838:(t,e,n)=>{var i=n(2985);i(i.S,"Object",{setPrototypeOf:n(7375).set})},6253:(t,e,n)=>{"use strict";var i=n(1488),r={};r[n(6314)("toStringTag")]="z",r+""!="[object z]"&&n(7234)(Object.prototype,"toString",(function(){return"[object "+i(this)+"]"}),!0)},4299:(t,e,n)=>{var i=n(2985),r=n(7743);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},1084:(t,e,n)=>{var i=n(2985),r=n(5960);i(i.G+i.F*(parseInt!=r),{parseInt:r})},851:(t,e,n)=>{"use strict";var i,r,o,s,a=n(4461),u=n(3816),l=n(741),h=n(1488),c=n(2985),f=n(5286),d=n(4963),p=n(3328),v=n(3531),y=n(8364),g=n(4193).set,m=n(4351)(),b=n(3499),x=n(188),w=n(575),_=n(94),k="Promise",T=u.TypeError,E=u.process,S=E&&E.versions,A=S&&S.v8||"",P=u.Promise,O="process"==h(E),C=function(){},M=r=b.f,R=!!function(){try{var t=P.resolve(1),e=(t.constructor={})[n(6314)("species")]=function(t){t(C,C)};return(O||"function"==typeof PromiseRejectionEvent)&&t.then(C)instanceof e&&0!==A.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(t){}}(),I=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;m((function(){for(var i=t._v,r=1==t._s,o=0,s=function(e){var n,o,s,a=r?e.ok:e.fail,u=e.resolve,l=e.reject,h=e.domain;try{a?(r||(2==t._h&&D(t),t._h=1),!0===a?n=i:(h&&h.enter(),n=a(i),h&&(h.exit(),s=!0)),n===e.promise?l(T("Promise-chain cycle")):(o=I(n))?o.call(n,u,l):u(n)):l(i)}catch(t){h&&!s&&h.exit(),l(t)}};n.length>o;)s(n[o++]);t._c=[],t._n=!1,e&&!t._h&&j(t)}))}},j=function(t){g.call(u,(function(){var e,n,i,r=t._v,o=B(t);if(o&&(e=x((function(){O?E.emit("unhandledRejection",r,t):(n=u.onunhandledrejection)?n({promise:t,reason:r}):(i=u.console)&&i.error&&i.error("Unhandled promise rejection",r)})),t._h=O||B(t)?2:1),t._a=void 0,o&&e.e)throw e.v}))},B=function(t){return 1!==t._h&&0===(t._a||t._c).length},D=function(t){g.call(u,(function(){var e;O?E.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})}))},F=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},N=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw T("Promise can't be resolved itself");(e=I(t))?m((function(){var i={_w:n,_d:!1};try{e.call(t,l(N,i,1),l(F,i,1))}catch(t){F.call(i,t)}})):(n._v=t,n._s=1,L(n,!1))}catch(t){F.call({_w:n,_d:!1},t)}}};R||(P=function(t){p(this,P,k,"_h"),d(t),i.call(this);try{t(l(N,this,1),l(F,this,1))}catch(t){F.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(4408)(P.prototype,{then:function(t,e){var n=M(y(this,P));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=O?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new i;this.promise=t,this.resolve=l(N,t,1),this.reject=l(F,t,1)},b.f=M=function(t){return t===P||t===s?new o(t):r(t)}),c(c.G+c.W+c.F*!R,{Promise:P}),n(2943)(P,k),n(2974)(k),s=n(5645).Promise,c(c.S+c.F*!R,k,{reject:function(t){var e=M(this);return(0,e.reject)(t),e.promise}}),c(c.S+c.F*(a||!R),k,{resolve:function(t){return _(a&&this===s?P:this,t)}}),c(c.S+c.F*!(R&&n(7462)((function(t){P.all(t).catch(C)}))),k,{all:function(t){var e=this,n=M(e),i=n.resolve,r=n.reject,o=x((function(){var n=[],o=0,s=1;v(t,!1,(function(t){var a=o++,u=!1;n.push(void 0),s++,e.resolve(t).then((function(t){u||(u=!0,n[a]=t,--s||i(n))}),r)})),--s||i(n)}));return o.e&&r(o.v),n.promise},race:function(t){var e=this,n=M(e),i=n.reject,r=x((function(){v(t,!1,(function(t){e.resolve(t).then(n.resolve,i)}))}));return r.e&&i(r.v),n.promise}})},1572:(t,e,n)=>{var i=n(2985),r=n(4963),o=n(7007),s=(n(3816).Reflect||{}).apply,a=Function.apply;i(i.S+i.F*!n(4253)((function(){s((function(){}))})),"Reflect",{apply:function(t,e,n){var i=r(t),u=o(n);return s?s(i,e,u):a.call(i,e,u)}})},2139:(t,e,n)=>{var i=n(2985),r=n(2503),o=n(4963),s=n(7007),a=n(5286),u=n(4253),l=n(4398),h=(n(3816).Reflect||{}).construct,c=u((function(){function t(){}return!(h((function(){}),[],t)instanceof t)})),f=!u((function(){h((function(){}))}));i(i.S+i.F*(c||f),"Reflect",{construct:function(t,e){o(t),s(e);var n=arguments.length<3?t:o(arguments[2]);if(f&&!c)return h(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(l.apply(t,i))}var u=n.prototype,d=r(a(u)?u:Object.prototype),p=Function.apply.call(t,d,e);return a(p)?p:d}})},685:(t,e,n)=>{var i=n(9275),r=n(2985),o=n(7007),s=n(1689);r(r.S+r.F*n(4253)((function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(t,e,n){o(t),e=s(e,!0),o(n);try{return i.f(t,e,n),!0}catch(t){return!1}}})},5535:(t,e,n)=>{var i=n(2985),r=n(8693).f,o=n(7007);i(i.S,"Reflect",{deleteProperty:function(t,e){var n=r(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},7347:(t,e,n)=>{"use strict";var i=n(2985),r=n(7007),o=function(t){this._t=r(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(9988)(o,"Object",(function(){var t,e=this,n=e._k;do{if(e._i>=n.length)return{value:void 0,done:!0}}while(!((t=n[e._i++])in e._t));return{value:t,done:!1}})),i(i.S,"Reflect",{enumerate:function(t){return new o(t)}})},6633:(t,e,n)=>{var i=n(8693),r=n(2985),o=n(7007);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return i.f(o(t),e)}})},8989:(t,e,n)=>{var i=n(2985),r=n(468),o=n(7007);i(i.S,"Reflect",{getPrototypeOf:function(t){return r(o(t))}})},3049:(t,e,n)=>{var i=n(8693),r=n(468),o=n(9181),s=n(2985),a=n(5286),u=n(7007);s(s.S,"Reflect",{get:function t(e,n){var s,l,h=arguments.length<3?e:arguments[2];return u(e)===h?e[n]:(s=i.f(e,n))?o(s,"value")?s.value:void 0!==s.get?s.get.call(h):void 0:a(l=r(e))?t(l,n,h):void 0}})},8270:(t,e,n)=>{var i=n(2985);i(i.S,"Reflect",{has:function(t,e){return e in t}})},4510:(t,e,n)=>{var i=n(2985),r=n(7007),o=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(t){return r(t),!o||o(t)}})},3984:(t,e,n)=>{var i=n(2985);i(i.S,"Reflect",{ownKeys:n(7643)})},5769:(t,e,n)=>{var i=n(2985),r=n(7007),o=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(t){r(t);try{return o&&o(t),!0}catch(t){return!1}}})},6014:(t,e,n)=>{var i=n(2985),r=n(7375);r&&i(i.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(t){return!1}}})},55:(t,e,n)=>{var i=n(9275),r=n(8693),o=n(468),s=n(9181),a=n(2985),u=n(681),l=n(7007),h=n(5286);a(a.S,"Reflect",{set:function t(e,n,a){var c,f,d=arguments.length<4?e:arguments[3],p=r.f(l(e),n);if(!p){if(h(f=o(e)))return t(f,n,a,d);p=u(0)}if(s(p,"value")){if(!1===p.writable||!h(d))return!1;if(c=r.f(d,n)){if(c.get||c.set||!1===c.writable)return!1;c.value=a,i.f(d,n,c)}else i.f(d,n,u(0,a));return!0}return void 0!==p.set&&(p.set.call(d,a),!0)}})},3946:(t,e,n)=>{var i=n(3816),r=n(266),o=n(9275).f,s=n(616).f,a=n(5364),u=n(3218),l=i.RegExp,h=l,c=l.prototype,f=/a/g,d=/a/g,p=new l(f)!==f;if(n(7057)&&(!p||n(4253)((function(){return d[n(6314)("match")]=!1,l(f)!=f||l(d)==d||"/a/i"!=l(f,"i")})))){l=function(t,e){var n=this instanceof l,i=a(t),o=void 0===e;return!n&&i&&t.constructor===l&&o?t:r(p?new h(i&&!o?t.source:t,e):h((i=t instanceof l)?t.source:t,i&&o?u.call(t):e),n?this:c,l)};for(var v=function(t){t in l||o(l,t,{configurable:!0,get:function(){return h[t]},set:function(e){h[t]=e}})},y=s(h),g=0;y.length>g;)v(y[g++]);c.constructor=l,l.prototype=c,n(7234)(i,"RegExp",l)}n(2974)("RegExp")},8269:(t,e,n)=>{"use strict";var i=n(1165);n(2985)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},6774:(t,e,n)=>{n(7057)&&"g"!=/./g.flags&&n(9275).f(RegExp.prototype,"flags",{configurable:!0,get:n(3218)})},1466:(t,e,n)=>{"use strict";var i=n(7007),r=n(875),o=n(6793),s=n(7787);n(8082)("match",1,(function(t,e,n,a){return[function(n){var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=a(n,t,this);if(e.done)return e.value;var u=i(t),l=String(this);if(!u.global)return s(u,l);var h=u.unicode;u.lastIndex=0;for(var c,f=[],d=0;null!==(c=s(u,l));){var p=String(c[0]);f[d]=p,""===p&&(u.lastIndex=o(l,r(u.lastIndex),h)),d++}return 0===d?null:f}]}))},9357:(t,e,n)=>{"use strict";var i=n(7007),r=n(508),o=n(875),s=n(1467),a=n(6793),u=n(7787),l=Math.max,h=Math.min,c=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g;n(8082)("replace",2,(function(t,e,n,p){return[function(i,r){var o=t(this),s=null==i?void 0:i[e];return void 0!==s?s.call(i,o,r):n.call(String(o),i,r)},function(t,e){var r=p(n,t,this,e);if(r.done)return r.value;var c=i(t),f=String(this),d="function"==typeof e;d||(e=String(e));var y=c.global;if(y){var g=c.unicode;c.lastIndex=0}for(var m=[];;){var b=u(c,f);if(null===b)break;if(m.push(b),!y)break;""===String(b[0])&&(c.lastIndex=a(f,o(c.lastIndex),g))}for(var x,w="",_=0,k=0;k<m.length;k++){b=m[k];for(var T=String(b[0]),E=l(h(s(b.index),f.length),0),S=[],A=1;A<b.length;A++)S.push(void 0===(x=b[A])?x:String(x));var P=b.groups;if(d){var O=[T].concat(S,E,f);void 0!==P&&O.push(P);var C=String(e.apply(void 0,O))}else C=v(T,f,E,S,P,e);E>=_&&(w+=f.slice(_,E)+C,_=E+T.length)}return w+f.slice(_)}];function v(t,e,i,o,s,a){var u=i+t.length,l=o.length,h=d;return void 0!==s&&(s=r(s),h=f),n.call(a,h,(function(n,r){var a;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,i);case"'":return e.slice(u);case"<":a=s[r.slice(1,-1)];break;default:var h=+r;if(0===h)return n;if(h>l){var f=c(h/10);return 0===f?n:f<=l?void 0===o[f-1]?r.charAt(1):o[f-1]+r.charAt(1):n}a=o[h-1]}return void 0===a?"":a}))}}))},6142:(t,e,n)=>{"use strict";var i=n(7007),r=n(7195),o=n(7787);n(8082)("search",1,(function(t,e,n,s){return[function(n){var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=s(n,t,this);if(e.done)return e.value;var a=i(t),u=String(this),l=a.lastIndex;r(l,0)||(a.lastIndex=0);var h=o(a,u);return r(a.lastIndex,l)||(a.lastIndex=l),null===h?-1:h.index}]}))},1876:(t,e,n)=>{"use strict";var i=n(5364),r=n(7007),o=n(8364),s=n(6793),a=n(875),u=n(7787),l=n(1165),h=n(4253),c=Math.min,f=[].push,d=4294967295,p=!h((function(){RegExp(d,"y")}));n(8082)("split",2,(function(t,e,n,h){var v;return v="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var r=String(this);if(void 0===t&&0===e)return[];if(!i(t))return n.call(r,t,e);for(var o,s,a,u=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),c=0,p=void 0===e?d:e>>>0,v=new RegExp(t.source,h+"g");(o=l.call(v,r))&&!((s=v.lastIndex)>c&&(u.push(r.slice(c,o.index)),o.length>1&&o.index<r.length&&f.apply(u,o.slice(1)),a=o[0].length,c=s,u.length>=p));)v.lastIndex===o.index&&v.lastIndex++;return c===r.length?!a&&v.test("")||u.push(""):u.push(r.slice(c)),u.length>p?u.slice(0,p):u}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,i){var r=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,r,i):v.call(String(r),n,i)},function(t,e){var i=h(v,t,this,e,v!==n);if(i.done)return i.value;var l=r(t),f=String(this),y=o(l,RegExp),g=l.unicode,m=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(p?"y":"g"),b=new y(p?l:"^(?:"+l.source+")",m),x=void 0===e?d:e>>>0;if(0===x)return[];if(0===f.length)return null===u(b,f)?[f]:[];for(var w=0,_=0,k=[];_<f.length;){b.lastIndex=p?_:0;var T,E=u(b,p?f:f.slice(_));if(null===E||(T=c(a(b.lastIndex+(p?0:_)),f.length))===w)_=s(f,_,g);else{if(k.push(f.slice(w,_)),k.length===x)return k;for(var S=1;S<=E.length-1;S++)if(k.push(E[S]),k.length===x)return k;_=w=T}}return k.push(f.slice(w)),k}]}))},6108:(t,e,n)=>{"use strict";n(6774);var i=n(7007),r=n(3218),o=n(7057),s="toString",a=/./.toString,u=function(t){n(7234)(RegExp.prototype,s,t,!0)};n(4253)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?u((function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)})):a.name!=s&&u((function(){return a.call(this)}))},8184:(t,e,n)=>{"use strict";var i=n(9824),r=n(1616);t.exports=n(5795)("Set",(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(r(this,"Set"),t=0===t?0:t,t)}},i)},856:(t,e,n)=>{"use strict";n(9395)("anchor",(function(t){return function(e){return t(this,"a","name",e)}}))},703:(t,e,n)=>{"use strict";n(9395)("big",(function(t){return function(){return t(this,"big","","")}}))},1539:(t,e,n)=>{"use strict";n(9395)("blink",(function(t){return function(){return t(this,"blink","","")}}))},5292:(t,e,n)=>{"use strict";n(9395)("bold",(function(t){return function(){return t(this,"b","","")}}))},9539:(t,e,n)=>{"use strict";var i=n(2985),r=n(4496)(!1);i(i.P,"String",{codePointAt:function(t){return r(this,t)}})},6620:(t,e,n)=>{"use strict";var i=n(2985),r=n(875),o=n(2094),s="endsWith",a="".endsWith;i(i.P+i.F*n(8852)(s),"String",{endsWith:function(t){var e=o(this,t,s),n=arguments.length>1?arguments[1]:void 0,i=r(e.length),u=void 0===n?i:Math.min(r(n),i),l=String(t);return a?a.call(e,l,u):e.slice(u-l.length,u)===l}})},6629:(t,e,n)=>{"use strict";n(9395)("fixed",(function(t){return function(){return t(this,"tt","","")}}))},3694:(t,e,n)=>{"use strict";n(9395)("fontcolor",(function(t){return function(e){return t(this,"font","color",e)}}))},7648:(t,e,n)=>{"use strict";n(9395)("fontsize",(function(t){return function(e){return t(this,"font","size",e)}}))},191:(t,e,n)=>{var i=n(2985),r=n(2337),o=String.fromCharCode,s=String.fromCodePoint;i(i.S+i.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments.length,s=0;i>s;){if(e=+arguments[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},2850:(t,e,n)=>{"use strict";var i=n(2985),r=n(2094),o="includes";i(i.P+i.F*n(8852)(o),"String",{includes:function(t){return!!~r(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},7795:(t,e,n)=>{"use strict";n(9395)("italics",(function(t){return function(){return t(this,"i","","")}}))},9115:(t,e,n)=>{"use strict";var i=n(4496)(!0);n(2923)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},4531:(t,e,n)=>{"use strict";n(9395)("link",(function(t){return function(e){return t(this,"a","href",e)}}))},8306:(t,e,n)=>{var i=n(2985),r=n(2110),o=n(875);i(i.S,"String",{raw:function(t){for(var e=r(t.raw),n=o(e.length),i=arguments.length,s=[],a=0;n>a;)s.push(String(e[a++])),a<i&&s.push(String(arguments[a]));return s.join("")}})},823:(t,e,n)=>{var i=n(2985);i(i.P,"String",{repeat:n(8595)})},3605:(t,e,n)=>{"use strict";n(9395)("small",(function(t){return function(){return t(this,"small","","")}}))},7732:(t,e,n)=>{"use strict";var i=n(2985),r=n(875),o=n(2094),s="startsWith",a="".startsWith;i(i.P+i.F*n(8852)(s),"String",{startsWith:function(t){var e=o(this,t,s),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return a?a.call(e,i,n):e.slice(n,n+i.length)===i}})},6780:(t,e,n)=>{"use strict";n(9395)("strike",(function(t){return function(){return t(this,"strike","","")}}))},9937:(t,e,n)=>{"use strict";n(9395)("sub",(function(t){return function(){return t(this,"sub","","")}}))},511:(t,e,n)=>{"use strict";n(9395)("sup",(function(t){return function(){return t(this,"sup","","")}}))},4564:(t,e,n)=>{"use strict";n(9599)("trim",(function(t){return function(){return t(this,3)}}))},5767:(t,e,n)=>{"use strict";var i=n(3816),r=n(9181),o=n(7057),s=n(2985),a=n(7234),u=n(4728).KEY,l=n(4253),h=n(3825),c=n(2943),f=n(3953),d=n(6314),p=n(8787),v=n(6074),y=n(5541),g=n(4302),m=n(7007),b=n(5286),x=n(508),w=n(2110),_=n(1689),k=n(681),T=n(2503),E=n(9327),S=n(8693),A=n(4548),P=n(9275),O=n(7184),C=S.f,M=P.f,R=E.f,I=i.Symbol,L=i.JSON,j=L&&L.stringify,B=d("_hidden"),D=d("toPrimitive"),F={}.propertyIsEnumerable,N=h("symbol-registry"),z=h("symbols"),U=h("op-symbols"),V=Object.prototype,G="function"==typeof I&&!!A.f,H=i.QObject,Y=!H||!H.prototype||!H.prototype.findChild,W=o&&l((function(){return 7!=T(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=C(V,e);i&&delete V[e],M(t,e,n),i&&t!==V&&M(V,e,i)}:M,X=function(t){var e=z[t]=T(I.prototype);return e._k=t,e},K=G&&"symbol"==typeof I.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof I},q=function(t,e,n){return t===V&&q(U,e,n),m(t),e=_(e,!0),m(n),r(z,e)?(n.enumerable?(r(t,B)&&t[B][e]&&(t[B][e]=!1),n=T(n,{enumerable:k(0,!1)})):(r(t,B)||M(t,B,k(1,{})),t[B][e]=!0),W(t,e,n)):M(t,e,n)},Z=function(t,e){m(t);for(var n,i=y(e=w(e)),r=0,o=i.length;o>r;)q(t,n=i[r++],e[n]);return t},J=function(t){var e=F.call(this,t=_(t,!0));return!(this===V&&r(z,t)&&!r(U,t))&&(!(e||!r(this,t)||!r(z,t)||r(this,B)&&this[B][t])||e)},Q=function(t,e){if(t=w(t),e=_(e,!0),t!==V||!r(z,e)||r(U,e)){var n=C(t,e);return!n||!r(z,e)||r(t,B)&&t[B][e]||(n.enumerable=!0),n}},$=function(t){for(var e,n=R(w(t)),i=[],o=0;n.length>o;)r(z,e=n[o++])||e==B||e==u||i.push(e);return i},tt=function(t){for(var e,n=t===V,i=R(n?U:w(t)),o=[],s=0;i.length>s;)!r(z,e=i[s++])||n&&!r(V,e)||o.push(z[e]);return o};G||(a((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var t=f(arguments.length>0?arguments[0]:void 0),e=function(n){this===V&&e.call(U,n),r(this,B)&&r(this[B],t)&&(this[B][t]=!1),W(this,t,k(1,n))};return o&&Y&&W(V,t,{configurable:!0,set:e}),X(t)}).prototype,"toString",(function(){return this._k})),S.f=Q,P.f=q,n(616).f=E.f=$,n(4682).f=J,A.f=tt,o&&!n(4461)&&a(V,"propertyIsEnumerable",J,!0),p.f=function(t){return X(d(t))}),s(s.G+s.W+s.F*!G,{Symbol:I});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)d(et[nt++]);for(var it=O(d.store),rt=0;it.length>rt;)v(it[rt++]);s(s.S+s.F*!G,"Symbol",{for:function(t){return r(N,t+="")?N[t]:N[t]=I(t)},keyFor:function(t){if(!K(t))throw TypeError(t+" is not a symbol!");for(var e in N)if(N[e]===t)return e},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),s(s.S+s.F*!G,"Object",{create:function(t,e){return void 0===e?T(t):Z(T(t),e)},defineProperty:q,defineProperties:Z,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:tt});var ot=l((function(){A.f(1)}));s(s.S+s.F*ot,"Object",{getOwnPropertySymbols:function(t){return A.f(x(t))}}),L&&s(s.S+s.F*(!G||l((function(){var t=I();return"[null]"!=j([t])||"{}"!=j({a:t})||"{}"!=j(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(b(e)||void 0!==t)&&!K(t))return g(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!K(e))return e}),i[1]=e,j.apply(L,i)}}),I.prototype[D]||n(7728)(I.prototype,D,I.prototype.valueOf),c(I,"Symbol"),c(Math,"Math",!0),c(i.JSON,"JSON",!0)},142:(t,e,n)=>{"use strict";var i=n(2985),r=n(9383),o=n(1125),s=n(7007),a=n(2337),u=n(875),l=n(5286),h=n(3816).ArrayBuffer,c=n(8364),f=o.ArrayBuffer,d=o.DataView,p=r.ABV&&h.isView,v=f.prototype.slice,y=r.VIEW,g="ArrayBuffer";i(i.G+i.W+i.F*(h!==f),{ArrayBuffer:f}),i(i.S+i.F*!r.CONSTR,g,{isView:function(t){return p&&p(t)||l(t)&&y in t}}),i(i.P+i.U+i.F*n(4253)((function(){return!new f(2).slice(1,void 0).byteLength})),g,{slice:function(t,e){if(void 0!==v&&void 0===e)return v.call(s(this),t);for(var n=s(this).byteLength,i=a(t,n),r=a(void 0===e?n:e,n),o=new(c(this,f))(u(r-i)),l=new d(this),h=new d(o),p=0;i<r;)h.setUint8(p++,l.getUint8(i++));return o}}),n(2974)(g)},1786:(t,e,n)=>{var i=n(2985);i(i.G+i.W+i.F*!n(9383).ABV,{DataView:n(1125).DataView})},162:(t,e,n)=>{n(8440)("Float32",4,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},3834:(t,e,n)=>{n(8440)("Float64",8,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},4821:(t,e,n)=>{n(8440)("Int16",2,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},1303:(t,e,n)=>{n(8440)("Int32",4,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},5368:(t,e,n)=>{n(8440)("Int8",1,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},9103:(t,e,n)=>{n(8440)("Uint16",2,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},3318:(t,e,n)=>{n(8440)("Uint32",4,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},6964:(t,e,n)=>{n(8440)("Uint8",1,(function(t){return function(e,n,i){return t(this,e,n,i)}}))},2152:(t,e,n)=>{n(8440)("Uint8",1,(function(t){return function(e,n,i){return t(this,e,n,i)}}),!0)},147:(t,e,n)=>{"use strict";var i,r=n(3816),o=n(50)(0),s=n(7234),a=n(4728),u=n(5345),l=n(3657),h=n(5286),c=n(1616),f=n(1616),d=!r.ActiveXObject&&"ActiveXObject"in r,p="WeakMap",v=a.getWeak,y=Object.isExtensible,g=l.ufstore,m=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},b={get:function(t){if(h(t)){var e=v(t);return!0===e?g(c(this,p)).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(c(this,p),t,e)}},x=t.exports=n(5795)(p,m,b,l,!0,!0);f&&d&&(u((i=l.getConstructor(m,p)).prototype,b),a.NEED=!0,o(["delete","has","get","set"],(function(t){var e=x.prototype,n=e[t];s(e,t,(function(e,r){if(h(e)&&!y(e)){this._f||(this._f=new i);var o=this._f[t](e,r);return"set"==t?this:o}return n.call(this,e,r)}))})))},9192:(t,e,n)=>{"use strict";var i=n(3657),r=n(1616),o="WeakSet";n(5795)(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(r(this,o),t,!0)}},i,!1,!0)},1268:(t,e,n)=>{"use strict";var i=n(2985),r=n(3325),o=n(508),s=n(875),a=n(4963),u=n(6886);i(i.P,"Array",{flatMap:function(t){var e,n,i=o(this);return a(t),e=s(i.length),n=u(i,0),r(n,i,i,e,0,1,t,arguments[1]),n}}),n(7722)("flatMap")},2773:(t,e,n)=>{"use strict";var i=n(2985),r=n(9315)(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(7722)("includes")},3276:(t,e,n)=>{var i=n(2985),r=n(1131)(!0);i(i.S,"Object",{entries:function(t){return r(t)}})},8351:(t,e,n)=>{var i=n(2985),r=n(7643),o=n(2110),s=n(8693),a=n(2811);i(i.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,i=o(t),u=s.f,l=r(i),h={},c=0;l.length>c;)void 0!==(n=u(i,e=l[c++]))&&a(h,e,n);return h}})},6409:(t,e,n)=>{var i=n(2985),r=n(1131)(!1);i(i.S,"Object",{values:function(t){return r(t)}})},9865:(t,e,n)=>{"use strict";var i=n(2985),r=n(5645),o=n(3816),s=n(8364),a=n(94);i(i.P+i.R,"Promise",{finally:function(t){var e=s(this,r.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return a(e,t()).then((function(){return n}))}:t,n?function(n){return a(e,t()).then((function(){throw n}))}:t)}})},2770:(t,e,n)=>{"use strict";var i=n(2985),r=n(5442),o=n(575),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*s,"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},1784:(t,e,n)=>{"use strict";var i=n(2985),r=n(5442),o=n(575),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*s,"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},5869:(t,e,n)=>{"use strict";n(9599)("trimLeft",(function(t){return function(){return t(this,1)}}),"trimStart")},4325:(t,e,n)=>{"use strict";n(9599)("trimRight",(function(t){return function(){return t(this,2)}}),"trimEnd")},9665:(t,e,n)=>{n(6074)("asyncIterator")},1181:(t,e,n)=>{for(var i=n(6997),r=n(7184),o=n(7234),s=n(3816),a=n(7728),u=n(2803),l=n(6314),h=l("iterator"),c=l("toStringTag"),f=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(d),v=0;v<p.length;v++){var y,g=p[v],m=d[g],b=s[g],x=b&&b.prototype;if(x&&(x[h]||a(x,h,f),x[c]||a(x,c,g),u[g]=f,m))for(y in i)x[y]||o(x,y,i[y],!0)}},4633:(t,e,n)=>{var i=n(2985),r=n(4193);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},2564:(t,e,n)=>{var i=n(3816),r=n(2985),o=n(575),s=[].slice,a=/MSIE .\./.test(o),u=function(t){return function(e,n){var i=arguments.length>2,r=!!i&&s.call(arguments,2);return t(i?function(){("function"==typeof e?e:Function(e)).apply(this,r)}:e,n)}};r(r.G+r.B+r.F*a,{setTimeout:u(i.setTimeout),setInterval:u(i.setInterval)})},6337:(t,e,n)=>{n(2564),n(4633),n(1181),t.exports=n(5645)},1424:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),r=n.n(i),o=n(3645),s=n.n(o)()(r());s.push([t.id,"body {\n\n    background-color: black;\n    color: white;\n\n    /* Allow mouse dragging. */\n    -moz-user-select: none;\n    -ms-user-select: none;\n    -o-user-select: none;\n    -webkit-user-select: none;\n    user-select: none;\n\n    /* disable touch panning/zooming */\n    -ms-touch-action: none;\n    touch-action: none;\n\n    /* Allow canvas to hit the edges of the browser viewport. */\n    margin: 0;\n}\n\n#screen canvas {\n    margin: auto;\n    /* Hide the gap for font descenders. */\n    display: block;\n}\n",""]);const a=s},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var u=this[a][0];null!=u&&(s[u]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);i&&s[h[0]]||(void 0!==o&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=o),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),r&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=r):h[4]="".concat(r)),e.push(h))}},e}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},5666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,i){var r=e&&e.prototype instanceof y?e:y,o=Object.create(r.prototype),s=new P(i||[]);return o._invoke=function(t,e,n){var i=c;return function(r,o){if(i===d)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw o;return C()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=E(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===c)throw i=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=d;var u=h(t,e,n);if("normal"===u.type){if(i=n.done?p:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=p,n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var c="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function y(){}function g(){}function m(){}var b={};u(b,o,(function(){return this}));var x=Object.getPrototypeOf,w=x&&x(x(O([])));w&&w!==n&&i.call(w,o)&&(b=w);var _=m.prototype=y.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(r,o,s,a){var u=h(t[r],t,o);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(c).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,a)}))}a(u.arg)}var r;this._invoke=function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}}function E(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=h(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:C}}function C(){return{value:e,done:!0}}return g.prototype=m,u(_,"constructor",m),u(m,"constructor",g),g.displayName=u(m,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,a,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},k(T.prototype),u(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new T(l(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},k(_),u(_,a,"Generator"),u(_,o,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=O,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return a.type="throw",a.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var u=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(u&&l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;A(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:O(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},s=[],a=0;a<t.length;a++){var u=t[a],l=i.base?u[0]+i.base:u[0],h=o[l]||0,c="".concat(l," ").concat(h);o[l]=h+1;var f=n(c),d={css:u[1],media:u[2],sourceMap:u[3],supports:u[4],layer:u[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var p=r(d,i);i.byIndex=a,e.splice(a,0,{identifier:c,updater:p,references:1})}s.push(c)}return s}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var u=i(t,r),l=0;l<o.length;l++){var h=n(o[l]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}o=u}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},609:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},3380:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{"use strict";n(1983);var t,e=(t=n(115))&&t.__esModule?t:{default:t};e.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),e.default._babelPolyfill=!0})(),(()=>{"use strict";function t(t,n){if(t){if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e(t,n):void 0}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function i(){return i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},i.apply(this,arguments)}function r(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=h(t)););return t}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}function s(t,e){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=h(t);if(e){var r=h(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(t,e){if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}var v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},y=function(t){return t&&t.Math==Math&&t},g=y("object"==("undefined"==typeof globalThis?"undefined":p(globalThis))&&globalThis)||y("object"==("undefined"==typeof window?"undefined":p(window))&&window)||y("object"==("undefined"==typeof self?"undefined":p(self))&&self)||y("object"==p(v)&&v)||function(){return this}()||Function("return this")(),m={},b=function(t){try{return!!t()}catch(t){return!0}},x=!b((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),w=!b((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=w,k=Function.prototype.call,T=_?k.bind(k):function(){return k.apply(k,arguments)},E={},S={}.propertyIsEnumerable,A=Object.getOwnPropertyDescriptor,P=A&&!S.call({1:2},1);E.f=P?function(t){var e=A(this,t);return!!e&&e.enumerable}:S;var O,C,M=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},R=w,I=Function.prototype,L=I.bind,j=I.call,B=R&&L.bind(j,j),D=R?function(t){return t&&B(t)}:function(t){return t&&function(){return j.apply(t,arguments)}},F=D,N=F({}.toString),z=F("".slice),U=function(t){return z(N(t),8,-1)},V=b,G=U,H=Object,Y=D("".split),W=V((function(){return!H("z").propertyIsEnumerable(0)}))?function(t){return"String"==G(t)?Y(t,""):H(t)}:H,X=TypeError,K=function(t){if(null==t)throw X("Can't call method on "+t);return t},q=W,Z=K,J=function(t){return q(Z(t))},Q=function(t){return"function"==typeof t},$=Q,tt=function(t){return"object"==p(t)?null!==t:$(t)},et=g,nt=Q,it=function(t){return nt(t)?t:void 0},rt=function(t,e){return arguments.length<2?it(et[t]):et[t]&&et[t][e]},ot=D({}.isPrototypeOf),st=g,at=rt("navigator","userAgent")||"",ut=st.process,lt=st.Deno,ht=ut&&ut.versions||lt&&lt.version,ct=ht&&ht.v8;ct&&(C=(O=ct.split("."))[0]>0&&O[0]<4?1:+(O[0]+O[1])),!C&&at&&(!(O=at.match(/Edge\/(\d+)/))||O[1]>=74)&&(O=at.match(/Chrome\/(\d+)/))&&(C=+O[1]);var ft=C,dt=b,pt=!!Object.getOwnPropertySymbols&&!dt((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ft&&ft<41})),vt=pt&&!Symbol.sham&&"symbol"==p(Symbol.iterator),yt=rt,gt=Q,mt=ot,bt=Object,xt=vt?function(t){return"symbol"==p(t)}:function(t){var e=yt("Symbol");return gt(e)&&mt(e.prototype,bt(t))},wt=String,_t=Q,kt=TypeError,Tt=function(t){if(_t(t))return t;throw kt(function(t){try{return wt(t)}catch(t){return"Object"}}(t)+" is not a function")},Et=T,St=Q,At=tt,Pt=TypeError,Ot={exports:{}},Ct=g,Mt=Object.defineProperty,Rt=function(t,e){try{Mt(Ct,t,{value:e,configurable:!0,writable:!0})}catch(n){Ct[t]=e}return e},It=Rt,Lt="__core-js_shared__",jt=g[Lt]||It(Lt,{}),Bt=jt;(Ot.exports=function(t,e){return Bt[t]||(Bt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.23.4",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.4/LICENSE",source:"https://github.com/zloirock/core-js"});var Dt=K,Ft=Object,Nt=D({}.hasOwnProperty),zt=Object.hasOwn||function(t,e){return Nt(Ft(Dt(t)),e)},Ut=D,Vt=0,Gt=Math.random(),Ht=Ut(1..toString),Yt=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Ht(++Vt+Gt,36)},Wt=g,Xt=Ot.exports,Kt=zt,qt=Yt,Zt=pt,Jt=vt,Qt=Xt("wks"),$t=Wt.Symbol,te=$t&&$t.for,ee=Jt?$t:$t&&$t.withoutSetter||qt,ne=function(t){if(!Kt(Qt,t)||!Zt&&"string"!=typeof Qt[t]){var e="Symbol."+t;Zt&&Kt($t,t)?Qt[t]=$t[t]:Qt[t]=Jt&&te?te(e):ee(e)}return Qt[t]},ie=T,re=tt,oe=xt,se=TypeError,ae=ne("toPrimitive"),ue=function(t,e){if(!re(t)||oe(t))return t;var n,i,r=null==(i=t[ae])?void 0:Tt(i);if(r){if(void 0===e&&(e="default"),n=ie(r,t,e),!re(n)||oe(n))return n;throw se("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var n,i;if("string"===e&&St(n=t.toString)&&!At(i=Et(n,t)))return i;if(St(n=t.valueOf)&&!At(i=Et(n,t)))return i;if("string"!==e&&St(n=t.toString)&&!At(i=Et(n,t)))return i;throw Pt("Can't convert object to primitive value")}(t,e)},le=xt,he=function(t){var e=ue(t,"string");return le(e)?e:e+""},ce=tt,fe=g.document,de=ce(fe)&&ce(fe.createElement),pe=!x&&!b((function(){return 7!=Object.defineProperty((t="div",de?fe.createElement(t):{}),"a",{get:function(){return 7}}).a;var t})),ve=x,ye=T,ge=E,me=M,be=J,xe=he,we=zt,_e=pe,ke=Object.getOwnPropertyDescriptor;m.f=ve?ke:function(t,e){if(t=be(t),e=xe(e),_e)try{return ke(t,e)}catch(t){}if(we(t,e))return me(!ye(ge.f,t,e),t[e])};var Te={},Ee=x&&b((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Se=tt,Ae=String,Pe=TypeError,Oe=function(t){if(Se(t))return t;throw Pe(Ae(t)+" is not an object")},Ce=x,Me=pe,Re=Ee,Ie=Oe,Le=he,je=TypeError,Be=Object.defineProperty,De=Object.getOwnPropertyDescriptor;Te.f=Ce?Re?function(t,e,n){if(Ie(t),e=Le(e),Ie(n),"function"==typeof t&&"prototype"===e&&"value"in n&&"writable"in n&&!n.writable){var i=De(t,e);i&&i.writable&&(t[e]=n.value,n={configurable:"configurable"in n?n.configurable:i.configurable,enumerable:"enumerable"in n?n.enumerable:i.enumerable,writable:!1})}return Be(t,e,n)}:Be:function(t,e,n){if(Ie(t),e=Le(e),Ie(n),Me)try{return Be(t,e,n)}catch(t){}if("get"in n||"set"in n)throw je("Accessors not supported");return"value"in n&&(t[e]=n.value),t};var Fe=Te,Ne=M,ze=x?function(t,e,n){return Fe.f(t,e,Ne(1,n))}:function(t,e,n){return t[e]=n,t},Ue={exports:{}},Ve=x,Ge=zt,He=Function.prototype,Ye=Ve&&Object.getOwnPropertyDescriptor,We=Ge(He,"name"),Xe={EXISTS:We,PROPER:We&&"something"===function(){}.name,CONFIGURABLE:We&&(!Ve||Ve&&Ye(He,"name").configurable)},Ke=Q,qe=jt,Ze=D(Function.toString);Ke(qe.inspectSource)||(qe.inspectSource=function(t){return Ze(t)});var Je,Qe,$e,tn,en=qe.inspectSource,nn=Q,rn=en,on=g.WeakMap,sn=nn(on)&&/native code/.test(rn(on)),an=Ot.exports,un=Yt,ln=an("keys"),hn={},cn=sn,fn=g,dn=D,pn=tt,vn=ze,yn=zt,gn=jt,mn=hn,bn="Object already initialized",xn=fn.TypeError,wn=fn.WeakMap;if(cn||gn.state){var _n=gn.state||(gn.state=new wn),kn=dn(_n.get),Tn=dn(_n.has),En=dn(_n.set);Je=function(t,e){if(Tn(_n,t))throw new xn(bn);return e.facade=t,En(_n,t,e),e},Qe=function(t){return kn(_n,t)||{}},$e=function(t){return Tn(_n,t)}}else{var Sn=ln[tn="state"]||(ln[tn]=un(tn));mn[Sn]=!0,Je=function(t,e){if(yn(t,Sn))throw new xn(bn);return e.facade=t,vn(t,Sn,e),e},Qe=function(t){return yn(t,Sn)?t[Sn]:{}},$e=function(t){return yn(t,Sn)}}var An={set:Je,get:Qe,has:$e,enforce:function(t){return $e(t)?Qe(t):Je(t,{})},getterFor:function(t){return function(e){var n;if(!pn(e)||(n=Qe(e)).type!==t)throw xn("Incompatible receiver, "+t+" required");return n}}},Pn=b,On=Q,Cn=zt,Mn=x,Rn=Xe.CONFIGURABLE,In=en,Ln=An.enforce,jn=An.get,Bn=Object.defineProperty,Dn=Mn&&!Pn((function(){return 8!==Bn((function(){}),"length",{value:8}).length})),Fn=String(String).split("String"),Nn=Ue.exports=function(t,e,n){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Cn(t,"name")||Rn&&t.name!==e)&&(Mn?Bn(t,"name",{value:e,configurable:!0}):t.name=e),Dn&&n&&Cn(n,"arity")&&t.length!==n.arity&&Bn(t,"length",{value:n.arity});try{n&&Cn(n,"constructor")&&n.constructor?Mn&&Bn(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var i=Ln(t);return Cn(i,"source")||(i.source=Fn.join("string"==typeof e?e:"")),t};Function.prototype.toString=Nn((function(){return On(this)&&jn(this).source||In(this)}),"toString");var zn=Q,Un=Te,Vn=Ue.exports,Gn=Rt,Hn={},Yn=Math.ceil,Wn=Math.floor,Xn=Math.trunc||function(t){var e=+t;return(e>0?Wn:Yn)(e)},Kn=Xn,qn=function(t){var e=+t;return e!=e||0===e?0:Kn(e)},Zn=qn,Jn=Math.max,Qn=Math.min,$n=qn,ti=Math.min,ei=J,ni=function(t){return(e=t.length)>0?ti($n(e),9007199254740991):0;var e},ii=function(t){return function(e,n,i){var r,o=ei(e),s=ni(o),a=function(t,e){var n=Zn(t);return n<0?Jn(n+e,0):Qn(n,e)}(i,s);if(t&&n!=n){for(;s>a;)if((r=o[a++])!=r)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===n)return t||a||0;return!t&&-1}},ri={includes:ii(!0),indexOf:ii(!1)},oi=zt,si=J,ai=ri.indexOf,ui=hn,li=D([].push),hi=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype");Hn.f=Object.getOwnPropertyNames||function(t){return function(t,e){var n,i=si(t),r=0,o=[];for(n in i)!oi(ui,n)&&oi(i,n)&&li(o,n);for(;e.length>r;)oi(i,n=e[r++])&&(~ai(o,n)||li(o,n));return o}(t,hi)};var ci={};ci.f=Object.getOwnPropertySymbols;var fi=rt,di=Hn,pi=ci,vi=Oe,yi=D([].concat),gi=fi("Reflect","ownKeys")||function(t){var e=di.f(vi(t)),n=pi.f;return n?yi(e,n(t)):e},mi=zt,bi=gi,xi=m,wi=Te,_i=b,ki=Q,Ti=/#|\.prototype\./,Ei=function(t,e){var n=Ai[Si(t)];return n==Oi||n!=Pi&&(ki(e)?_i(e):!!e)},Si=Ei.normalize=function(t){return String(t).replace(Ti,".").toLowerCase()},Ai=Ei.data={},Pi=Ei.NATIVE="N",Oi=Ei.POLYFILL="P",Ci=Ei,Mi=g,Ri=m.f,Ii=ze,Li=function(t,e,n,i){i||(i={});var r=i.enumerable,o=void 0!==i.name?i.name:e;if(zn(n)&&Vn(n,o,i),i.global)r?t[e]=n:Gn(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch(t){}r?t[e]=n:Un.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},ji=Rt,Bi=function(t,e,n){for(var i=bi(e),r=wi.f,o=xi.f,s=0;s<i.length;s++){var a=i[s];mi(t,a)||n&&mi(n,a)||r(t,a,o(e,a))}},Di=Ci,Fi=function(t,e){var n,i,r,o,s,a=t.target,u=t.global,l=t.stat;if(n=u?Mi:l?Mi[a]||ji(a,{}):(Mi[a]||{}).prototype)for(i in e){if(o=e[i],r=t.dontCallGetSet?(s=Ri(n,i))&&s.value:n[i],!Di(u?i:a+(l?".":"#")+i,t.forced)&&void 0!==r){if(p(o)==p(r))continue;Bi(o,r)}(t.sham||r&&r.sham)&&Ii(o,"sham",!0),Li(n,i,o,t)}};Fi({global:!0},{globalThis:g});var Ni={};Ni[ne("toStringTag")]="z";var zi="[object z]"===String(Ni),Ui=Q,Vi=U,Gi=ne("toStringTag"),Hi=Object,Yi="Arguments"==Vi(function(){return arguments}()),Wi=zi?Vi:function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Hi(t),Gi))?n:Yi?Vi(e):"Object"==(i=Vi(e))&&Ui(e.callee)?"Arguments":i},Xi=String,Ki=K,qi=D("".replace),Zi="[\t\n\v\f\r                　\u2028\u2029\ufeff]",Ji=RegExp("^"+Zi+Zi+"*"),Qi=RegExp(Zi+Zi+"*$"),$i=function(t){return function(e){var n=function(t){if("Symbol"===Wi(t))throw TypeError("Cannot convert a Symbol value to a string");return Xi(t)}(Ki(e));return 1&t&&(n=qi(n,Ji,"")),2&t&&(n=qi(n,Qi,"")),n}},tr={start:$i(1),end:$i(2),trim:$i(3)},er=Xe.PROPER,nr=b,ir="\t\n\v\f\r                　\u2028\u2029\ufeff",rr=function(t){return nr((function(){return!!ir[t]()||"​᠎"!=="​᠎"[t]()||er&&ir[t].name!==t}))},or=tr.start,sr=rr("trimStart")?function(){return or(this)}:"".trimStart;Fi({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==sr},{trimLeft:sr}),Fi({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==sr},{trimStart:sr});var ar=g,ur=D,lr=function(t,e){return ur(ar[t].prototype[e])};lr("String","trimLeft");var hr=tr.end,cr=rr("trimEnd")?function(){return hr(this)}:"".trimEnd;if(Fi({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==cr},{trimRight:cr}),Fi({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==cr},{trimEnd:cr}),lr("String","trimRight"),"undefined"!=typeof globalThis&&void 0===globalThis.console&&(globalThis.console={},globalThis.console.log=function(){},globalThis.console.assert=function(){},globalThis.console.warn=function(){},globalThis.console.error=function(){alert(Array.prototype.slice.call(arguments).join(", "))}),"performance"in globalThis==0&&(globalThis.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in globalThis.performance==0){var fr=Date.now();performance.timing&&performance.timing.navigationStart&&(fr=performance.timing.navigationStart),globalThis.performance.now=function(){return Date.now()-fr}}function dr(t){return t.charAt(0).toUpperCase()+t.slice(1)}function pr(t){return"string"==typeof t&&(t=t.trim()),!isNaN(t)&&/[+-]?([0-9]*[.])?[0-9]+/.test(t)}function vr(t){var e=t.trim();return"true"===e||"false"===e}function yr(t){for(var e="",n=0;n<t.length;)e+=t.charCodeAt(n++).toString(16);return e}function gr(t){return/^data:(.+);base64,(.+)$/.test(t)}var mr=Object.freeze({__proto__:null,capitalize:dr,isNumeric:pr,isBoolean:vr,toHex:yr,isDataUrl:gr}),br=["ms","MS","moz","webkit","o"];function xr(t,e){if(t in(e=e||globalThis))return e[t];var n,i=dr(t);return br.some((function(t){var r=t+i;return n=r in e?e[r]:void 0})),n}function wr(t,e,n){if(!(t in(n=n||globalThis))){var i=dr(t);return br.some((function(t){var r=t+i;if(r in n)return n[r]=e,!0})),!1}n[t]=e}var _r=Object.freeze({__proto__:null,prefixed:xr,setPrefixed:wr}),kr=Math.PI/180,Tr=(Math.PI,2*Math.PI),Er=.5*Math.PI;function Sr(t){return 0==(t&t-1)}function Ar(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Pr(t){return t*kr}function Or(t,e,n){return t<e?e:t>n?n:+t}function Cr(t,e){return~~(Math.random()*(e-t))+t}function Mr(t,e){return Math.random()*(e-t)+t}function Rr(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return Math.abs(t-e)<Math.pow(10,-n)/2}function Ir(t,e){var n=Array.prototype.indexOf.call(t,e);return-1!==n&&Array.prototype.splice.call(t,n,1),t}var Lr=Object.freeze({__proto__:null,remove:Ir,random:function(t){return t[Cr(0,t.length)]},weightedRandom:function(t){return t[function(t,e){return~~(Math.pow(Math.random(),2)*(e-t))+t}(0,t.length)]}}),jr=/^.*(\\|\/|\:)/,Br=/\.[^\.]*$/;function Dr(t){return t.replace(jr,"").replace(Br,"")}function Fr(t){return t.substring(t.lastIndexOf(".")+1,t.length)}var Nr=Object.freeze({__proto__:null,getBasename:Dr,getExtension:Fr});function zr(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return setTimeout.apply(void 0,[t.bind(e),.01].concat(i))}function Ur(t,e,n){var i,r=globalThis.performance.now();return"boolean"!=typeof n&&(n=!1),function(){var o=globalThis.performance.now(),s=o-r,a=arguments;if(!(s<e))return r=o,t.apply(null,a);!1===n&&(clearTimeout(i),i=setTimeout((function(){return r=o,t.apply(null,a)}),s))}}var Vr=Object.freeze({__proto__:null,defer:zr,throttle:Ur}),Gr=new(function(){function t(){c(this,t),this.objectClass={},this.instance_counter=0}return d(t,[{key:"register",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0===e)throw new Error("Cannot register object '"+t+"', invalid class");this.objectClass[t]={class:e,pool:n?[]:void 0}}},{key:"pull",value:function(t){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=arguments[n];var i=this.objectClass[t];if(i){var r,o=i.class,s=i.pool;return s&&(r=s.pop())?(e.shift(),"function"==typeof r.onResetEvent&&r.onResetEvent.apply(r,e),this.instance_counter--):(e[0]=o,r=new(o.bind.apply(o,e)),s&&(r.className=t)),r}throw new Error("Cannot instantiate object of type '"+t+"'")}},{key:"purge",value:function(){for(var t in this.objectClass)this.objectClass[t]&&(this.objectClass[t].pool=[]);this.instance_counter=0}},{key:"push",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.poolable(t)){if(!0===e)throw new Error("me.pool: object "+t+" cannot be recycled");return!1}return this.objectClass[t.className].pool.push(t),this.instance_counter++,!0}},{key:"exists",value:function(t){return t in this.objectClass}},{key:"poolable",value:function(t){var e=t.className;return void 0!==e&&"function"==typeof t.onResetEvent&&e in this.objectClass&&void 0!==this.objectClass[e].pool}},{key:"getInstanceCount",value:function(){return this.instance_counter}}]),t}()),Hr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;c(this,t),this.onResetEvent(e,n)}return d(t,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t,this.y=e,this}},{key:"_set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"set",value:function(t,e){if(t!==+t||e!==+e)throw new Error("invalid x,y parameters (not a number)");return this._set(t,e)}},{key:"setZero",value:function(){return this.set(0,0)}},{key:"setV",value:function(t){return this._set(t.x,t.y)}},{key:"add",value:function(t){return this._set(this.x+t.x,this.y+t.y)}},{key:"sub",value:function(t){return this._set(this.x-t.x,this.y-t.y)}},{key:"scale",value:function(t,e){return this._set(this.x*t,this.y*(void 0!==e?e:t))}},{key:"toIso",value:function(){return this._set(this.x-this.y,.5*(this.x+this.y))}},{key:"to2d",value:function(){return this._set(this.y+this.x/2,this.y-this.x/2)}},{key:"scaleV",value:function(t){return this._set(this.x*t.x,this.y*t.y)}},{key:"div",value:function(t){return this._set(this.x/t,this.y/t)}},{key:"abs",value:function(){return this._set(this.x<0?-this.x:this.x,this.y<0?-this.y:this.y)}},{key:"clamp",value:function(e,n){return new t(Or(this.x,e,n),Or(this.y,e,n))}},{key:"clampSelf",value:function(t,e){return this._set(Or(this.x,t,e),Or(this.y,t,e))}},{key:"minV",value:function(t){return this._set(this.x<t.x?this.x:t.x,this.y<t.y?this.y:t.y)}},{key:"maxV",value:function(t){return this._set(this.x>t.x?this.x:t.x,this.y>t.y?this.y:t.y)}},{key:"floor",value:function(){return new t(Math.floor(this.x),Math.floor(this.y))}},{key:"floorSelf",value:function(){return this._set(Math.floor(this.x),Math.floor(this.y))}},{key:"ceil",value:function(){return new t(Math.ceil(this.x),Math.ceil(this.y))}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this.x),Math.ceil(this.y))}},{key:"negate",value:function(){return new t(-this.x,-this.y)}},{key:"negateSelf",value:function(){return this._set(-this.x,-this.y)}},{key:"copy",value:function(t){return this._set(t.x,t.y)}},{key:"equals",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.x===t&&this.y===e}},{key:"normalize",value:function(){return this.div(this.length()||1)}},{key:"perp",value:function(){return this._set(this.y,-this.x)}},{key:"rotate",value:function(t,e){var n=0,i=0;"object"===p(e)&&(n=e.x,i=e.y);var r=this.x-n,o=this.y-i,s=Math.cos(t),a=Math.sin(t);return this._set(r*s-o*a+n,r*a+o*s+i)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(t){return this.x*t.y-this.y*t.x}},{key:"length2",value:function(){return this.dot(this)}},{key:"length",value:function(){return Math.sqrt(this.length2())}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}},{key:"distance",value:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}},{key:"angle",value:function(t){return Math.acos(Or(this.dot(t)/(this.length()*t.length()),-1,1))}},{key:"project",value:function(t){return this.scale(this.dot(t)/t.length2())}},{key:"projectN",value:function(t){return this.scale(this.dot(t))}},{key:"clone",value:function(){return Gr.pull("Vector2d",this.x,this.y)}},{key:"toString",value:function(){return"x:"+this.x+",y:"+this.y}}]),t}(),Yr=function(t){return"0123456789ABCDEF".charAt(t-t%16>>4)+"0123456789ABCDEF".charAt(t%16)},Wr=/^rgba?\((\d+), ?(\d+), ?(\d+)(, ?([\d\.]+))?\)$/,Xr=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,Kr=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,qr=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,Zr=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,Jr=new Map;[["black",[0,0,0]],["silver",[192,192,129]],["gray",[128,128,128]],["white",[255,255,255]],["maroon",[128,0,0]],["red",[255,0,0]],["purple",[128,0,128]],["fuchsia",[255,0,255]],["green",[0,128,0]],["lime",[0,255,0]],["olive",[128,128,0]],["yellow",[255,255,0]],["navy",[0,0,128]],["blue",[0,0,255]],["teal",[0,128,128]],["aqua",[0,255,255]],["orange",[255,165,0]],["aliceblue",[240,248,245]],["antiquewhite",[250,235,215]],["aquamarine",[127,255,212]],["azure",[240,255,255]],["beige",[245,245,220]],["bisque",[255,228,196]],["blanchedalmond",[255,235,205]],["blueviolet",[138,43,226]],["brown",[165,42,42]],["burlywood",[222,184,35]],["cadetblue",[95,158,160]],["chartreuse",[127,255,0]],["chocolate",[210,105,30]],["coral",[255,127,80]],["cornflowerblue",[100,149,237]],["cornsilk",[255,248,220]],["crimson",[220,20,60]],["darkblue",[0,0,139]],["darkcyan",[0,139,139]],["darkgoldenrod",[184,134,11]],["darkgray[*]",[169,169,169]],["darkgreen",[0,100,0]],["darkgrey[*]",[169,169,169]],["darkkhaki",[189,183,107]],["darkmagenta",[139,0,139]],["darkolivegreen",[85,107,47]],["darkorange",[255,140,0]],["darkorchid",[153,50,204]],["darkred",[139,0,0]],["darksalmon",[233,150,122]],["darkseagreen",[143,188,143]],["darkslateblue",[72,61,139]],["darkslategray",[47,79,79]],["darkslategrey",[47,79,79]],["darkturquoise",[0,206,209]],["darkviolet",[148,0,211]],["deeppink",[255,20,147]],["deepskyblue",[0,191,255]],["dimgray",[105,105,105]],["dimgrey",[105,105,105]],["dodgerblue",[30,144,255]],["firebrick",[178,34,34]],["floralwhite",[255,250,240]],["forestgreen",[34,139,34]],["gainsboro",[220,220,220]],["ghostwhite",[248,248,255]],["gold",[255,215,0]],["goldenrod",[218,165,32]],["greenyellow",[173,255,47]],["grey",[128,128,128]],["honeydew",[240,255,240]],["hotpink",[255,105,180]],["indianred",[205,92,92]],["indigo",[75,0,130]],["ivory",[255,255,240]],["khaki",[240,230,140]],["lavender",[230,230,250]],["lavenderblush",[255,240,245]],["lawngreen",[124,252,0]],["lemonchiffon",[255,250,205]],["lightblue",[173,216,230]],["lightcoral",[240,128,128]],["lightcyan",[224,255,255]],["lightgoldenrodyellow",[250,250,210]],["lightgray",[211,211,211]],["lightgreen",[144,238,144]],["lightgrey",[211,211,211]],["lightpink",[255,182,193]],["lightsalmon",[255,160,122]],["lightseagreen",[32,178,170]],["lightskyblue",[135,206,250]],["lightslategray",[119,136,153]],["lightslategrey",[119,136,153]],["lightsteelblue",[176,196,222]],["lightyellow",[255,255,224]],["limegreen",[50,205,50]],["linen",[250,240,230]],["mediumaquamarine",[102,205,170]],["mediumblue",[0,0,205]],["mediumorchid",[186,85,211]],["mediumpurple",[147,112,219]],["mediumseagreen",[60,179,113]],["mediumslateblue",[123,104,238]],["mediumspringgreen",[0,250,154]],["mediumturquoise",[72,209,204]],["mediumvioletred",[199,21,133]],["midnightblue",[25,25,112]],["mintcream",[245,255,250]],["mistyrose",[255,228,225]],["moccasin",[255,228,181]],["navajowhite",[255,222,173]],["oldlace",[253,245,230]],["olivedrab",[107,142,35]],["orangered",[255,69,0]],["orchid",[218,112,214]],["palegoldenrod",[238,232,170]],["palegreen",[152,251,152]],["paleturquoise",[175,238,238]],["palevioletred",[219,112,147]],["papayawhip",[255,239,213]],["peachpuff",[255,218,185]],["peru",[205,133,63]],["pink",[255,192,203]],["plum",[221,160,221]],["powderblue",[176,224,230]],["rosybrown",[188,143,143]],["royalblue",[65,105,225]],["saddlebrown",[139,69,19]],["salmon",[250,128,114]],["sandybrown",[244,164,96]],["seagreen",[46,139,87]],["seashell",[255,245,238]],["sienna",[160,82,45]],["skyblue",[135,206,235]],["slateblue",[106,90,205]],["slategray",[112,128,144]],["slategrey",[112,128,144]],["snow",[255,250,250]],["springgreen",[0,255,127]],["steelblue",[70,130,180]],["tan",[210,180,140]],["thistle",[216,191,216]],["tomato",[255,99,71]],["turquoise",[64,224,208]],["violet",[238,130,238]],["wheat",[245,222,179]],["whitesmoke",[245,245,245]],["yellowgreen",[154,205,50]]].forEach((function(t){Jr.set(t[0],t[1])}));var Qr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;c(this,t),this.onResetEvent(e,n,i,r)}return d(t,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return void 0===this.glArray&&(this.glArray=new Float32Array([0,0,0,1])),this.setColor(t,e,n,i)}},{key:"r",get:function(){return~~(255*this.glArray[0])},set:function(t){this.glArray[0]=Or(~~t||0,0,255)/255}},{key:"g",get:function(){return~~(255*this.glArray[1])},set:function(t){this.glArray[1]=Or(~~t||0,0,255)/255}},{key:"b",get:function(){return~~(255*this.glArray[2])},set:function(t){this.glArray[2]=Or(~~t||0,0,255)/255}},{key:"alpha",get:function(){return this.glArray[3]},set:function(t){this.glArray[3]=void 0===t?1:Or(+t,0,1)}},{key:"setColor",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return this.r=t,this.g=e,this.b=n,this.alpha=i,this}},{key:"clone",value:function(){return Gr.pull("Color").copy(this)}},{key:"copy",value:function(e){return e instanceof t?(this.glArray.set(e.glArray),this):this.parseCSS(e)}},{key:"add",value:function(t){return this.glArray[0]=Or(this.glArray[0]+t.glArray[0],0,1),this.glArray[1]=Or(this.glArray[1]+t.glArray[1],0,1),this.glArray[2]=Or(this.glArray[2]+t.glArray[2],0,1),this.glArray[3]=(this.glArray[3]+t.glArray[3])/2,this}},{key:"darken",value:function(t){return t=Or(t,0,1),this.glArray[0]*=t,this.glArray[1]*=t,this.glArray[2]*=t,this}},{key:"lerp",value:function(t,e){return e=Or(e,0,1),this.glArray[0]+=(t.glArray[0]-this.glArray[0])*e,this.glArray[1]+=(t.glArray[1]-this.glArray[1])*e,this.glArray[2]+=(t.glArray[2]-this.glArray[2])*e,this}},{key:"lighten",value:function(t){return t=Or(t,0,1),this.glArray[0]=Or(this.glArray[0]+(1-this.glArray[0])*t,0,1),this.glArray[1]=Or(this.glArray[1]+(1-this.glArray[1])*t,0,1),this.glArray[2]=Or(this.glArray[2]+(1-this.glArray[2])*t,0,1),this}},{key:"random",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return t<0&&(t=0),e>255&&(e=255),this.setColor(Cr(t,e),Cr(t,e),Cr(t,e),this.alpha)}},{key:"equals",value:function(t){return this.glArray[0]===t.glArray[0]&&this.glArray[1]===t.glArray[1]&&this.glArray[2]===t.glArray[2]&&this.glArray[3]===t.glArray[3]}},{key:"parseCSS",value:function(t){return Jr.has(t)?this.setColor.apply(this,Jr.get(t)):this.parseRGB(t)}},{key:"parseRGB",value:function(t){var e=Wr.exec(t);return e?this.setColor(+e[1],+e[2],+e[3],+e[5]):this.parseHex(t)}},{key:"parseHex",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e=Zr.exec(t))return this.setColor(parseInt(e[!1===n?1:2],16),parseInt(e[!1===n?2:3],16),parseInt(e[!1===n?3:4],16),(Or(parseInt(e[!1===n?4:1],16),0,255)/255).toFixed(1));if(e=qr.exec(t))return this.setColor(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16));if(e=Kr.exec(t)){var i=e[!1===n?1:2],r=e[!1===n?2:3],o=e[!1===n?3:4],s=e[!1===n?4:1];return this.setColor(parseInt(i+i,16),parseInt(r+r,16),parseInt(o+o,16),(Or(parseInt(s+s,16),0,255)/255).toFixed(1))}if(e=Xr.exec(t))return this.setColor(parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16));throw new Error("invalid parameter: "+t)}},{key:"toUint32",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.alpha,e=255&this.r,n=255&this.g,i=255&this.b,r=255*t&255;return(r<<24)+(e<<16)+(n<<8)+i}},{key:"toArray",value:function(){return this.glArray}},{key:"toHex",value:function(){return"#"+Yr(this.r)+Yr(this.g)+Yr(this.b)}},{key:"toHex8",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.alpha;return"#"+Yr(this.r)+Yr(this.g)+Yr(this.b)+Yr(255*t)}},{key:"toRGB",value:function(){return"rgb("+this.r+","+this.g+","+this.b+")"}},{key:"toRGBA",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.alpha;return"rgba("+this.r+","+this.g+","+this.b+","+t+")"}}]),t}(),$r=function(){function t(){c(this,t),this.onResetEvent.apply(this,arguments)}return d(t,[{key:"onResetEvent",value:function(){void 0===this.val&&(this.val=new Float32Array(16)),arguments.length&&arguments[0]instanceof t?this.copy(arguments[0]):16===arguments.length?this.setTransform.apply(this,arguments):this.identity()}},{key:"tx",get:function(){return this.val[12]}},{key:"ty",get:function(){return this.val[13]}},{key:"tz",get:function(){return this.val[14]}},{key:"identity",value:function(){return this.setTransform(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}},{key:"setTransform",value:function(t,e,n,i,r,o,s,a,u,l,h,c,f,d,p,v){var y=this.val;return y[0]=t,y[1]=e,y[2]=n,y[3]=i,y[4]=r,y[5]=o,y[6]=s,y[7]=a,y[8]=u,y[9]=l,y[10]=h,y[11]=c,y[12]=f,y[13]=d,y[14]=p,y[15]=v,this}},{key:"copy",value:function(t){return this.val.set(t.val),this}},{key:"fromMat2d",value:function(t){var e=t.val;return this.setTransform(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1)}},{key:"multiply",value:function(t){var e=this.val,n=t.val,i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],h=e[7],c=e[8],f=e[9],d=e[10],p=e[11],v=e[12],y=e[13],g=e[14],m=e[15],b=n[0],x=n[1],w=n[2],_=n[3];return e[0]=b*i+x*a+w*c+_*v,e[1]=b*r+x*u+w*f+_*y,e[2]=b*o+x*l+w*d+_*g,e[3]=b*s+x*h+w*p+_*m,b=n[4],x=n[5],w=n[6],_=n[7],e[4]=b*i+x*a+w*c+_*v,e[5]=b*r+x*u+w*f+_*y,e[6]=b*o+x*l+w*d+_*g,e[7]=b*s+x*h+w*p+_*m,b=n[8],x=n[9],w=n[10],_=n[11],e[8]=b*i+x*a+w*c+_*v,e[9]=b*r+x*u+w*f+_*y,e[10]=b*o+x*l+w*d+_*g,e[11]=b*s+x*h+w*p+_*m,b=n[12],x=n[13],w=n[14],_=n[15],e[12]=b*i+x*a+w*c+_*v,e[13]=b*r+x*u+w*f+_*y,e[14]=b*o+x*l+w*d+_*g,e[15]=b*s+x*h+w*p+_*m,this}},{key:"transpose",value:function(){var t=this.val,e=t[1],n=t[2],i=t[3],r=t[6],o=t[7],s=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=e,t[6]=t[9],t[7]=t[13],t[8]=n,t[9]=r,t[11]=t[14],t[12]=i,t[13]=o,t[14]=s,this}},{key:"invert",value:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],l=t[8],h=t[9],c=t[10],f=t[11],d=t[12],p=t[13],v=t[14],y=t[15],g=e*s-n*o,m=e*a-i*o,b=e*u-r*o,x=n*a-i*s,w=n*u-r*s,_=i*u-r*a,k=l*p-h*d,T=l*v-c*d,E=l*y-f*d,S=h*v-c*p,A=h*y-f*p,P=c*y-f*v,O=g*P-m*A+b*S+x*E-w*T+_*k;return O?(O=1/O,t[0]=(s*P-a*A+u*S)*O,t[1]=(i*A-n*P-r*S)*O,t[2]=(p*_-v*w+y*x)*O,t[3]=(c*w-h*_-f*x)*O,t[4]=(a*E-o*P-u*T)*O,t[5]=(e*P-i*E+r*T)*O,t[6]=(v*b-d*_-y*m)*O,t[7]=(l*_-c*b+f*m)*O,t[8]=(o*A-s*E+u*k)*O,t[9]=(n*E-e*A-r*k)*O,t[10]=(d*w-p*b+y*g)*O,t[11]=(h*b-l*w-f*g)*O,t[12]=(s*T-o*S-a*k)*O,t[13]=(e*S-n*T+i*k)*O,t[14]=(p*m-d*x-v*g)*O,t[15]=(l*x-h*m+c*g)*O,this):null}},{key:"apply",value:function(t){var e=this.val,n=t.x,i=t.y,r=void 0!==t.z?t.z:1,o=e[3]*n+e[7]*i+e[11]*r+e[15]||1;return t.x=(e[0]*n+e[4]*i+e[8]*r+e[12])/o,t.y=(e[1]*n+e[5]*i+e[9]*r+e[13])/o,void 0!==t.z&&(t.z=(e[2]*n+e[6]*i+e[10]*r+e[14])/o),t}},{key:"applyInverse",value:function(t){var e=Gr.pull("Matrix3d",this).invert();return e.apply(t),Gr.push(e),t}},{key:"ortho",value:function(t,e,n,i,r,o){var s=this.val,a=1/(t-e),u=1/(n-i),l=1/(r-o);return s[0]=-2*a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*u,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*l,s[11]=0,s[12]=(t+e)*a,s[13]=(i+n)*u,s[14]=(o+r)*l,s[15]=1,this}},{key:"scale",value:function(t,e,n){var i=this.val,r=t,o=void 0===e?r:e,s=void 0===n?0:n;return i[0]=i[0]*r,i[1]=i[1]*r,i[2]=i[2]*r,i[3]=i[3]*r,i[4]=i[4]*o,i[5]=i[5]*o,i[6]=i[6]*o,i[7]=i[7]*o,i[8]=i[8]*s,i[9]=i[9]*s,i[10]=i[10]*s,i[11]=i[11]*s,this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y,t.z)}},{key:"scaleX",value:function(t){return this.scale(t,1)}},{key:"scaleY",value:function(t){return this.scale(1,t)}},{key:"rotate",value:function(t,e){if(0!==t){var n,i,r,o,s,a,u,l,h,c,f,d,p,v,y,g,m,b,x,w,_,k,T,E,S=this.val,A=e.x,P=e.y,O=e.z,C=Math.sqrt(A*A+P*P+O*O);if(C<1e-6)return null;A*=C=1/C,P*=C,O*=C,n=Math.sin(t),r=1-(i=Math.cos(t)),o=S[0],s=S[1],a=S[2],u=S[3],l=S[4],h=S[5],c=S[6],f=S[7],d=S[8],p=S[9],v=S[10],y=S[11],g=A*A*r+i,m=P*A*r+O*n,b=O*A*r-P*n,x=A*P*r-O*n,w=P*P*r+i,_=O*P*r+A*n,k=A*O*r+P*n,T=P*O*r-A*n,E=O*O*r+i,S[0]=o*g+l*m+d*b,S[1]=s*g+h*m+p*b,S[2]=a*g+c*m+v*b,S[3]=u*g+f*m+y*b,S[4]=o*x+l*w+d*_,S[5]=s*x+h*w+p*_,S[6]=a*x+c*w+v*_,S[7]=u*x+f*w+y*_,S[8]=o*k+l*T+d*E,S[9]=s*k+h*T+p*E,S[10]=a*k+c*T+v*E,S[11]=u*k+f*T+y*E}return this}},{key:"translate",value:function(){var t,e,n,i=this.val;return arguments.length>1?(t=arguments[0],e=arguments[1],n=void 0===arguments[2]?0:arguments[2]):(t=arguments[0].x,e=arguments[0].y,n=void 0===arguments[0].z?0:arguments[0].z),i[12]=i[0]*t+i[4]*e+i[8]*n+i[12],i[13]=i[1]*t+i[5]*e+i[9]*n+i[13],i[14]=i[2]*t+i[6]*e+i[10]*n+i[14],i[15]=i[3]*t+i[7]*e+i[11]*n+i[15],this}},{key:"isIdentity",value:function(){var t=this.val;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}},{key:"equals",value:function(t){var e=t.val,n=this.val;return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]}},{key:"clone",value:function(){return Gr.pull("Matrix3d",this)}},{key:"toArray",value:function(){return this.val}},{key:"toString",value:function(){var t=this.val;return"me.Matrix3d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}}]),t}(),to=function(){function t(){c(this,t),this.onResetEvent.apply(this,arguments)}return d(t,[{key:"onResetEvent",value:function(){return void 0===this.val&&(this.val=new Float32Array(9)),arguments.length&&arguments[0]instanceof t?this.copy(arguments[0]):arguments.length&&arguments[0]instanceof $r?this.fromMat3d(arguments[0]):arguments.length>=6?this.setTransform.apply(this,arguments):this.identity(),this}},{key:"tx",get:function(){return this.val[6]}},{key:"ty",get:function(){return this.val[7]}},{key:"identity",value:function(){return this.setTransform(1,0,0,0,1,0,0,0,1),this}},{key:"setTransform",value:function(){var t=this.val;return 9===arguments.length?(t[0]=arguments[0],t[1]=arguments[1],t[2]=arguments[2],t[3]=arguments[3],t[4]=arguments[4],t[5]=arguments[5],t[6]=arguments[6],t[7]=arguments[7],t[8]=arguments[8]):6===arguments.length&&(t[0]=arguments[0],t[1]=arguments[2],t[2]=arguments[4],t[3]=arguments[1],t[4]=arguments[3],t[5]=arguments[5],t[6]=0,t[7]=0,t[8]=1),this}},{key:"copy",value:function(t){return this.val.set(t.val),this}},{key:"fromMat3d",value:function(t){var e=t.val,n=this.val;return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],this}},{key:"multiply",value:function(t){var e=t.val,n=this.val,i=n[0],r=n[1],o=n[3],s=n[4],a=e[0],u=e[1],l=e[3],h=e[4],c=e[6],f=e[7];return n[0]=i*a+o*u,n[1]=r*a+s*u,n[3]=i*l+o*h,n[4]=r*l+s*h,n[6]+=i*c+o*f,n[7]+=r*c+s*f,this}},{key:"transpose",value:function(){var t=this.val,e=t[1],n=t[2],i=t[5];return t[1]=t[3],t[2]=t[6],t[3]=e,t[5]=t[7],t[6]=n,t[7]=i,this}},{key:"invert",value:function(){var t=this.val,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],l=t[8],h=l*o-s*u,c=s*a-l*r,f=u*r-o*a,d=e*h+n*c+i*f;return t[0]=h/d,t[1]=(i*u-l*n)/d,t[2]=(s*n-i*o)/d,t[3]=c/d,t[4]=(l*e-i*a)/d,t[5]=(i*r-s*e)/d,t[6]=f/d,t[7]=(n*a-u*e)/d,t[8]=(o*e-n*r)/d,this}},{key:"apply",value:function(t){var e=this.val,n=t.x,i=t.y,r=void 0!==t.z?t.z:1;return t.x=n*e[0]+i*e[3]+r*e[6],t.y=n*e[1]+i*e[4]+r*e[7],void 0!==t.z&&(t.z=n*e[2]+i*e[5]+r*e[8]),t}},{key:"applyInverse",value:function(t){var e=this.val,n=t.x,i=t.y,r=1/(e[0]*e[4]+e[3]*-e[1]);return t.x=e[4]*r*n+-e[3]*r*i+(e[7]*e[3]-e[6]*e[4])*r,t.y=e[0]*r*i+-e[1]*r*n+(-e[7]*e[0]+e[6]*e[1])*r,t}},{key:"scale",value:function(t,e){var n=this.val,i=t,r=void 0===e?i:e;return n[0]*=i,n[1]*=i,n[3]*=r,n[4]*=r,this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y)}},{key:"scaleX",value:function(t){return this.scale(t,1)}},{key:"scaleY",value:function(t){return this.scale(1,t)}},{key:"rotate",value:function(t){if(0!==t){var e=this.val,n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=Math.sin(t),l=Math.cos(t);e[0]=l*n+u*o,e[1]=l*i+u*s,e[2]=l*r+u*a,e[3]=l*o-u*n,e[4]=l*s-u*i,e[5]=l*a-u*r}return this}},{key:"translate",value:function(){var t,e,n=this.val;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),n[6]+=n[0]*t+n[3]*e,n[7]+=n[1]*t+n[4]*e,this}},{key:"isIdentity",value:function(){var t=this.val;return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&1===t[8]}},{key:"equals",value:function(t){var e=t.val,n=this.val;return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]}},{key:"clone",value:function(){return Gr.pull("Matrix2d",this)}},{key:"toArray",value:function(){return this.val}},{key:"toString",value:function(){var t=this.val;return"me.Matrix2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}}]),t}(),eo={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,o||t,s),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,o=i.length,s=new Array(o);r<o;r++)s[r]=i[r].fn;return s},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,o,s){var a=n?n+t:t;if(!this._events[a])return!1;var u,l,h=this._events[a],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,i),!0;case 4:return h.fn.call(h.context,e,i,r),!0;case 5:return h.fn.call(h.context,e,i,r,o),!0;case 6:return h.fn.call(h.context,e,i,r,o,s),!0}for(l=1,u=new Array(c-1);l<c;l++)u[l-1]=arguments[l];h.fn.apply(h.context,u)}else{var f,d=h.length;for(l=0;l<d;l++)switch(h[l].once&&this.removeListener(t,h[l].fn,void 0,!0),c){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,e);break;case 3:h[l].fn.call(h[l].context,e,i);break;case 4:h[l].fn.call(h[l].context,e,i,r);break;default:if(!u)for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];h[l].fn.apply(h[l].context,u)}}return!0},a.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||s(this,o);else{for(var u=0,l=[],h=a.length;u<h;u++)(a[u].fn!==e||r&&!a[u].once||i&&a[u].context!==i)&&l.push(a[u]);l.length?this._events[o]=1===l.length?l[0]:l:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}(eo);var no=new(0,eo.exports),io="dom_ready",ro="me.boot",oo="me.state.onPause",so="me.state.onResume",ao="me.state.onStop",uo="me.state.onRestart",lo="me.state.onChange",ho="me.video.onInit",co="me.game.onInit",fo="me.game.onReset",po="me.game.beforeUpdate",vo="me.game.afterUpdate",yo="me.game.onUpdate",go="me.game.beforeDraw",mo="me.game.afterDraw",bo="me.game.onLevelLoaded",xo="me.loader.onload",wo="me.loader.onProgress",_o="me.input.keydown",ko="me.input.keyup",To="gamepad.connected",Eo="gamepad.disconnected",So="gamepad.update",Ao="me.event.pointermove",Po="me.event.pointerlockChange",Oo="globalThis.onresize",Co="canvas.onresize",Mo="viewport.onresize",Ro="globalThis.orientationchange",Io="globalThis.onscroll",Lo="viewport.onchange",jo="renderer.contextlost",Bo="renderer.contextrestored";function Do(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return no.emit.apply(no,[t].concat(n))}function Fo(t,e,n){return no.on(t,e,n)}function No(t,e,n){return no.once(t,e,n)}function zo(t,e){return no.off(t,e)}var Uo=Object.freeze({__proto__:null,DOM_READY:io,BOOT:ro,STATE_PAUSE:oo,STATE_RESUME:so,STATE_STOP:ao,STATE_RESTART:uo,STATE_CHANGE:lo,VIDEO_INIT:ho,GAME_INIT:co,GAME_RESET:fo,GAME_BEFORE_UPDATE:po,GAME_AFTER_UPDATE:vo,GAME_UPDATE:yo,GAME_BEFORE_DRAW:go,GAME_AFTER_DRAW:mo,LEVEL_LOADED:bo,LOADER_COMPLETE:xo,LOADER_PROGRESS:wo,KEYDOWN:_o,KEYUP:ko,GAMEPAD_CONNECTED:To,GAMEPAD_DISCONNECTED:Eo,GAMEPAD_UPDATE:So,POINTERMOVE:Ao,POINTERLOCKCHANGE:Po,DRAGSTART:"me.game.dragstart",DRAGEND:"me.game.dragend",WINDOW_ONRESIZE:Oo,CANVAS_ONRESIZE:Co,VIEWPORT_ONRESIZE:Mo,WINDOW_ONORIENTATION_CHANGE:Ro,WINDOW_ONSCROLL:Io,VIEWPORT_ONCHANGE:Lo,ONCONTEXT_LOST:jo,ONCONTEXT_RESTORED:Bo,emit:Do,on:Fo,once:No,off:zo}),Vo={},Go=!1;try{Go="undefined"!=typeof globalThis&&void 0!==globalThis.localStorage}catch(t){Go=!1}function Ho(t){return"add"===t||"remove"===t}Fo(ro,(function(){if(!0===Go){var t=globalThis.localStorage.getItem("me.save");"string"==typeof t&&t.length>0&&(JSON.parse(t)||[]).forEach((function(t){Vo[t]=JSON.parse(globalThis.localStorage.getItem("me.save."+t))}))}}));var Yo={add:function(t){var e=Yo;Object.keys(t).forEach((function(n){var i;Ho(n)||(i=n,Object.defineProperty(e,i,{configurable:!0,enumerable:!0,get:function(){return Vo[i]},set:function(t){Vo[i]=t,!0===Go&&globalThis.localStorage.setItem("me.save."+i,JSON.stringify(t))}}),n in Vo||(e[n]=t[n]))})),!0===Go&&globalThis.localStorage.setItem("me.save",JSON.stringify(Object.keys(Vo)))},remove:function(t){Ho(t)||void 0!==Vo[t]&&(delete Vo[t],!0===Go&&(globalThis.localStorage.removeItem("me.save."+t),globalThis.localStorage.setItem("me.save",JSON.stringify(Object.keys(Vo)))))}},Wo=!1,Xo=!1;function Ko(){if(!Xo){if(void 0!==globalThis.document&&!globalThis.document.body)return setTimeout(Ko,13);void 0!==globalThis.document&&"function"==typeof globalThis.document.removeEventListener&&globalThis.document.removeEventListener("DOMContentLoaded",Ko,!1),"function"==typeof globalThis.removeEventListener&&globalThis.removeEventListener("load",Ko,!1),Do(io),Xo=!0}}var qo=void 0!==globalThis.navigator?globalThis.navigator.userAgent:"",Zo=/iPhone|iPad|iPod/i.test(qo),Jo=/Android/i.test(qo),Qo=/Android 2/i.test(qo),$o=/Linux/i.test(qo),ts=/CrOS/.test(qo),es=/Windows Phone/i.test(qo),ns=/BlackBerry/i.test(qo),is=/Kindle|Silk.*Mobile Safari/i.test(qo),rs=void 0!==globalThis.ejecta,os=/MicroMessenger/i.test(qo),ss=void 0!==globalThis.process&&void 0!==globalThis.process.release&&"node"===globalThis.process.release.name,as=/Mobi/i.test(qo)||Zo||Jo||es||ns||is||!1,us=!1,ls=!1,hs=!0,cs={left:0,top:0,x:0,y:0,width:0,height:0,right:0,bottom:0};function fs(t){return t.preventDefault(),"function"==typeof globalThis.scroll&&globalThis.scroll(0,0),!1}function ds(t){js=t.accelerationIncludingGravity.x,Bs=t.accelerationIncludingGravity.y,Ds=t.accelerationIncludingGravity.z}function ps(t){Fs=t.gamma,Ns=t.beta,zs=t.alpha}var vs=Object.freeze({__proto__:null,ua:qo,iOS:Zo,android:Jo,android2:Qo,linux:$o,chromeOS:ts,wp:es,BlackBerry:ns,Kindle:is,ejecta:rs,isWeixin:os,nodeJS:ss,isMobile:as}),ys=!!("ontouchstart"in globalThis),gs=!!globalThis.PointerEvent,ms=ys||gs,bs=ms?gs?globalThis.navigator.maxTouchPoints||1:10:1,xs=void 0!==globalThis.document&&"onwheel"in globalThis.document.createElement("div"),ws=void 0!==globalThis.document&&void 0!==globalThis.document.pointerLockElement,_s=!!globalThis.DeviceOrientationEvent,ks="undefined"!=typeof screen&&void 0!==screen.orientation,Ts=!!globalThis.DeviceMotionEvent,Es=void 0!==globalThis.document&&(xr("fullscreenEnabled",globalThis.document)||globalThis.document.mozFullScreenEnabled);!0===Es&&(globalThis.document.exitFullscreen=xr("cancelFullScreen",globalThis.document)||xr("exitFullscreen",globalThis.document));var Ss=!(!globalThis.AudioContext&&!globalThis.webkitAudioContext),As=void 0!==globalThis.Audio,Ps=Ss||As,Os=function(){try{return!!globalThis.localStorage}catch(t){return!1}}(),Cs=function(){try{return void 0!==globalThis.OffscreenCanvas&&null!==new globalThis.OffscreenCanvas(0,0).getContext("2d")}catch(t){return!1}}(),Ms="function"==typeof globalThis.atob,Rs=void 0!==globalThis.navigator&&(globalThis.navigator.language||globalThis.navigator.browserLanguage||globalThis.navigator.userLanguage)||"en",Is=globalThis.devicePixelRatio||1,Ls=vs.isMobile,js=0,Bs=0,Ds=0,Fs=0,Ns=0,zs=0;function Us(t){!function(t){Xo?t.call(globalThis,[]):(No(io,t,globalThis),Wo||("undefined"!=typeof process&&"node"===process.release.name||void 0!==globalThis.document&&"complete"===globalThis.document.readyState?globalThis.setTimeout(Ko,0):(void 0!==globalThis.document&&"function"==typeof globalThis.document.addEventListener&&globalThis.document.addEventListener("DOMContentLoaded",Ko,!1),globalThis.addEventListener("load",Ko,!1)),Wo=!0))}(t)}function Vs(t){var e=gs?"pointermove":ys?"touchmove":"mousemove";!1!==t?!1===hs&&(globalThis.document.removeEventListener(e,fs),hs=!0):!0===hs&&(globalThis.document.addEventListener(e,fs,{passive:!1}),hs=!1)}function Gs(){return!(!Es||!xr("fullscreenElement",document)&&!document.mozFullScreenElement)}function Hs(){var t="portrait",e="landscape",n=globalThis.screen;if(!0===ks){var i=xr("orientation",n);if(void 0!==i&&"string"==typeof i.type)return i.type;if("string"==typeof i)return i}return"number"==typeof globalThis.orientation?90===Math.abs(globalThis.orientation)?e:t:globalThis.outerWidth>globalThis.outerHeight?e:t}function Ys(t){var e=Ws(t);return null!==e.parentNode&&(e=e.parentNode),e}function Ws(t){var e=null;return"undefined"!==t&&("string"==typeof t?e=document.getElementById(t):"object"===p(t)&&t.nodeType===Node.ELEMENT_NODE&&(e=t)),e||(e=document.body),e}function Xs(t){return"object"===p(t)&&t!==document.body&&void 0!==t.getBoundingClientRect?t.getBoundingClientRect():(cs.width=cs.right=globalThis.innerWidth,cs.height=cs.bottom=globalThis.innerHeight,cs)}function Ks(t){return Xs(Ys(t))}function qs(t){var e=!1;try{var n=document.createElement("canvas"),i={stencil:!0,failIfMajorPerformanceCaveat:t.failIfMajorPerformanceCaveat};e=!(!globalThis.WebGLRenderingContext||!n.getContext("webgl",i)&&!n.getContext("experimental-webgl",i))}catch(t){e=!1}return e}function Zs(t){return t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0?"highp":t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}function Js(){"function"==typeof globalThis.focus&&globalThis.focus()}var Qs=Object.freeze({__proto__:null,onDeviceRotate:ps,platform:vs,touchEvent:ys,pointerEvent:gs,touch:ms,maxTouchPoints:bs,wheel:xs,hasPointerLockSupport:ws,hasDeviceOrientation:_s,screenOrientation:ks,hasAccelerometer:Ts,hasFullscreenSupport:Es,hasWebAudio:Ss,hasHTML5Audio:As,sound:Ps,localStorage:Os,offscreenCanvas:Cs,nativeBase64:Ms,language:Rs,devicePixelRatio:Is,isMobile:Ls,get accelerationX(){return js},get accelerationY(){return Bs},get accelerationZ(){return Ds},get gamma(){return Fs},get beta(){return Ns},get alpha(){return zs},pauseOnBlur:!0,resumeOnFocus:!0,autoFocus:!0,stopOnBlur:!1,onReady:Us,enableSwipe:Vs,isFullscreen:Gs,requestFullscreen:function(t){Es&&!Gs()&&((t=t||Cc()).requestFullscreen=xr("requestFullscreen",t)||t.mozRequestFullScreen,t.requestFullscreen())},exitFullscreen:function(){Es&&Gs()&&document.exitFullscreen()},getScreenOrientation:Hs,lockOrientation:function(t){var e=globalThis.screen;if(void 0!==e){var n=xr("lockOrientation",e);if(void 0!==n)return n(t)}return!1},unlockOrientation:function(){var t=globalThis.screen;if(void 0!==t){var e=xr("unlockOrientation",t);if(void 0!==e)return e()}return!1},isPortrait:function(){return Hs().includes("portrait")},isLandscape:function(){return Hs().includes("landscape")},getStorage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"local";if("local"===t)return Yo;throw new Error("storage type "+t+" not supported")},getParentElement:Ys,getElement:Ws,getElementBounds:Xs,getParentBounds:Ks,isWebGLSupported:qs,getMaxShaderPrecision:Zs,focus:Js,watchAccelerometer:function(){return Ts&&!us&&(DeviceOrientationEvent&&"function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(t){"granted"===t&&(globalThis.addEventListener("devicemotion",ds,!1),us=!0)})).catch(console.error):(globalThis.addEventListener("devicemotion",ds,!1),us=!0)),us},unwatchAccelerometer:function(){us&&(globalThis.removeEventListener("devicemotion",ds,!1),us=!1)},watchDeviceOrientation:function(){return _s&&!ls&&("function"==typeof DeviceOrientationEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(t){"granted"===t&&(globalThis.addEventListener("deviceorientation",ps,!1),ls=!0)})).catch(console.error):(globalThis.addEventListener("deviceorientation",ps,!1),ls=!0)),ls},unwatchDeviceOrientation:function(){ls&&(globalThis.removeEventListener("deviceorientation",ps,!1),ls=!1)},vibrate:function(t){void 0!==globalThis.navigator&&"function"==typeof globalThis.navigator.vibrate&&globalThis.navigator.vibrate(t)}}),$s={bool:"1i",int:"1i",float:"1f",vec2:"2fv",vec3:"3fv",vec4:"4fv",bvec2:"2iv",bvec3:"3iv",bvec4:"4iv",ivec2:"2iv",ivec3:"3iv",ivec4:"4iv",mat2:"Matrix2fv",mat3:"Matrix3fv",mat4:"Matrix4fv",sampler2D:"1i"};function ta(t,e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(i));return i}function ea(t,e){return"precision"!==t.substring(0,9)?"precision "+e+" float;"+t:t}function na(t){return(t=(t=(t=t.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1")).replace(/(\\n\s+)|(\s+\\n)/g,"")).replace(/(\\r|\\n)+/g,"")).replace(/\s*([;,[\](){}\\\/\-+*|^&!=<>?~%])\s*/g,"$1")}var ia=function(){function t(e,n,i,r){c(this,t),this.gl=e,this.vertex=ea(na(n),r||Zs(this.gl)),this.fragment=ea(na(i),r||Zs(this.gl)),this.attributes=function(t,e){for(var n,i={},r=/attribute\s+\w+\s+(\w+)/g,o=0;n=r.exec(e.vertex);)i[n[1]]=o++;return i}(this.gl,this),this.program=function(t,e,n,i){var r=ta(t,t.VERTEX_SHADER,e),o=ta(t,t.FRAGMENT_SHADER,n),s=t.createProgram();for(var a in t.attachShader(s,r),t.attachShader(s,o),i)t.bindAttribLocation(s,i[a],a);if(t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS)){var u="Error initializing Shader "+this+"\ngl.VALIDATE_STATUS: "+t.getProgramParameter(s,t.VALIDATE_STATUS)+"\ngl.getError()"+t.getError()+"\ngl.getProgramInfoLog()"+t.getProgramInfoLog(s);throw t.deleteProgram(s),s=null,new Error(u)}return t.useProgram(s),t.deleteShader(r),t.deleteShader(o),s}(this.gl,this.vertex,this.fragment,this.attributes),this.uniforms=function(t,e){var n,i={},r=/uniform\s+(\w+)\s+(\w+)/g,o={},s={},a={};return[e.vertex,e.fragment].forEach((function(t){for(;n=r.exec(t);)o[n[2]]=n[1]})),Object.keys(o).forEach((function(n){var i=o[n];a[n]=t.getUniformLocation(e.program,n),s[n]={get:function(t){return function(){return a[t]}}(n),set:function(e,n,i){return 0===n.indexOf("mat")?function(n){t[i](a[e],!1,n)}:function(n){var r=i;n.length&&"v"!==i.slice(-1)&&(r+="v"),t[r](a[e],n)}}(n,i,"uniform"+$s[i])}})),Object.defineProperties(i,s),i}(this.gl,this),Fo(jo,this.destroy,this)}return d(t,[{key:"bind",value:function(){this.gl.useProgram(this.program)}},{key:"getAttribLocation",value:function(t){var e=this.attributes[t];return void 0!==e?e:-1}},{key:"setUniform",value:function(t,e){var n=this.uniforms;if(void 0===n[t])throw new Error("undefined ("+t+") uniform for shader "+this);"object"===p(e)&&"function"==typeof e.toArray?n[t]=e.toArray():n[t]=e}},{key:"setVertexAttributes",value:function(t,e,n){for(var i=0;i<e.length;++i){var r=e[i],o=this.getAttribLocation(r.name);-1!==o?(t.enableVertexAttribArray(o),t.vertexAttribPointer(o,r.size,r.type,r.normalized,n,r.offset)):t.disableVertexAttribArray(i)}}},{key:"destroy",value:function(){this.uniforms=null,this.attributes=null,this.gl.deleteProgram(this.program),this.vertex=null,this.fragment=null}}]),t}(),ra=function(){function t(e,n){c(this,t),this.vertexSize=e,this.quadSize=n,this.maxVertex=256,this.vertexCount=0,this.buffer=new ArrayBuffer(this.maxVertex*this.vertexSize*this.quadSize),this.bufferF32=new Float32Array(this.buffer),this.bufferU32=new Uint32Array(this.buffer)}return d(t,[{key:"clear",value:function(){this.vertexCount=0}},{key:"isFull",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.quadSize;return this.vertexCount+t>=this.maxVertex}},{key:"resize",value:function(){this.maxVertex<<=1;var t=this.bufferF32;return this.buffer=new ArrayBuffer(this.maxVertex*this.vertexSize*this.quadSize),this.bufferF32=new Float32Array(this.buffer),this.bufferU32=new Uint32Array(this.buffer),this.bufferF32.set(t),this}},{key:"push",value:function(t,e,n,i,r){var o=this.vertexCount*this.vertexSize;return this.vertexCount>=this.maxVertex&&this.resize(),this.bufferF32[o+0]=t,this.bufferF32[o+1]=e,void 0!==n&&(this.bufferF32[o+2]=n,this.bufferF32[o+3]=i),void 0!==r&&(this.bufferU32[o+4]=r),this.vertexCount++,this}},{key:"toFloat32",value:function(t,e){return void 0!==e?this.bufferF32.subarray(t,e):this.bufferF32}},{key:"toUint32",value:function(t,e){return void 0!==e?this.bufferU32.subarray(t,e):this.bufferU32}},{key:"length",value:function(){return this.vertexCount}},{key:"isEmpty",value:function(){return 0===this.vertexCount}}]),t}(),oa=[new Hr,new Hr,new Hr,new Hr],sa=function(){function t(e){c(this,t),this.init(e)}return d(t,[{key:"init",value:function(t){var e=this,n=t.gl;this.currentTextureUnit=-1,this.boundTextures=[],this.renderer=t,this.gl=t.gl,this.color=t.currentColor,this.viewMatrix=t.currentTransform,this.activeShader=null,this.mode=n.TRIANGLES,this.attributes=[],this.vertexByteSize=0,this.vertexSize=0,this.primitiveShader=new ia(this.gl,"// Current vertex point\nattribute vec2 aVertex;\n\n// Projection matrix\nuniform mat4 uProjectionMatrix;\n\n// Vertex color\nuniform vec4 uColor;\n\n// Fragment color\nvarying vec4 vColor;\n\nvoid main(void) {\n    // Transform the vertex position by the projection matrix\n    gl_Position = uProjectionMatrix * vec4(aVertex, 0.0, 1.0);\n    // Pass the remaining attributes to the fragment shader\n    vColor = vec4(uColor.rgb * uColor.a, uColor.a);\n}\n","varying vec4 vColor;\n\nvoid main(void) {\n    gl_FragColor = vColor;\n}\n"),this.quadShader=new ia(this.gl,"attribute vec2 aVertex;\nattribute vec2 aRegion;\nattribute vec4 aColor;\n\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vRegion;\nvarying vec4 vColor;\n\nvoid main(void) {\n    // Transform the vertex position by the projection matrix\n     gl_Position = uProjectionMatrix * vec4(aVertex, 0.0, 1.0);\n    // Pass the remaining attributes to the fragment shader\n    vColor = vec4(aColor.bgr * aColor.a, aColor.a);\n    vRegion = aRegion;\n}\n","uniform sampler2D uSampler;\nvarying vec4 vColor;\nvarying vec2 vRegion;\n\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vRegion) * vColor;\n}\n"),this.addAttribute("aVertex",2,n.FLOAT,!1,0*Float32Array.BYTES_PER_ELEMENT),this.addAttribute("aRegion",2,n.FLOAT,!1,2*Float32Array.BYTES_PER_ELEMENT),this.addAttribute("aColor",4,n.UNSIGNED_BYTE,!0,4*Float32Array.BYTES_PER_ELEMENT),this.vertexBuffer=new ra(this.vertexSize,6),n.bindBuffer(n.ARRAY_BUFFER,n.createBuffer()),n.bufferData(n.ARRAY_BUFFER,this.vertexBuffer.buffer,n.STREAM_DRAW),Fo(Co,(function(t,n){e.flush(),e.setViewport(0,0,t,n)}))}},{key:"reset",value:function(){this.gl=this.renderer.gl,this.flush(),this.setViewport(0,0,this.renderer.getScreenCanvas().width,this.renderer.getScreenCanvas().height),this.clearColor(0,0,0,0);for(var t=0;t<this.renderer.maxTextures;t++){var e=this.getTexture2D(t);void 0!==e&&this.deleteTexture2D(e)}this.currentTextureUnit=-1,this.useShader(this.quadShader)}},{key:"addAttribute",value:function(t,e,n,i,r){switch(this.attributes.push({name:t,size:e,type:n,normalized:i,offset:r}),n){case this.gl.BYTE:this.vertexByteSize+=e*Int8Array.BYTES_PER_ELEMENT;break;case this.gl.UNSIGNED_BYTE:this.vertexByteSize+=e*Uint8Array.BYTES_PER_ELEMENT;break;case this.gl.SHORT:this.vertexByteSize+=e*Int16Array.BYTES_PER_ELEMENT;break;case this.gl.UNSIGNED_SHORT:this.vertexByteSize+=e*Uint16Array.BYTES_PER_ELEMENT;break;case this.gl.INT:this.vertexByteSize+=e*Int32Array.BYTES_PER_ELEMENT;break;case this.gl.UNSIGNED_INT:this.vertexByteSize+=e*Uint32Array.BYTES_PER_ELEMENT;break;case this.gl.FLOAT:this.vertexByteSize+=e*Float32Array.BYTES_PER_ELEMENT;break;default:throw new Error("Invalid GL Attribute type")}this.vertexSize=this.vertexByteSize/Float32Array.BYTES_PER_ELEMENT}},{key:"setViewport",value:function(t,e,n,i){this.gl.viewport(t,e,n,i)}},{key:"createTexture2D",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"no-repeat",r=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,a=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],u=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],l=this.gl,h=Sr(r||e.width)&&Sr(o||e.height),c=l.createTexture(),f=0===i.search(/^repeat(-x)?$/)&&(h||this.renderer.WebGLVersion>1)?l.REPEAT:l.CLAMP_TO_EDGE,d=0===i.search(/^repeat(-y)?$/)&&(h||this.renderer.WebGLVersion>1)?l.REPEAT:l.CLAMP_TO_EDGE;return this.bindTexture2D(c,t),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,f),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,d),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,n),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,n),l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),r||o||s?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,r,o,s,l.RGBA,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,e),h&&!1!==u&&l.generateMipmap(l.TEXTURE_2D),c}},{key:"deleteTexture2D",value:function(t){this.gl.deleteTexture(t),this.unbindTexture2D(t)}},{key:"getTexture2D",value:function(t){return this.boundTextures[t]}},{key:"bindTexture2D",value:function(t,e){var n=this.gl;t!==this.boundTextures[e]?(this.flush(),this.currentTextureUnit!==e&&(this.currentTextureUnit=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,t),this.boundTextures[e]=t):this.currentTextureUnit!==e&&(this.flush(),this.currentTextureUnit=e,n.activeTexture(n.TEXTURE0+e))}},{key:"unbindTexture2D",value:function(t,e){return void 0===e&&(e=this.boundTextures.indexOf(t)),-1!==e&&(delete this.boundTextures[e],e===this.currentTextureUnit&&(this.currentTextureUnit=-1)),e}},{key:"uploadTexture",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.renderer.cache.getUnit(t),s=this.boundTextures[o];return void 0===s||r?this.createTexture2D(o,t.getTexture(),this.renderer.settings.antiAlias?this.gl.LINEAR:this.gl.NEAREST,t.repeat,e,n,i,t.premultipliedAlpha):this.bindTexture2D(s,o),this.currentTextureUnit}},{key:"setProjection",value:function(t){this.activeShader.setUniform("uProjectionMatrix",t)}},{key:"useShader",value:function(t){this.activeShader!==t&&(this.flush(),this.activeShader=t,this.activeShader.bind(),this.activeShader.setUniform("uProjectionMatrix",this.renderer.projectionMatrix),this.activeShader.setVertexAttributes(this.gl,this.attributes,this.vertexByteSize))}},{key:"addQuad",value:function(t,e,n,i,r,o,s,a,u,l){if(!(this.color.alpha<1/255)){this.useShader(this.quadShader),this.vertexBuffer.isFull(6)&&this.flush();var h=this.uploadTexture(t);this.quadShader.setUniform("uSampler",h);var c=this.viewMatrix,f=oa[0].set(e,n),d=oa[1].set(e+i,n),p=oa[2].set(e,n+r),v=oa[3].set(e+i,n+r);c.isIdentity()||(c.apply(f),c.apply(d),c.apply(p),c.apply(v)),this.vertexBuffer.push(f.x,f.y,o,s,l),this.vertexBuffer.push(d.x,d.y,a,s,l),this.vertexBuffer.push(p.x,p.y,o,u,l),this.vertexBuffer.push(p.x,p.y,o,u,l),this.vertexBuffer.push(d.x,d.y,a,s,l),this.vertexBuffer.push(v.x,v.y,a,u,l)}}},{key:"flush",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.mode,e=this.vertexBuffer,n=e.vertexCount;if(n>0){var i=this.gl,r=e.vertexSize;this.renderer.WebGLVersion>1?i.bufferData(i.ARRAY_BUFFER,e.toFloat32(),i.STREAM_DRAW,0,n*r):i.bufferData(i.ARRAY_BUFFER,e.toFloat32(0,n*r),i.STREAM_DRAW),i.drawArrays(t,0,n),e.clear()}}},{key:"drawVertices",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;this.useShader(this.primitiveShader),this.primitiveShader.setUniform("uColor",this.color);for(var i=this.viewMatrix,r=this.vertexBuffer,o=i.isIdentity(),s=0;s<n;s++)o||i.apply(e[s]),r.push(e[s].x,e[s].y);this.flush(t)}},{key:"clearColor",value:function(t,e,n,i){this.gl.clearColor(t,e,n,i)}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)}}]),t}(),aa={exports:{}};function ua(t,e,n){n=n||2;var i,r,o,s,a,u,l,h=e&&e.length,c=h?e[0]*n:t.length,f=la(t,0,c,n,!0),d=[];if(!f||f.next===f.prev)return d;if(h&&(f=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=la(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(xa(s));for(a.sort(ya),r=0;r<a.length;r++)n=ga(a[r],n);return n}(t,e,f,n)),t.length>80*n){i=o=t[0],r=s=t[1];for(var p=n;p<c;p+=n)(a=t[p])<i&&(i=a),(u=t[p+1])<r&&(r=u),a>o&&(o=a),u>s&&(s=u);l=0!==(l=Math.max(o-i,s-r))?32767/l:0}return ca(f,d,n,i,r,l,0),d}function la(t,e,n,i,r){var o,s;if(r===Ia(t,e,n,i)>0)for(o=e;o<n;o+=i)s=Ca(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=Ca(o,t[o],t[o+1],s);return s&&Ta(s,s.next)&&(Ma(s),s=s.next),s}function ha(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Ta(i,i.next)&&0!==ka(i.prev,i,i.next))i=i.next;else{if(Ma(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function ca(t,e,n,i,r,o,s){if(t){!s&&o&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=ba(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,u,l=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<l&&(a++,i=i.nextZ);e++);for(u=l;a>0||u>0&&i;)0!==a&&(0===u||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(s>1)}(r)}(t,i,r,o);for(var a,u,l=t;t.prev!==t.next;)if(a=t.prev,u=t.next,o?da(t,i,r,o):fa(t))e.push(a.i/n|0),e.push(t.i/n|0),e.push(u.i/n|0),Ma(t),t=u.next,l=u.next;else if((t=u)===l){s?1===s?ca(t=pa(ha(t),e,n),e,n,i,r,o,2):2===s&&va(t,e,n,i,r,o):ca(ha(t),e,n,i,r,o,1);break}}}function fa(t){var e=t.prev,n=t,i=t.next;if(ka(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,s=i.x,a=e.y,u=n.y,l=i.y,h=r<o?r<s?r:s:o<s?o:s,c=a<u?a<l?a:l:u<l?u:l,f=r>o?r>s?r:s:o>s?o:s,d=a>u?a>l?a:l:u>l?u:l,p=i.next;p!==e;){if(p.x>=h&&p.x<=f&&p.y>=c&&p.y<=d&&wa(r,a,o,u,s,l,p.x,p.y)&&ka(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function da(t,e,n,i){var r=t.prev,o=t,s=t.next;if(ka(r,o,s)>=0)return!1;for(var a=r.x,u=o.x,l=s.x,h=r.y,c=o.y,f=s.y,d=a<u?a<l?a:l:u<l?u:l,p=h<c?h<f?h:f:c<f?c:f,v=a>u?a>l?a:l:u>l?u:l,y=h>c?h>f?h:f:c>f?c:f,g=ba(d,p,e,n,i),m=ba(v,y,e,n,i),b=t.prevZ,x=t.nextZ;b&&b.z>=g&&x&&x.z<=m;){if(b.x>=d&&b.x<=v&&b.y>=p&&b.y<=y&&b!==r&&b!==s&&wa(a,h,u,c,l,f,b.x,b.y)&&ka(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,x.x>=d&&x.x<=v&&x.y>=p&&x.y<=y&&x!==r&&x!==s&&wa(a,h,u,c,l,f,x.x,x.y)&&ka(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;b&&b.z>=g;){if(b.x>=d&&b.x<=v&&b.y>=p&&b.y<=y&&b!==r&&b!==s&&wa(a,h,u,c,l,f,b.x,b.y)&&ka(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;x&&x.z<=m;){if(x.x>=d&&x.x<=v&&x.y>=p&&x.y<=y&&x!==r&&x!==s&&wa(a,h,u,c,l,f,x.x,x.y)&&ka(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function pa(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Ta(r,o)&&Ea(r,i,i.next,o)&&Pa(r,o)&&Pa(o,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),Ma(i),Ma(i.next),i=t=o),i=i.next}while(i!==t);return ha(i)}function va(t,e,n,i,r,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&_a(s,a)){var u=Oa(s,a);return s=ha(s,s.next),u=ha(u,u.next),ca(s,e,n,i,r,o,0),void ca(u,e,n,i,r,o,0)}a=a.next}s=s.next}while(s!==t)}function ya(t,e){return t.x-e.x}function ga(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var u,l=n,h=n.x,c=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=h&&r!==i.x&&wa(o<c?r:s,o,h,c,o<c?s:r,o,i.x,i.y)&&(u=Math.abs(o-i.y)/(r-i.x),Pa(i,t)&&(u<f||u===f&&(i.x>n.x||i.x===n.x&&ma(n,i)))&&(n=i,f=u)),i=i.next}while(i!==l);return n}(t,e);if(!n)return e;var i=Oa(n,t);return ha(i,i.next),ha(n,n.next)}function ma(t,e){return ka(t.prev,t,e.prev)<0&&ka(e.next,t,t.next)<0}function ba(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function xa(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function wa(t,e,n,i,r,o,s,a){return(r-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function _a(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ea(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Pa(t,e)&&Pa(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(ka(t.prev,t,e.prev)||ka(t,e.prev,e))||Ta(t,e)&&ka(t.prev,t,t.next)>0&&ka(e.prev,e,e.next)>0)}function ka(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ta(t,e){return t.x===e.x&&t.y===e.y}function Ea(t,e,n,i){var r=Aa(ka(t,e,n)),o=Aa(ka(t,e,i)),s=Aa(ka(n,i,t)),a=Aa(ka(n,i,e));return r!==o&&s!==a||!(0!==r||!Sa(t,n,e))||!(0!==o||!Sa(t,i,e))||!(0!==s||!Sa(n,t,i))||!(0!==a||!Sa(n,e,i))}function Sa(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Aa(t){return t>0?1:t<0?-1:0}function Pa(t,e){return ka(t.prev,t,t.next)<0?ka(t,e,t.next)>=0&&ka(t,t.prev,e)>=0:ka(t,e,t.prev)<0||ka(t,t.next,e)<0}function Oa(t,e){var n=new Ra(t.i,t.x,t.y),i=new Ra(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function Ca(t,e,n,i){var r=new Ra(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ma(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ra(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ia(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}aa.exports=ua,aa.exports.default=ua,ua.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(Ia(t,0,o,n));if(r)for(var a=0,u=e.length;a<u;a++){var l=e[a]*n,h=a<u-1?e[a+1]*n:t.length;s-=Math.abs(Ia(t,l,h,n))}var c=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,d=i[a+1]*n,p=i[a+2]*n;c+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},ua.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var La,ja=function(){function t(e,n,i){c(this,t),this.pos=Gr.pull("Vector2d"),this._bounds,this.points=[],this.edges=[],this.indices=[],this.normals=[],this.shapeType="Polygon",this.setShape(e,n,i)}return d(t,[{key:"onResetEvent",value:function(t,e,n){this.setShape(t,e,n)}},{key:"setShape",value:function(t,e,n){return this.pos.set(t,e),this.setVertices(n),this}},{key:"setVertices",value:function(t){var e=this;if(!Array.isArray(t))return this;if(t[0]instanceof Hr)this.points=t;else if(this.points.length=0,"object"===p(t[0]))t.forEach((function(t){e.points.push(Gr.pull("Vector2d",t.x,t.y))}));else for(var n=0;n<t.length;n+=2)this.points.push(Gr.pull("Vector2d",t[n],t[n+1]));return this.recalc(),this.updateBounds(),this}},{key:"transform",value:function(t){for(var e=this.points,n=e.length,i=0;i<n;i++)t.apply(e[i]);return this.recalc(),this.updateBounds(),this}},{key:"toIso",value:function(){return this.rotate(Math.PI/4).scale(Math.SQRT2,Math.SQRT1_2)}},{key:"to2d",value:function(){return this.scale(Math.SQRT1_2,Math.SQRT2).rotate(-Math.PI/4)}},{key:"rotate",value:function(t,e){if(0!==t){for(var n=this.points,i=n.length,r=0;r<i;r++)n[r].rotate(t,e);this.recalc(),this.updateBounds()}return this}},{key:"scale",value:function(t,e){e=void 0!==e?e:t;for(var n=this.points,i=n.length,r=0;r<i;r++)n[r].scale(t,e);return this.recalc(),this.updateBounds(),this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y)}},{key:"recalc",value:function(){var t,e=this.edges,n=this.normals,i=this.indices,r=this.points,o=r.length;if(o<3)throw new Error("Requires at least 3 points");for(t=0;t<o;t++)void 0===e[t]&&(e[t]=Gr.pull("Vector2d")),e[t].copy(r[(t+1)%o]).sub(r[t]),void 0===n[t]&&(n[t]=Gr.pull("Vector2d")),n[t].copy(e[t]).perp().normalize();return e.length=o,n.length=o,i.length=0,this}},{key:"getIndices",value:function(){return 0===this.indices.length&&(this.indices=aa.exports(this.points.flatMap((function(t){return[t.x,t.y]})))),this.indices}},{key:"isConvex",value:function(){var t,e,n,i,r=0,o=this.points,s=o.length;if(s<3)return null;for(t=0;t<s;t++)if(n=(t+2)%s,i=(o[e=(t+1)%s].x-o[t].x)*(o[n].y-o[e].y),(i-=(o[e].y-o[t].y)*(o[n].x-o[e].x))<0?r|=1:i>0&&(r|=2),3===r)return!1;return 0!==r||null}},{key:"translate",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.pos.x+=t,this.pos.y+=e,this.getBounds().translate(t,e),this}},{key:"shift",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.pos.x=t,this.pos.y=e,this.updateBounds()}},{key:"contains",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y);for(var n=!1,i=this.pos.x,r=this.pos.y,o=this.points,s=o.length,a=0,u=s-1;a<s;u=a++){var l=o[a].y+r,h=o[a].x+i,c=o[u].y+r,f=o[u].x+i;l>e!=c>e&&t<(f-h)*(e-l)/(c-l)+h&&(n=!n)}return n}},{key:"getBounds",value:function(){return void 0===this._bounds&&(this._bounds=Gr.pull("Bounds")),this._bounds}},{key:"updateBounds",value:function(){var t=this.getBounds();return t.update(this.points),t.translate(this.pos),t}},{key:"clone",value:function(){var e=[];return this.points.forEach((function(t){e.push(t.clone())})),new t(this.pos.x,this.pos.y,e)}}]),t}(),Ba=function(t){o(n,t);var e=a(n);function n(t,i,r,o){var s;return c(this,n),(s=e.call(this,t,i,[Gr.pull("Vector2d",0,0),Gr.pull("Vector2d",r,0),Gr.pull("Vector2d",r,o),Gr.pull("Vector2d",0,o)])).shapeType="Rectangle",s}return d(n,[{key:"onResetEvent",value:function(t,e,n,i){this.setShape(t,e,n,i)}},{key:"setShape",value:function(t,e,n,i){var r=n;return this.pos.set(t,e),4===arguments.length&&((r=this.points)[0].set(0,0),r[1].set(n,0),r[2].set(n,i),r[3].set(0,i)),this.setVertices(r),this}},{key:"left",get:function(){return this.pos.x}},{key:"right",get:function(){var t=this.width;return this.pos.x+t||t}},{key:"top",get:function(){return this.pos.y}},{key:"bottom",get:function(){var t=this.height;return this.pos.y+t||t}},{key:"width",get:function(){return this.points[2].x},set:function(t){this.points[1].x=this.points[2].x=t,this.recalc(),this.updateBounds()}},{key:"height",get:function(){return this.points[2].y},set:function(t){this.points[2].y=this.points[3].y=t,this.recalc(),this.updateBounds()}},{key:"centerX",get:function(){return isFinite(this.width)?this.pos.x+this.width/2:this.width},set:function(t){this.pos.x=t-this.width/2}},{key:"centerY",get:function(){return isFinite(this.height)?this.pos.y+this.height/2:this.height},set:function(t){this.pos.y=t-this.height/2}},{key:"centerOn",value:function(t,e){return this.centerX=t,this.centerY=e,this}},{key:"resize",value:function(t,e){return this.width=t,this.height=e,this}},{key:"scale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return this.width*=t,this.height*=e,this}},{key:"clone",value:function(){return new n(this.pos.x,this.pos.y,this.width,this.height)}},{key:"copy",value:function(t){return this.setShape(t.pos.x,t.pos.y,t.width,t.height)}},{key:"union",value:function(t){var e=Math.min(this.left,t.left),n=Math.min(this.top,t.top);return this.resize(Math.max(this.right,t.right)-e,Math.max(this.bottom,t.bottom)-n),this.pos.set(e,n),this}},{key:"overlaps",value:function(t){return this.left<t.right&&t.left<this.right&&this.top<t.bottom&&t.top<this.bottom}},{key:"contains",value:function(){var t,e,i,r,o=arguments[0];return 2===arguments.length?(t=e=o,i=r=arguments[1]):o instanceof n?(t=o.left,e=o.right,i=o.top,r=o.bottom):(t=e=o.x,i=r=o.y),t>=this.left&&e<=this.right&&i>=this.top&&r<=this.bottom}},{key:"equals",value:function(t){return t.left===this.left&&t.right===this.right&&t.top===this.top&&t.bottom===this.bottom}},{key:"isFinite",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return isFinite(this.pos.x)&&isFinite(this.pos.y)&&isFinite(this.width)&&isFinite(this.height)}))},{key:"toPolygon",value:function(){return Gr.pull("Polygon",this.pos.x,this.pos.y,this.points)}}]),n}(ja),Da=function(t){o(n,t);var e=a(n);function n(t,i,r,o){var s,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20;return c(this,n),(s=e.call(this,t,i,r,o)).radius=a,s}return d(n,[{key:"onResetEvent",value:function(t,e,r,o,s){i(h(n.prototype),"setShape",this).call(this,t,e,r,o),this.radius=s}},{key:"radius",get:function(){return this._radius},set:function(t){this.width<2*t&&(t=this.width/2),this.height<2*t&&(t=this.height/2),this._radius=t}},{key:"copy",value:function(t){return i(h(n.prototype),"setShape",this).call(this,t.pos.x,t.pos.y,t.width,t.height),this.radius=t.radius,this}},{key:"contains",value:function(){var t,e,r,o,s=arguments[0];if(2===arguments.length)t=s,e=arguments[1];else{if(s instanceof Ba)return i(h(n.prototype),"contains",this).call(this,s);t=s.x,e=s.y}if(t<this.left||t>=this.right||e<this.top||e>=this.bottom)return!1;if(t>=this.left+this.radius&&t<=this.right-this.radius||e>=this.top+this.radius&&e<=this.bottom-this.radius)return!0;var a=Math.max(0,Math.min(this.radius,this.width/2)),u=Math.max(0,Math.min(this.radius,this.height/2));if(t<this.left+a&&e<this.top+u)r=t-this.left-a,o=e-this.top-u;else if(t>this.right-a&&e<this.top+u)r=t-this.right+a,o=e-this.top-u;else if(t>this.right-a&&e>this.bottom-u)r=t-this.right+a,o=e-this.bottom+u;else{if(!(t<this.left+a&&e>this.bottom-u))return!1;r=t-this.left-a,o=e-this.bottom+u}return r*r+o*o<=a*u}},{key:"equals",value:function(t){return i(h(n.prototype),"equals",this).call(this,t)&&this.radius===t.radius}},{key:"clone",value:function(){return new n(this.pos.x,this.pos.y,this.width,this.height,this.radius)}}]),n}(Ba),Fa=function(){function t(e,n,i,r){c(this,t),this.pos=Gr.pull("Vector2d"),this._bounds=void 0,this.radius=NaN,this.radiusV=Gr.pull("Vector2d"),this.radiusSq=Gr.pull("Vector2d"),this.ratio=Gr.pull("Vector2d"),this.shapeType="Ellipse",this.setShape(e,n,i,r)}return d(t,[{key:"onResetEvent",value:function(t,e,n,i){this.setShape(t,e,n,i)}},{key:"setShape",value:function(t,e,n,i){var r=n/2,o=i/2;this.pos.set(t,e),this.radius=Math.max(r,o),this.ratio.set(r/this.radius,o/this.radius),this.radiusV.set(this.radius,this.radius).scaleV(this.ratio);var s=this.radius*this.radius;return this.radiusSq.set(s,s).scaleV(this.ratio),this.getBounds().setMinMax(t,e,t+n,t+i),this.getBounds().translate(-this.radiusV.x,-this.radiusV.y),this}},{key:"rotate",value:function(t,e){return this.pos.rotate(t,e),this.getBounds().shift(this.pos),this.getBounds().translate(-this.radiusV.x,-this.radiusV.y),this}},{key:"scale",value:function(t,e){return e=void 0!==e?e:t,this.setShape(this.pos.x,this.pos.y,2*this.radiusV.x*t,2*this.radiusV.y*e)}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y)}},{key:"transform",value:function(t){return this}},{key:"translate",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.pos.x+=t,this.pos.y+=e,this.getBounds().translate(t,e),this}},{key:"contains",value:function(){var t,e;return 2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),t-=this.pos.x,e-=this.pos.y,t*t/this.radiusSq.x+e*e/this.radiusSq.y<=1}},{key:"getBounds",value:function(){return void 0===this._bounds&&(this._bounds=Gr.pull("Bounds")),this._bounds}},{key:"clone",value:function(){return new t(this.pos.x,this.pos.y,2*this.radiusV.x,2*this.radiusV.y)}}]),t}(),Na=function(t){o(n,t);var e=a(n);function n(){return c(this,n),e.apply(this,arguments)}return d(n,[{key:"contains",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),t-=this.pos.x,e-=this.pos.y;var n=this.points[0],i=this.points[1];return(e-n.y)*(i.x-n.x)==(i.y-n.y)*(t-n.x)}},{key:"recalc",value:function(){var t=this.edges,e=this.normals,n=this.indices,i=this.points;if(2!==i.length)throw new Error("Requires exactly 2 points");return void 0===t[0]&&(t[0]=Gr.pull("Vector2d")),t[0].copy(i[1]).sub(i[0]),void 0===e[0]&&(e[0]=Gr.pull("Vector2d")),e[0].copy(t[0]).perp().normalize(),n.length=0,this}},{key:"clone",value:function(){var t=[];return this.points.forEach((function(e){t.push(e.clone())})),new n(this.pos.x,this.pos.y,t)}}]),n}(ja),za=function(){function t(e){c(this,t),this._center=new Hr,this.onResetEvent(e)}return d(t,[{key:"onResetEvent",value:function(t){void 0===this.min?(this.min={x:1/0,y:1/0},this.max={x:-1/0,y:-1/0}):this.clear(),void 0!==t&&this.update(t)}},{key:"clear",value:function(){this.setMinMax(1/0,1/0,-1/0,-1/0)}},{key:"setMinMax",value:function(t,e,n,i){this.min.x=t,this.min.y=e,this.max.x=n,this.max.y=i}},{key:"x",get:function(){return this.min.x},set:function(t){var e=this.max.x-this.min.x;this.min.x=t,this.max.x=t+e}},{key:"y",get:function(){return this.min.y},set:function(t){var e=this.max.y-this.min.y;this.min.y=t,this.max.y=t+e}},{key:"width",get:function(){return this.max.x-this.min.x},set:function(t){this.max.x=this.min.x+t}},{key:"height",get:function(){return this.max.y-this.min.y},set:function(t){this.max.y=this.min.y+t}},{key:"left",get:function(){return this.min.x}},{key:"right",get:function(){return this.max.x}},{key:"top",get:function(){return this.min.y}},{key:"bottom",get:function(){return this.max.y}},{key:"centerX",get:function(){return this.min.x+this.width/2}},{key:"centerY",get:function(){return this.min.y+this.height/2}},{key:"center",get:function(){return this._center.set(this.centerX,this.centerY)}},{key:"update",value:function(t){this.add(t,!0)}},{key:"add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e&&this.clear();for(var n=0;n<t.length;n++){var i=t[n];i.x>this.max.x&&(this.max.x=i.x),i.x<this.min.x&&(this.min.x=i.x),i.y>this.max.y&&(this.max.y=i.y),i.y<this.min.y&&(this.min.y=i.y)}}},{key:"addBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!0===e&&this.clear(),t.max.x>this.max.x&&(this.max.x=t.max.x),t.min.x<this.min.x&&(this.min.x=t.min.x),t.max.y>this.max.y&&(this.max.y=t.max.y),t.min.y<this.min.y&&(this.min.y=t.min.y)}},{key:"addPoint",value:function(t,e){void 0!==e&&(t=e.apply(t)),this.min.x=Math.min(this.min.x,t.x),this.max.x=Math.max(this.max.x,t.x),this.min.y=Math.min(this.min.y,t.y),this.max.y=Math.max(this.max.y,t.y)}},{key:"addFrame",value:function(t,e,n,i,r){var o=Gr.pull("Vector2d");this.addPoint(o.set(t,e),r),this.addPoint(o.set(n,e),r),this.addPoint(o.set(t,i),r),this.addPoint(o.set(n,i),r),Gr.push(o)}},{key:"contains",value:function(){var e,n,i,r,o=arguments[0];return 2===arguments.length?(e=n=o,i=r=arguments[1]):o instanceof t?(e=o.min.x,n=o.max.x,i=o.min.y,r=o.max.y):(e=n=o.x,i=r=o.y),e>=this.min.x&&n<=this.max.x&&i>=this.min.y&&r<=this.max.y}},{key:"overlaps",value:function(t){return!(this.right<t.left||this.left>t.right||this.bottom<t.top||this.top>t.bottom)}},{key:"isFinite",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return isFinite(this.min.x)&&isFinite(this.max.x)&&isFinite(this.min.y)&&isFinite(this.max.y)}))},{key:"translate",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.min.x+=t,this.max.x+=t,this.min.y+=e,this.max.y+=e}},{key:"shift",value:function(){var t,e;2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y);var n=this.max.x-this.min.x,i=this.max.y-this.min.y;this.min.x=t,this.max.x=t+n,this.min.y=e,this.max.y=e+i}},{key:"clone",value:function(){var e=new t;return e.addBounds(this),e}},{key:"toPolygon",value:function(){return Gr.pull("Polygon",this.x,this.y,[Gr.pull("Vector2d",0,0),Gr.pull("Vector2d",this.width,0),Gr.pull("Vector2d",this.width,this.height),Gr.pull("Vector2d",0,this.height)])}}]),t}(),Ua=function(){function t(){c(this,t),this.points=[],this.arcResolution=5,this.vertices=[]}return d(t,[{key:"beginPath",value:function(){this.points.forEach((function(t){Gr.push(t)})),this.points.length=0}},{key:"closePath",value:function(){var t=this.points;t.length>1&&!t[t.length-1].equals(t[0])&&t.push(Gr.pull("Vector2d",t[0].x,t[0].y))}},{key:"triangulatePath",value:function(){var t=0,e=this.points,n=this.vertices,i=aa.exports(e.flatMap((function(t){return[t.x,t.y]})));for(t=0;t<i.length;t++)void 0===n[t]&&(n[t]=Gr.pull("Vector2d")),n[t].set(e[i[t]].x,e[i[t]].y);for(;n.length>i.length;)Gr.push(n[n.length-1]),n.length-=1;return n}},{key:"moveTo",value:function(t,e){this.points.push(Gr.pull("Vector2d",t,e))}},{key:"lineTo",value:function(t,e){this.points.push(Gr.pull("Vector2d",t,e))}},{key:"arc",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=this.points;if(i!==r){var a=o?Math.abs(i-r)>=Tr:Math.abs(r-i)>=Tr;(i%=Tr)<0&&(i+=Tr),(r%=Tr)<0&&(r+=Tr),i>=r&&(r+=Tr);var u=r-i,l=1;o&&(l=-1,u=Tr-u),a&&(u=Tr);for(var h=u*n,c=h/this.arcResolution,f=u/c,d=i,p=0;p<c;p++)s.push(Gr.pull("Vector2d",t+n*Math.cos(d),e+n*Math.sin(d))),d+=l*f;s.push(Gr.pull("Vector2d",t+n*Math.cos(r),e+n*Math.sin(r)))}}},{key:"arcTo",value:function(t,e,n,i,r){var o=this.points,s=[o[o.length-1].x-t,o[o.length-1].y-e],a=[n-t,i-e],u=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),l=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));s[0]/=u,s[1]/=u,a[0]/=l,a[1]/=l;var h=Math.atan2(s[1],s[0])-Math.atan2(a[1],a[0]),c=r/Math.tan(h/2),f=[t+s[0]*c,e+s[1]*c],d=[t+a[0]*c,e+a[1]*c];o.push(Gr.pull("Vector2d",f[0],f[1]));var p=[(s[0]+a[0])/2,(s[1]+a[1])/2],v=Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2));p[0]/=v,p[1]/=v;var y=Math.sqrt(Math.pow(r,2)+Math.pow(c,2)),g=[t+y*p[0],e+y*p[1]],m=Math.atan2(f[1]-g[1],f[0]-g[0]),b=Math.atan2(d[1]-g[1],d[0]-g[0]);this.arc(g[0],g[1],r,m,b)}},{key:"ellipse",value:function(t,e,n,i,r,o,s){var a=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=this.points;if(o!==s){var l=a?Math.abs(o-s)>=Tr:Math.abs(s-o)>=Tr;(o%=Tr)<0&&(o+=Tr),(s%=Tr)<0&&(s+=Tr),o>=s&&(s+=Tr);var h=s-o,c=1;a&&(c=-1,h=Tr-h),l&&(h=Tr);for(var f=(h*n+h*i)/2,d=f/this.arcResolution,p=h/d,v=o,y=Math.cos(r),g=Math.sin(r),m=0;m<d;m++){var b=n*Math.cos(v),x=i*Math.sin(v),w=t+b*y-x*g,_=e+b*g+x*y;u.push(Gr.pull("Vector2d",w,_)),v+=c*p}}}},{key:"rect",value:function(t,e,n,i){this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+i),this.lineTo(t,e+i),this.lineTo(t,e)}},{key:"roundRect",value:function(t,e,n,i,r){this.moveTo(t+r,e),this.lineTo(t+n-r,e),this.arcTo(t+n,e,t+n,e+r,r),this.lineTo(t+n,e+i-r),this.arcTo(t+n,e+i,t+n-r,e+i,r),this.lineTo(t+r,e+i),this.arcTo(t,e+i,t,e+i-r,r),this.lineTo(t,e+r),this.arcTo(t,e,t+r,e,r)}}]),t}(),Va=function(){function t(e){c(this,t),this.settings=e,this.isContextValid=!0,this.path2D=new Ua,this.currentScissor=new Int32Array([0,0,this.settings.width,this.settings.height]),this.maskLevel=0,this.currentBlendMode="none",void 0!==globalThis.canvas?this.canvas=globalThis.canvas:void 0!==this.settings.canvas?this.canvas=this.settings.canvas:this.canvas=Oc(this.settings.zoomX,this.settings.zoomY),this.backBufferCanvas=this.canvas,this.context=null,this.currentColor=new Qr(0,0,0,1),this.currentTint=new Qr(255,255,255,1),this.projectionMatrix=new $r,this.uvOffset=0,Fo(fo,(function(){Pc.reset()}))}return d(t,[{key:"clear",value:function(){}},{key:"reset",value:function(){this.resetTransform(),this.setBlendMode(this.settings.blendMode),this.setColor("#000000"),this.clearTint(),this.cache.clear(),this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=this.backBufferCanvas.width,this.currentScissor[3]=this.backBufferCanvas.height,this.clearMask()}},{key:"getCanvas",value:function(){return this.backBufferCanvas}},{key:"getScreenCanvas",value:function(){return this.canvas}},{key:"getScreenContext",value:function(){return this.context}},{key:"getBlendMode",value:function(){return this.currentBlendMode}},{key:"getContext2d",value:function(t,e){if(null==t)throw new Error("You must pass a canvas element in order to create a 2d context");if(void 0===t.getContext)throw new Error("Your browser does not support HTML5 canvas.");"boolean"!=typeof e&&(e=!0);var n=t.getContext("2d",{alpha:e});return n.canvas||(n.canvas=t),this.setAntiAlias(n,this.settings.antiAlias),n}},{key:"getWidth",value:function(){return this.backBufferCanvas.width}},{key:"getHeight",value:function(){return this.backBufferCanvas.height}},{key:"getColor",value:function(){return this.currentColor}},{key:"globalAlpha",value:function(){return this.currentColor.glArray[3]}},{key:"overlaps",value:function(t){return t.left<=this.getWidth()&&t.right>=0&&t.top<=this.getHeight()&&t.bottom>=0}},{key:"resize",value:function(t,e){t===this.backBufferCanvas.width&&e===this.backBufferCanvas.height||(this.canvas.width=this.backBufferCanvas.width=t,this.canvas.height=this.backBufferCanvas.height=e,this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=t,this.currentScissor[3]=e,Do(Co,t,e))}},{key:"setAntiAlias",value:function(t,e){var n=t.canvas;wr("imageSmoothingEnabled",!0===e,t),!0!==e?(n.style["image-rendering"]="optimizeSpeed",n.style["image-rendering"]="-moz-crisp-edges",n.style["image-rendering"]="-o-crisp-edges",n.style["image-rendering"]="-webkit-optimize-contrast",n.style["image-rendering"]="optimize-contrast",n.style["image-rendering"]="crisp-edges",n.style["image-rendering"]="pixelated",n.style.msInterpolationMode="nearest-neighbor"):n.style["image-rendering"]="auto"}},{key:"setProjection",value:function(t){this.projectionMatrix.copy(t)}},{key:"stroke",value:function(t,e){if(t instanceof Da)this.strokeRoundRect(t.left,t.top,t.width,t.height,t.radius,e);else if(t instanceof Ba||t instanceof za)this.strokeRect(t.left,t.top,t.width,t.height,e);else if(t instanceof Na||t instanceof ja)this.strokePolygon(t,e);else{if(!(t instanceof Fa))throw new Error("Invalid geometry for fill/stroke");this.strokeEllipse(t.pos.x,t.pos.y,t.radiusV.x,t.radiusV.y,e)}}},{key:"fill",value:function(t){this.stroke(t,!0)}},{key:"tint",value:function(t,e,n){var i=Oc(t.width,t.height,!0),r=this.getContext2d(i);return r.save(),r.fillStyle=e instanceof Qr?e.toRGB():e,r.fillRect(0,0,t.width,t.height),r.globalCompositeOperation=n||"multiply",r.drawImage(t,0,0),r.globalCompositeOperation="destination-atop",r.drawImage(t,0,0),r.restore(),i}},{key:"setMask",value:function(t){}},{key:"clearMask",value:function(){}},{key:"setTint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.alpha;this.currentTint.copy(t),this.currentTint.alpha*=e}},{key:"clearTint",value:function(){this.currentTint.setColor(255,255,255,1)}},{key:"drawFont",value:function(){}}]),t}(),Ga={};La=Ga,function(){var t=function(){this.init()};t.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var n=this||e;if(t=parseFloat(t),n.ctx||l(),void 0!==t&&t>=0&&t<=1){if(n._volume=t,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var i=0;i<n._howls.length;i++)if(!n._howls[i]._webAudio)for(var r=n._howls[i]._getSoundIds(),o=0;o<r.length;o++){var s=n._howls[i]._soundById(r[o]);s&&s._node&&(s._node.volume=s._volume*t)}return n}return n._volume},mute:function(t){var n=this||e;n.ctx||l(),n._muted=t,n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t?0:n._volume,e.ctx.currentTime);for(var i=0;i<n._howls.length;i++)if(!n._howls[i]._webAudio)for(var r=n._howls[i]._getSoundIds(),o=0;o<r.length;o++){var s=n._howls[i]._soundById(r[o]);s&&s._node&&(s._node.muted=!!t||s._muted)}return n},stop:function(){for(var t=this||e,n=0;n<t._howls.length;n++)t._howls[n].stop();return t},unload:function(){for(var t=this||e,n=t._howls.length-1;n>=0;n--)t._howls[n].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,l()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(t){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(e){return t}if(!n||"function"!=typeof n.canPlayType)return t;var i=n.canPlayType("audio/mpeg;").replace(/^no$/,""),r=t._navigator?t._navigator.userAgent:"",o=r.match(/OPR\/([0-6].)/g),s=o&&parseInt(o[0].split("/")[1],10)<33,a=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),u=r.match(/Version\/(.*?) /),l=a&&u&&parseInt(u[1],10)<15;return t._codecs={mp3:!(s||!i&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(n.canPlayType('audio/wav; codecs="1"')||n.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(n.canPlayType("audio/x-m4b;")||n.canPlayType("audio/m4b;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(l||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(l||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var n=function e(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,t._releaseHtml5Audio(i)}catch(n){t.noAudio=!0;break}for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var o=t._howls[r]._getSoundIds(),s=0;s<o.length;s++){var a=t._howls[r]._soundById(o[s]);a&&a._node&&!a._node._unlocked&&(a._node._unlocked=!0,a._node.load())}t._autoResume();var u=t.ctx.createBufferSource();u.buffer=t._scratchBuffer,u.connect(t.ctx.destination),void 0===u.start?u.noteOn(0):u.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),u.onended=function(){u.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",n,!0),document.addEventListener("touchend",n,!0),document.addEventListener("click",n,!0),document.addEventListener("keydown",n,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var n=(new Audio).play();return n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)&&n.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var n=this||e;return t._unlocked&&n._html5AudioPool.push(t),n},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var n=0;n<t._howls.length;n++)if(t._howls[n]._webAudio)for(var i=0;i<t._howls[n]._sounds.length;i++)if(!t._howls[n]._sounds[i]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new t,n=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};n.prototype={init:function(t){var n=this;return e.ctx||l(),n._autoplay=t.autoplay||!1,n._format="string"!=typeof t.format?t.format:[t.format],n._html5=t.html5||!1,n._muted=t.mute||!1,n._loop=t.loop||!1,n._pool=t.pool||5,n._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,n._rate=t.rate||1,n._sprite=t.sprite||{},n._src="string"!=typeof t.src?t.src:[t.src],n._volume=void 0!==t.volume?t.volume:1,n._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=t.onend?[{fn:t.onend}]:[],n._onfade=t.onfade?[{fn:t.onfade}]:[],n._onload=t.onload?[{fn:t.onload}]:[],n._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],n._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],n._onpause=t.onpause?[{fn:t.onpause}]:[],n._onplay=t.onplay?[{fn:t.onplay}]:[],n._onstop=t.onstop?[{fn:t.onstop}]:[],n._onmute=t.onmute?[{fn:t.onmute}]:[],n._onvolume=t.onvolume?[{fn:t.onvolume}]:[],n._onrate=t.onrate?[{fn:t.onrate}]:[],n._onseek=t.onseek?[{fn:t.onseek}]:[],n._onunlock=t.onunlock?[{fn:t.onunlock}]:[],n._onresume=[],n._webAudio=e.usingWebAudio&&!n._html5,void 0!==e.ctx&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&"none"!==n._preload&&n.load(),n},load:function(){var t=this,n=null;if(e.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var r=0;r<t._src.length;r++){var s,a;if(t._format&&t._format[r])s=t._format[r];else{if("string"!=typeof(a=t._src[r])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(s=/^data:audio\/([^;,]+);/i.exec(a))||(s=/\.([^.]+)$/.exec(a.split("?",1)[0])),s&&(s=s[1].toLowerCase())}if(s||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),s&&e.codecs(s)){n=t._src[r];break}}if(n)return t._src=n,t._state="loading","https:"===window.location.protocol&&"http:"===n.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new i(t),t._webAudio&&o(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,n){var i=this,r=null;if("number"==typeof t)r=t,t=null;else{if("string"==typeof t&&"loaded"===i._state&&!i._sprite[t])return null;if(void 0===t&&(t="__default",!i._playLock)){for(var o=0,s=0;s<i._sounds.length;s++)i._sounds[s]._paused&&!i._sounds[s]._ended&&(o++,r=i._sounds[s]._id);1===o?t=null:r=null}}var a=r?i._soundById(r):i._inactiveSound();if(!a)return null;if(r&&!t&&(t=a._sprite||"__default"),"loaded"!==i._state){a._sprite=t,a._ended=!1;var u=a._id;return i._queue.push({event:"play",action:function(){i.play(u)}}),u}if(r&&!a._paused)return n||i._loadQueue("play"),a._id;i._webAudio&&e._autoResume();var l=Math.max(0,a._seek>0?a._seek:i._sprite[t][0]/1e3),h=Math.max(0,(i._sprite[t][0]+i._sprite[t][1])/1e3-l),c=1e3*h/Math.abs(a._rate),f=i._sprite[t][0]/1e3,d=(i._sprite[t][0]+i._sprite[t][1])/1e3;a._sprite=t,a._ended=!1;var p=function(){a._paused=!1,a._seek=l,a._start=f,a._stop=d,a._loop=!(!a._loop&&!i._sprite[t][2])};if(!(l>=d)){var v=a._node;if(i._webAudio){var y=function(){i._playLock=!1,p(),i._refreshBuffer(a);var t=a._muted||i._muted?0:a._volume;v.gain.setValueAtTime(t,e.ctx.currentTime),a._playStart=e.ctx.currentTime,void 0===v.bufferSource.start?a._loop?v.bufferSource.noteGrainOn(0,l,86400):v.bufferSource.noteGrainOn(0,l,h):a._loop?v.bufferSource.start(0,l,86400):v.bufferSource.start(0,l,h),c!==1/0&&(i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),c)),n||setTimeout((function(){i._emit("play",a._id),i._loadQueue()}),0)};"running"===e.state&&"interrupted"!==e.ctx.state?y():(i._playLock=!0,i.once("resume",y),i._clearTimer(a._id))}else{var g=function(){v.currentTime=l,v.muted=a._muted||i._muted||e._muted||v.muted,v.volume=a._volume*e.volume(),v.playbackRate=a._rate;try{var r=v.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(i._playLock=!0,p(),r.then((function(){i._playLock=!1,v._unlocked=!0,n?i._loadQueue():i._emit("play",a._id)})).catch((function(){i._playLock=!1,i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),a._ended=!0,a._paused=!0}))):n||(i._playLock=!1,p(),i._emit("play",a._id)),v.playbackRate=a._rate,v.paused)return void i._emit("playerror",a._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||a._loop?i._endTimers[a._id]=setTimeout(i._ended.bind(i,a),c):(i._endTimers[a._id]=function(){i._ended(a),v.removeEventListener("ended",i._endTimers[a._id],!1)},v.addEventListener("ended",i._endTimers[a._id],!1))}catch(t){i._emit("playerror",a._id,t)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===v.src&&(v.src=i._src,v.load());var m=window&&window.ejecta||!v.readyState&&e._navigator.isCocoonJS;v.readyState>=3||m?g():(i._playLock=!0,i._state="loading",v.addEventListener(e._canPlayEvent,(function t(){i._state="loaded",g(),v.removeEventListener(e._canPlayEvent,t,!1)}),!1),i._clearTimer(a._id))}return a._id}i._ended(a)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),i=0;i<n.length;i++){e._clearTimer(n[i]);var r=e._soundById(n[i]);if(r&&!r._paused&&(r._seek=e.seek(n[i]),r._rateSeek=0,r._paused=!0,e._stopFade(n[i]),r._node))if(e._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),e._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||e._emit("pause",r?r._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var i=n._getSoundIds(t),r=0;r<i.length;r++){n._clearTimer(i[r]);var o=n._soundById(i[r]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,n._stopFade(i[r]),o._node&&(n._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),n._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&n._clearSound(o._node))),e||n._emit("stop",o._id))}return n},mute:function(t,n){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(t,n)}}),i;if(void 0===n){if("boolean"!=typeof t)return i._muted;i._muted=t}for(var r=i._getSoundIds(n),o=0;o<r.length;o++){var s=i._soundById(r[o]);s&&(s._muted=t,s._interval&&i._stopFade(s._id),i._webAudio&&s._node?s._node.gain.setValueAtTime(t?0:s._volume,e.ctx.currentTime):s._node&&(s._node.muted=!!e._muted||t),i._emit("mute",s._id))}return i},volume:function(){var t,n,i,r=this,o=arguments;if(0===o.length)return r._volume;if(1===o.length||2===o.length&&void 0===o[1]){var s=r._getSoundIds(),a=s.indexOf(o[0]);a>=0?n=parseInt(o[0],10):t=parseFloat(o[0])}else o.length>=2&&(t=parseFloat(o[0]),n=parseInt(o[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(i=n?r._soundById(n):r._sounds[0])?i._volume:0;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,o)}}),r;void 0===n&&(r._volume=t),n=r._getSoundIds(n);for(var u=0;u<n.length;u++)(i=r._soundById(n[u]))&&(i._volume=t,o[2]||r._stopFade(n[u]),r._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(t,e.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=t*e.volume()),r._emit("volume",i._id));return r},fade:function(t,n,i,r){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(t,n,i,r)}}),o;t=Math.min(Math.max(0,parseFloat(t)),1),n=Math.min(Math.max(0,parseFloat(n)),1),i=parseFloat(i),o.volume(t,r);for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if(r||o._stopFade(s[a]),o._webAudio&&!u._muted){var l=e.ctx.currentTime,h=l+i/1e3;u._volume=t,u._node.gain.setValueAtTime(t,l),u._node.gain.linearRampToValueAtTime(n,h)}o._startFadeInterval(u,t,n,i,s[a],void 0===r)}}return o},_startFadeInterval:function(t,e,n,i,r,o){var s=this,a=e,u=n-e,l=Math.abs(u/.01),h=Math.max(4,l>0?i/l:i),c=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var r=(Date.now()-c)/i;c=Date.now(),a+=u*r,a=Math.round(100*a)/100,a=u<0?Math.max(n,a):Math.min(n,a),s._webAudio?t._volume=a:s.volume(a,t._id,!0),o&&(s._volume=a),(n<e&&a<=n||n>e&&a>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,s.volume(n,t._id),s._emit("fade",t._id))}),h)},_stopFade:function(t){var n=this,i=n._soundById(t);return i&&i._interval&&(n._webAudio&&i._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(i._interval),i._interval=null,n.volume(i._fadeTo,t),i._fadeTo=null,n._emit("fade",t)),n},loop:function(){var t,e,n,i=this,r=arguments;if(0===r.length)return i._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(n=i._soundById(parseInt(r[0],10)))&&n._loop;t=r[0],i._loop=t}else 2===r.length&&(t=r[0],e=parseInt(r[1],10));for(var o=i._getSoundIds(e),s=0;s<o.length;s++)(n=i._soundById(o[s]))&&(n._loop=t,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,i.playing(o[s])&&(i.pause(o[s],!0),i.play(o[s],!0)))));return i},rate:function(){var t,n,i,r=this,o=arguments;if(0===o.length)n=r._sounds[0]._id;else if(1===o.length){var s=r._getSoundIds(),a=s.indexOf(o[0]);a>=0?n=parseInt(o[0],10):t=parseFloat(o[0])}else 2===o.length&&(t=parseFloat(o[0]),n=parseInt(o[1],10));if("number"!=typeof t)return(i=r._soundById(n))?i._rate:r._rate;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,o)}}),r;void 0===n&&(r._rate=t),n=r._getSoundIds(n);for(var u=0;u<n.length;u++)if(i=r._soundById(n[u])){r.playing(n[u])&&(i._rateSeek=r.seek(n[u]),i._playStart=r._webAudio?e.ctx.currentTime:i._playStart),i._rate=t,r._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):i._node&&(i._node.playbackRate=t);var l=r.seek(n[u]),h=(r._sprite[i._sprite][0]+r._sprite[i._sprite][1])/1e3-l,c=1e3*h/Math.abs(i._rate);!r._endTimers[n[u]]&&i._paused||(r._clearTimer(n[u]),r._endTimers[n[u]]=setTimeout(r._ended.bind(r,i),c)),r._emit("rate",i._id)}return r},seek:function(){var t,n,i=this,r=arguments;if(0===r.length)i._sounds.length&&(n=i._sounds[0]._id);else if(1===r.length){var o=i._getSoundIds(),s=o.indexOf(r[0]);s>=0?n=parseInt(r[0],10):i._sounds.length&&(n=i._sounds[0]._id,t=parseFloat(r[0]))}else 2===r.length&&(t=parseFloat(r[0]),n=parseInt(r[1],10));if(void 0===n)return 0;if("number"==typeof t&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,r)}}),i;var a=i._soundById(n);if(a){if(!("number"==typeof t&&t>=0)){if(i._webAudio){var u=i.playing(n)?e.ctx.currentTime-a._playStart:0,l=a._rateSeek?a._rateSeek-a._seek:0;return a._seek+(l+u*Math.abs(a._rate))}return a._node.currentTime}var h=i.playing(n);h&&i.pause(n,!0),a._seek=t,a._ended=!1,i._clearTimer(n),i._webAudio||!a._node||isNaN(a._node.duration)||(a._node.currentTime=t);var c=function(){h&&i.play(n,!0),i._emit("seek",n)};if(h&&!i._webAudio){var f=function t(){i._playLock?setTimeout(t,0):c()};setTimeout(f,0)}else c()}return i},playing:function(t){var e=this;if("number"==typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var i=0;i<e._sounds.length;i++)if(!e._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,i=e._soundById(t);return i&&(n=e._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,n=t._sounds,i=0;i<n.length;i++)n[i]._paused||t.stop(n[i]._id),t._webAudio||(t._clearSound(n[i]._node),n[i]._node.removeEventListener("error",n[i]._errorFn,!1),n[i]._node.removeEventListener(e._canPlayEvent,n[i]._loadFn,!1),n[i]._node.removeEventListener("ended",n[i]._endFn,!1),e._releaseHtml5Audio(n[i]._node)),delete n[i]._node,t._clearTimer(n[i]._id);var o=e._howls.indexOf(t);o>=0&&e._howls.splice(o,1);var s=!0;for(i=0;i<e._howls.length;i++)if(e._howls[i]._src===t._src||t._src.indexOf(e._howls[i]._src)>=0){s=!1;break}return r&&s&&delete r[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,i){var r=this["_on"+t];return"function"==typeof e&&r.push(i?{id:n,fn:e,once:i}:{id:n,fn:e}),this},off:function(t,e,n){var i=this,r=i["_on"+t],o=0;if("number"==typeof e&&(n=e,e=null),e||n)for(o=0;o<r.length;o++){var s=n===r[o].id;if(e===r[o].fn&&s||!e&&s){r.splice(o,1);break}}else if(t)i["_on"+t]=[];else{var a=Object.keys(i);for(o=0;o<a.length;o++)0===a[o].indexOf("_on")&&Array.isArray(i[a[o]])&&(i[a[o]]=[])}return i},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var i=this,r=i["_on"+t],o=r.length-1;o>=0;o--)r[o].id&&r[o].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(i,r[o].fn),0),r[o].once&&i.off(t,r[o].fn,r[o].id));return i._loadQueue(t),i},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var n=this,i=t._sprite;if(!n._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(n._ended.bind(n,t),100),n;var r=!(!t._loop&&!n._sprite[i][2]);if(n._emit("end",t._id),!n._webAudio&&r&&n.stop(t._id,!0).play(t._id),n._webAudio&&r){n._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var o=1e3*(t._stop-t._start)/Math.abs(t._rate);n._endTimers[t._id]=setTimeout(n._ended.bind(n,t),o)}return n._webAudio&&!r&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,n._clearTimer(t._id),n._cleanBuffer(t._node),e._autoSuspend()),n._webAudio||r||n.stop(t._id,!0),n},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!=typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new i(t)},_drain:function(){var t=this,e=t._pool,n=0,i=0;if(!(t._sounds.length<e)){for(i=0;i<t._sounds.length;i++)t._sounds[i]._ended&&n++;for(i=t._sounds.length-1;i>=0;i--){if(n<=e)return;t._sounds[i]._ended&&(t._webAudio&&t._sounds[i]._node&&t._sounds[i]._node.disconnect(0),t._sounds.splice(i,1),n--)}}},_getSoundIds:function(t){if(void 0===t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=r[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),this},_cleanBuffer:function(t){var n=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),n))try{t.bufferSource.buffer=e._scratchBuffer}catch(t){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(t){this._parent=t,this.init()};i.prototype={init:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,n._sounds.push(t),t.create(),t},create:function(){var t=this,n=t._parent,i=e._muted||t._muted||t._parent._muted?0:t._volume;return n._webAudio?(t._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(i,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):e.noAudio||(t._node=e._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=n._src,t._node.preload=!0===n._preload?"auto":n._preload,t._node.volume=i*e.volume(),t._node.load()),t},reset:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,n=t._parent;n._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(n._sprite).length&&(n._sprite={__default:[0,1e3*n._duration]}),"loaded"!==n._state&&(n._state="loaded",n._emit("load"),n._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var r={},o=function(t){var e=t._src;if(r[e])return t._duration=r[e].duration,void u(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);a(i.buffer,t)}else{var l=new XMLHttpRequest;l.open(t._xhr.method,e,!0),l.withCredentials=t._xhr.withCredentials,l.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){l.setRequestHeader(e,t._xhr.headers[e])})),l.onload=function(){var e=(l.status+"")[0];"0"===e||"2"===e||"3"===e?a(l.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+l.status+".")},l.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete r[e],t.load())},s(l)}},s=function(t){try{t.send()}catch(e){t.onerror()}},a=function(t,n){var i=function(){n._emit("loaderror",null,"Decoding audio data failed.")},o=function(t){t&&n._sounds.length>0?(r[n._src]=t,u(n,t)):i()};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(o).catch(i):e.ctx.decodeAudioData(t,o,i)},u=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},l=function(){if(e.usingWebAudio){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(t){e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),n=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=n?parseInt(n[1],10):null;if(t&&i&&i<9){var r=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!r&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};La.Howler=e,La.Howl=n,void 0!==v?(v.HowlerGlobal=t,v.Howler=e,v.Howl=n,v.Sound=i):"undefined"!=typeof window&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=i)}(),function(){var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var i=this;return i.ctx&&i.ctx.listener?(e="number"!=typeof e?i._pos[1]:e,n="number"!=typeof n?i._pos[2]:n,"number"!=typeof t?i._pos:(i._pos=[t,e,n],void 0!==i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(t,e,n,i,r,o){var s=this;if(!s.ctx||!s.ctx.listener)return s;var a=s._orientation;return e="number"!=typeof e?a[1]:e,n="number"!=typeof n?a[2]:n,i="number"!=typeof i?a[3]:i,r="number"!=typeof r?a[4]:r,o="number"!=typeof o?a[5]:o,"number"!=typeof t?a:(s._orientation=[t,e,n,i,r,o],void 0!==s.ctx.listener.forwardX?(s.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),s.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),s.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),s.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),s.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),s.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):s.ctx.listener.setOrientation(t,e,n,i,r,o),s)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:0,distanceModel:void 0!==e.distanceModel?e.distanceModel:"inverse",maxDistance:void 0!==e.maxDistance?e.maxDistance:1e4,panningModel:void 0!==e.panningModel?e.panningModel:"HRTF",refDistance:void 0!==e.refDistance?e.refDistance:1,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,n)}}),i;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var o=i._getSoundIds(n),s=0;s<o.length;s++){var a=i._soundById(o[s]);if(a){if("number"!=typeof t)return a._stereo;a._stereo=t,a._pos=[t,0,0],a._node&&(a._pannerAttr.panningModel="equalpower",a._panner&&a._panner.pan||e(a,r),"spatial"===r?void 0!==a._panner.positionX?(a._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),a._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),a._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):a._panner.setPosition(t,0,0):a._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",a._id)}}return i},Howl.prototype.pos=function(t,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(t,n,i,r)}}),o;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===r){if("number"!=typeof t)return o._pos;o._pos=[t,n,i]}for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if("number"!=typeof t)return u._pos;u._pos=[t,n,i],u._node&&(u._panner&&!u._panner.pan||e(u,"spatial"),void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setPosition(t,n,i)),o._emit("pos",u._id)}}return o},Howl.prototype.orientation=function(t,n,i,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(t,n,i,r)}}),o;if(n="number"!=typeof n?o._orientation[1]:n,i="number"!=typeof i?o._orientation[2]:i,void 0===r){if("number"!=typeof t)return o._orientation;o._orientation=[t,n,i]}for(var s=o._getSoundIds(r),a=0;a<s.length;a++){var u=o._soundById(s[a]);if(u){if("number"!=typeof t)return u._orientation;u._orientation=[t,n,i],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),e(u,"spatial")),void 0!==u._panner.orientationX?(u._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setOrientation(t,n,i)),o._emit("orientation",u._id)}}return o},Howl.prototype.pannerAttr=function(){var t,n,i,r=this,o=arguments;if(!r._webAudio)return r;if(0===o.length)return r._pannerAttr;if(1===o.length){if("object"!==p(o[0]))return(i=r._soundById(parseInt(o[0],10)))?i._pannerAttr:r._pannerAttr;t=o[0],void 0===n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==t.pannerAttr.refDistance?t.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==t.pannerAttr.panningModel?t.pannerAttr.panningModel:r._panningModel})}else 2===o.length&&(t=o[0],n=parseInt(o[1],10));for(var s=r._getSoundIds(n),a=0;a<s.length;a++)if(i=r._soundById(s[a])){var u=i._pannerAttr;u={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:u.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:u.maxDistance,refDistance:void 0!==t.refDistance?t.refDistance:u.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:u.rolloffFactor,panningModel:void 0!==t.panningModel?t.panningModel:u.panningModel};var l=i._panner;l?(l.coneInnerAngle=u.coneInnerAngle,l.coneOuterAngle=u.coneOuterAngle,l.coneOuterGain=u.coneOuterGain,l.distanceModel=u.distanceModel,l.maxDistance=u.maxDistance,l.refDistance=u.refDistance,l.rolloffFactor=u.rolloffFactor,l.panningModel=u.panningModel):(i._pos||(i._pos=r._pos||[0,0,-.5]),e(i,"spatial"))}return r},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,void 0!==t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),void 0!==t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}();var Ha={},Ya=null,Wa=0,Xa=[],Ka=function(t,e){if(Wa++>3)throw new Error("melonJS: failed loading "+t);Ha[t].load()};function qa(){return!Ga.Howler.noAudio}function Za(t,e,n,i){var r=[];if(0===Xa.length)throw new Error("target audio extension(s) should be set through me.audio.init() before calling the preloader.");if(!0===gr(t.src))r.push(t.src);else for(var o=0;o<Xa.length;o++)r.push(t.src+t.name+"."+Xa[o]+$h.nocache);return Ha[t.name]=new Ga.Howl({src:r,volume:Ga.Howler.volume(),html5:!0===e,xhrWithCredentials:$h.withCredentials,onloaderror:function(){Ka.call(this,t.name,i)},onload:function(){Wa=0,n&&n()}}),1}function Ja(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=Ha[t];if(r&&void 0!==r){var o=r.play();return"boolean"==typeof e&&r.loop(e,o),r.volume("number"==typeof i?Or(i,0,1):Ga.Howler.volume(),o),"function"==typeof n&&(!0===e?r.on("end",n,o):r.once("end",n,o)),o}throw new Error("audio clip "+t+" does not exist")}function Qa(){null!==Ya&&Ha[Ya].pause()}function $a(){null!==Ya&&Ha[Ya].play()}function tu(t,e,n){n=void 0===n||!!n;var i=Ha[t];if(!i||void 0===i)throw new Error("audio clip "+t+" does not exist");i.mute(n,e)}function eu(){Ga.Howler.mute(!0)}function nu(){Ga.Howler.mute(!1)}function iu(t){return t in Ha&&(Ha[t].unload(),delete Ha[t],!0)}function ru(){for(var t in Ha)Ha.hasOwnProperty(t)&&iu(t)}var ou=Object.freeze({__proto__:null,stopOnAudioError:!0,init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"mp3";return Xa=t.split(","),!Ga.Howler.noAudio},hasFormat:function(t){return qa()&&Ga.Howler.codecs(t)},hasAudio:qa,enable:function(){nu()},disable:function(){eu()},load:Za,play:Ja,fade:function(t,e,n,i,r){var o=Ha[t];if(!o||void 0===o)throw new Error("audio clip "+t+" does not exist");o.fade(e,n,i,r)},seek:function(t){var e=Ha[t];if(e&&void 0!==e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return e.seek.apply(e,i)}throw new Error("audio clip "+t+" does not exist")},rate:function(t){var e=Ha[t];if(e&&void 0!==e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return e.rate.apply(e,i)}throw new Error("audio clip "+t+" does not exist")},stop:function(t,e){if(void 0!==t){var n=Ha[t];if(!n||void 0===n)throw new Error("audio clip "+t+" does not exist");n.stop(e),n.off("end",void 0,e)}else Ga.Howler.stop()},pause:function(t,e){var n=Ha[t];if(!n||void 0===n)throw new Error("audio clip "+t+" does not exist");n.pause(e)},resume:function(t,e){var n=Ha[t];if(!n||void 0===n)throw new Error("audio clip "+t+" does not exist");n.play(e)},playTrack:function(t,e){return Ja(Ya=t,!0,null,e)},stopTrack:function(){null!==Ya&&(Ha[Ya].stop(),Ya=null)},pauseTrack:Qa,resumeTrack:$a,getCurrentTrack:function(){return Ya},setVolume:function(t){Ga.Howler.volume(t)},getVolume:function(){return Ga.Howler.volume()},mute:tu,unmute:function(t,e){tu(t,e,!1)},muteAll:eu,unmuteAll:nu,muted:function(){return Ga.Howler._muted},unload:iu,unloadAll:ru}),su=function(t){o(n,t);var e=a(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0;if(c(this,n),t=e.call(this,i,r),void 0===o)throw new Error("undefined `onUpdate` callback");return t.setCallback(o.onUpdate,o.scope),t}return d(n,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return this.setMuted(t,e),void 0!==n&&this.setCallback(n.onUpdate,n.scope),this}},{key:"x",get:function(){return this._x},set:function(t){var e=this.onUpdate.call(this.scope,t,this._y,this._x,this._y);this._x=e&&"x"in e?e.x:t}},{key:"y",get:function(){return this._y},set:function(t){var e=this.onUpdate.call(this.scope,this._x,t,this._x,this._y);this._y=e&&"y"in e?e.y:t}},{key:"_set",value:function(t,e){var n=this.onUpdate.call(this.scope,t,e,this._x,this._y);return n&&"x"in n&&"y"in n?(this._x=n.x,this._y=n.y):(this._x=t,this._y=e),this}},{key:"setMuted",value:function(t,e){return this._x=t,this._y=e,this}},{key:"setCallback",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("function"!=typeof t)throw new Error("invalid `onUpdate` callback");return this.onUpdate=t,this.scope=e,this}},{key:"add",value:function(t){return this._set(this._x+t.x,this._y+t.y)}},{key:"sub",value:function(t){return this._set(this._x-t.x,this._y-t.y)}},{key:"scale",value:function(t,e){return this._set(this._x*t,this._y*(void 0!==e?e:t))}},{key:"scaleV",value:function(t){return this._set(this._x*t.x,this._y*t.y)}},{key:"div",value:function(t){return this._set(this._x/t,this._y/t)}},{key:"abs",value:function(){return this._set(this._x<0?-this._x:this._x,this._y<0?-this._y:this._y)}},{key:"clamp",value:function(t,e){return new n(Or(this.x,t,e),Or(this.y,t,e),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"clampSelf",value:function(t,e){return this._set(Or(this._x,t,e),Or(this._y,t,e))}},{key:"minV",value:function(t){return this._set(this._x<t.x?this._x:t.x,this._y<t.y?this._y:t.y)}},{key:"maxV",value:function(t){return this._set(this._x>t.x?this._x:t.x,this._y>t.y?this._y:t.y)}},{key:"floor",value:function(){return new n(Math.floor(this._x),Math.floor(this._y),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"floorSelf",value:function(){return this._set(Math.floor(this._x),Math.floor(this._y))}},{key:"ceil",value:function(){return new n(Math.ceil(this._x),Math.ceil(this._y),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this._x),Math.ceil(this._y))}},{key:"negate",value:function(){return new n(-this._x,-this._y,{onUpdate:this.onUpdate,scope:this.scope})}},{key:"negateSelf",value:function(){return this._set(-this._x,-this._y)}},{key:"copy",value:function(t){return this._set(t.x,t.y)}},{key:"equals",value:function(t){return this._x===t.x&&this._y===t.y}},{key:"perp",value:function(){return this._set(this._y,-this._x)}},{key:"rotate",value:function(t,e){var n=0,i=0;"object"===p(e)&&(n=e.x,i=e.y);var r=this._x-n,o=this._y-i,s=Math.cos(t),a=Math.sin(t);return this._set(r*s-o*a+n,r*a+o*s+i)}},{key:"dot",value:function(t){return this._x*t.x+this._y*t.y}},{key:"cross",value:function(t){return this._x*t.y-this._y*t.x}},{key:"lerp",value:function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this}},{key:"distance",value:function(t){return Math.sqrt((this._x-t.x)*(this._x-t.x)+(this._y-t.y)*(this._y-t.y))}},{key:"clone",value:function(){return Gr.pull("ObservableVector2d",this._x,this._y,{onUpdate:this.onUpdate,scope:this.scope})}},{key:"toVector2d",value:function(){return Gr.pull("Vector2d",this._x,this._y)}},{key:"toString",value:function(){return"x:"+this._x+",y:"+this._y}}]),n}(Hr),au=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;c(this,t),this.onResetEvent(e,n,i)}return d(t,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.x=t,this.y=e,this.z=n,this}},{key:"_set",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.x=t,this.y=e,this.z=n,this}},{key:"set",value:function(t,e,n){if(t!==+t||e!==+e||void 0!==n&&n!==+n)throw new Error("invalid x, y, z parameters (not a number)");return this._set(t,e,n)}},{key:"setZero",value:function(){return this.set(0,0,0)}},{key:"setV",value:function(t){return this._set(t.x,t.y,t.z)}},{key:"add",value:function(t){return this._set(this.x+t.x,this.y+t.y,this.z+(t.z||0))}},{key:"sub",value:function(t){return this._set(this.x-t.x,this.y-t.y,this.z-(t.z||0))}},{key:"scale",value:function(t,e,n){return e=void 0!==e?e:t,this._set(this.x*t,this.y*e,this.z*(n||1))}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y,t.z)}},{key:"toIso",value:function(){return this._set(this.x-this.y,.5*(this.x+this.y),this.z)}},{key:"to2d",value:function(){return this._set(this.y+this.x/2,this.y-this.x/2,this.z)}},{key:"div",value:function(t){return this._set(this.x/t,this.y/t,this.z/t)}},{key:"abs",value:function(){return this._set(this.x<0?-this.x:this.x,this.y<0?-this.y:this.y,this.z<0?-this.z:this.z)}},{key:"clamp",value:function(e,n){return new t(Or(this.x,e,n),Or(this.y,e,n),Or(this.z,e,n))}},{key:"clampSelf",value:function(t,e){return this._set(Or(this.x,t,e),Or(this.y,t,e),Or(this.z,t,e))}},{key:"minV",value:function(t){var e=t.z||0;return this._set(this.x<t.x?this.x:t.x,this.y<t.y?this.y:t.y,this.z<e?this.z:e)}},{key:"maxV",value:function(t){var e=t.z||0;return this._set(this.x>t.x?this.x:t.x,this.y>t.y?this.y:t.y,this.z>e?this.z:e)}},{key:"floor",value:function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}},{key:"floorSelf",value:function(){return this._set(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))}},{key:"ceil",value:function(){return new t(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}},{key:"negate",value:function(){return new t(-this.x,-this.y,-this.z)}},{key:"negateSelf",value:function(){return this._set(-this.x,-this.y,-this.z)}},{key:"copy",value:function(t){return this._set(t.x,t.y,t.z||0)}},{key:"equals",value:function(){var t,e,n;return arguments.length>=2?(t=arguments[0],e=arguments[1],n=arguments[2]):(t=arguments[0].x,e=arguments[0].y,n=arguments[0].z),void 0===n&&(n=this.z),this.x===t&&this.y===e&&this.z===n}},{key:"normalize",value:function(){return this.div(this.length()||1)}},{key:"perp",value:function(){return this._set(this.y,-this.x,this.z)}},{key:"rotate",value:function(t,e){var n=0,i=0;"object"===p(e)&&(n=e.x,i=e.y);var r=this.x-n,o=this.y-i,s=Math.cos(t),a=Math.sin(t);return this._set(r*s-o*a+n,r*a+o*s+i,this.z)}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*(void 0!==t.z?t.z:this.z)}},{key:"cross",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z;return this.x=n*s-i*o,this.y=i*r-e*s,this.z=e*o-n*r,this}},{key:"length2",value:function(){return this.dot(this)}},{key:"length",value:function(){return Math.sqrt(this.length2())}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}},{key:"distance",value:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-(t.z||0);return Math.sqrt(e*e+n*n+i*i)}},{key:"angle",value:function(t){return Math.acos(Or(this.dot(t)/(this.length()*t.length()),-1,1))}},{key:"project",value:function(t){var e=this.dot(t)/t.length2();return this.scale(e,e,e)}},{key:"projectN",value:function(t){var e=this.dot(t)/t.length2();return this.scale(e,e,e)}},{key:"clone",value:function(){return Gr.pull("Vector3d",this.x,this.y,this.z)}},{key:"toString",value:function(){return"x:"+this.x+",y:"+this.y+",z:"+this.z}}]),t}(),uu=function(t){o(n,t);var e=a(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0;if(c(this,n),t=e.call(this,i,r,o),void 0===s)throw new Error("undefined `onUpdate` callback");return t.setCallback(s.onUpdate,s.scope),t}return d(n,[{key:"onResetEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;return this.setMuted(t,e,n),void 0!==i&&this.setCallback(i.onUpdate,i.scope),this}},{key:"x",get:function(){return this._x},set:function(t){var e=this.onUpdate.call(this.scope,t,this._y,this._z,this._x,this._y,this._z);this._x=e&&"x"in e?e.x:t}},{key:"y",get:function(){return this._y},set:function(t){var e=this.onUpdate.call(this.scope,this._x,t,this._z,this._x,this._y,this._z);this._y=e&&"y"in e?e.y:t}},{key:"z",get:function(){return this._z},set:function(t){var e=this.onUpdate.call(this.scope,this._x,this._y,t,this._x,this._y,this._z);this._z=e&&"z"in e?e.z:t}},{key:"_set",value:function(t,e,n){var i=this.onUpdate.call(this.scope,t,e,n,this._x,this._y,this._z);return i&&"x"in i&&"y"in i&&"z"in i?(this._x=i.x,this._y=i.y,this._z=i.z):(this._x=t,this._y=e,this._z=n||0),this}},{key:"setMuted",value:function(t,e,n){return this._x=t,this._y=e,this._z=n||0,this}},{key:"setCallback",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("function"!=typeof t)throw new Error("invalid `onUpdate` callback");return this.onUpdate=t,this.scope=e,this}},{key:"add",value:function(t){return this._set(this._x+t.x,this._y+t.y,this._z+(t.z||0))}},{key:"sub",value:function(t){return this._set(this._x-t.x,this._y-t.y,this._z-(t.z||0))}},{key:"scale",value:function(t,e,n){return e=void 0!==e?e:t,this._set(this._x*t,this._y*e,this._z*(n||1))}},{key:"scaleV",value:function(t){return this._set(this._x*t.x,this._y*t.y,this._z*(t.z||1))}},{key:"div",value:function(t){return this._set(this._x/t,this._y/t,this._z/t)}},{key:"abs",value:function(){return this._set(this._x<0?-this._x:this._x,this._y<0?-this._y:this._y,this._Z<0?-this._z:this._z)}},{key:"clamp",value:function(t,e){return new n(Or(this._x,t,e),Or(this._y,t,e),Or(this._z,t,e),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"clampSelf",value:function(t,e){return this._set(Or(this._x,t,e),Or(this._y,t,e),Or(this._z,t,e))}},{key:"minV",value:function(t){var e=t.z||0;return this._set(this._x<t.x?this._x:t.x,this._y<t.y?this._y:t.y,this._z<e?this._z:e)}},{key:"maxV",value:function(t){var e=t.z||0;return this._set(this._x>t.x?this._x:t.x,this._y>t.y?this._y:t.y,this._z>e?this._z:e)}},{key:"floor",value:function(){return new n(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"floorSelf",value:function(){return this._set(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))}},{key:"ceil",value:function(){return new n(Math.ceil(this._x),Math.ceil(this._y),Math.ceil(this._z),{onUpdate:this.onUpdate,scope:this.scope})}},{key:"ceilSelf",value:function(){return this._set(Math.ceil(this._x),Math.ceil(this._y),Math.ceil(this._z))}},{key:"negate",value:function(){return new n(-this._x,-this._y,-this._z,{onUpdate:this.onUpdate,scope:this.scope})}},{key:"negateSelf",value:function(){return this._set(-this._x,-this._y,-this._z)}},{key:"copy",value:function(t){return this._set(t.x,t.y,t.z||0)}},{key:"equals",value:function(t){return this._x===t.x&&this._y===t.y&&this._z===(t.z||this._z)}},{key:"perp",value:function(){return this._set(this._y,-this._x,this._z)}},{key:"rotate",value:function(t,e){var n=0,i=0;"object"===p(e)&&(n=e.x,i=e.y);var r=this.x-n,o=this.y-i,s=Math.cos(t),a=Math.sin(t);return this._set(r*s-o*a+n,r*a+o*s+i,this.z)}},{key:"dot",value:function(t){return this._x*t.x+this._y*t.y+this._z*(t.z||1)}},{key:"cross",value:function(t){var e=this._x,n=this._y,i=this._z,r=t.x,o=t.y,s=t.z;return this._set(n*s-i*o,i*r-e*s,e*o-n*r)}},{key:"lerp",value:function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this._z+=(t.z-this._z)*e,this}},{key:"distance",value:function(t){var e=this._x-t.x,n=this._y-t.y,i=this._z-(t.z||0);return Math.sqrt(e*e+n*n+i*i)}},{key:"clone",value:function(){return Gr.pull("ObservableVector3d",this._x,this._y,this._z,{onUpdate:this.onUpdate})}},{key:"toVector3d",value:function(){return Gr.pull("Vector3d",this._x,this._y,this._z)}},{key:"toString",value:function(){return"x:"+this._x+",y:"+this._y+",z:"+this._z}}]),n}(au),lu={},hu={},cu={},fu={},du={},pu={},vu=function(t,e,n){e=e||t.keyCode||t.button;var i=pu[e];if(Do(_o,i,e,!i||!cu[i]),i){if(!cu[i]){var r=void 0!==n?n:e;fu[i][r]||(lu[i]++,fu[i][r]=!0)}return!du[e]||"function"!=typeof t.preventDefault||t.preventDefault()}return!0},yu=function(t,e,n){e=e||t.keyCode||t.button;var i=pu[e];if(Do(ko,i,e),i){var r=void 0!==n?n:e;return fu[i][r]=void 0,lu[i]>0&&lu[i]--,cu[i]=!1,!du[e]||"function"!=typeof t.preventDefault||t.preventDefault()}return!0},gu=null;function mu(){null===gu&&!1===as&&"function"==typeof(gu=globalThis).addEventListener&&(gu.addEventListener("keydown",vu,!1),gu.addEventListener("keyup",yu,!1))}function bu(t,e,n){!0===e?vu({},t,n):yu({},t,n)}function xu(t){return pu[t]}var wu,_u=new Hr,ku=function(t){o(n,t);var e=a(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return c(this,n),(t=e.call(this)).setMinMax(i,r,i+o,r+s),t.LEFT=0,t.MIDDLE=1,t.RIGHT=2,t.event=void 0,t.type=void 0,t.button=0,t.isPrimary=!1,t.pageX=0,t.pageY=0,t.clientX=0,t.clientY=0,t.movementX=0,t.movementY=0,t.deltaMode=0,t.deltaX=0,t.deltaY=0,t.deltaZ=0,t.gameX=0,t.gameY=0,t.gameScreenX=0,t.gameScreenY=0,t.gameWorldX=0,t.gameWorldY=0,t.gameLocalX=0,t.gameLocalY=0,t.pointerId=void 0,t.isNormalized=!1,t.locked=!1,t.bind=[0,0,0],t}return d(n,[{key:"setEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;this.event=t,this.pageX=e,this.pageY=n,this.clientX=i,this.clientY=r,tl(this.pageX,this.pageY,_u),this.gameScreenX=this.x=_u.x,this.gameScreenY=this.y=_u.y,this.isNormalized=void 0!==globalThis.PointerEvent&&!(t instanceof globalThis.PointerEvent),this.locked=$u,this.movementX=t.movementX||0,this.movementY=t.movementY||0,"wheel"===t.type?(this.deltaMode=t.deltaMode||0,this.deltaX=t.deltaX||0,this.deltaY=t.deltaY||0,this.deltaZ=t.deltaZ||0):(this.deltaMode=0,this.deltaX=0,this.deltaY=0,this.deltaZ=0),this.pointerId=o,this.isPrimary=void 0===t.isPrimary||t.isPrimary,this.button=t.button||0,this.type=t.type,void 0!==Ul.viewport&&Ul.viewport.localToWorld(this.gameScreenX,this.gameScreenY,_u),this.gameWorldX=_u.x,this.gameWorldY=_u.y,!1===this.isNormalized?(this.width=t.width||1,this.height=t.height||1):"number"==typeof t.radiusX?(this.width=2*t.radiusX||1,this.height=2*t.radiusY||1):this.width=this.height=1}}]),n}(za),Tu=[],Eu=new Map,Su=!1,Au=0,Pu=[],Ou=["wheel"],Cu=["pointermove","mousemove","touchmove"],Mu=["pointerdown","mousedown","touchstart"],Ru=["pointerup","mouseup","touchend"],Iu=["pointercancel","mousecancel","touchcancel"],Lu=["pointerenter","mouseenter","touchenter"],ju=["pointerover","mouseover","touchover"],Bu=["pointerleave","mouseleave","touchleave"],Du=[Ou[0],Cu[0],Mu[0],Ru[0],Iu[0],Lu[0],ju[0],Bu[0]],Fu=[Ou[0],Cu[1],Mu[1],Ru[1],Iu[1],Lu[1],ju[1],Bu[1]],Nu=[Cu[2],Mu[2],Ru[2],Iu[2],Lu[2],ju[2],Bu[2]],zu={wheel:Ou,pointermove:Cu,pointerdown:Mu,pointerup:Ru,pointercancel:Iu,pointerenter:Lu,pointerover:ju,pointerleave:Bu},Uu=[];function Vu(){if(!Su){wu=new Ba(0,0,1,1);for(var t=0;t<bs;t++)Tu.push(new ku);var e;null===Ju&&(Ju=Pc.getScreenCanvas()),Pu=gs?Du:Fu,ms&&!gs&&(Pu=Pu.concat(Nu)),function(t,e){for(var n=0;n<t.length;n++)-1===Cu.indexOf(t[n])&&Ju.addEventListener(t[n],e,{passive:!1===vl})}(Pu,qu),void 0===Zu&&(Zu=~~(1e3/Fc.maxfps)),Js(),Ju.addEventListener(Pu[2],(function(){Js()}),{passive:!1===vl});var n=Hu(Pu,Cu);if(Zu<17)for(e=0;e<n.length;e++)-1!==Pu.indexOf(n[e])&&Ju.addEventListener(n[e],Ku,{passive:!0});else for(e=0;e<n.length;e++)-1!==Pu.indexOf(n[e])&&Ju.addEventListener(n[e],Ur(Ku,Zu,!1),{passive:!0});el(Ju),ws&&document.addEventListener("pointerlockchange",(function(){$u=document.pointerLockElement===Cc(),Do(Po,$u)}),!0),Su=!0}}function Gu(t,e){for(var n=0;n<e.length;n++)if(-1!==t.indexOf(e[n]))return e[n]}function Hu(t,e){for(var n=[],i=0;i<e.length;i++)-1!==t.indexOf(e[i])&&n.push(e[i]);return n}function Yu(t,e,n,i){var r;if(t.callbacks[e]){t.pointerId=i;for(var o=t.callbacks[e].length-1;o>=0&&(r=t.callbacks[e][o]);o--)if(!1===r(n))return!0}return!1}function Wu(t){for(var e=!1;t.length>0;){var n=t.pop();if(Tu.push(n),!0===n.isNormalized&&void 0!==n.event.timeStamp){if(n.event.timeStamp<Au)continue;Au=n.event.timeStamp}wu.setShape(n.gameWorldX,n.gameWorldY,n.width,n.height),Cu.includes(n.type)&&(n.gameX=n.gameLocalX=n.gameScreenX,n.gameY=n.gameLocalY=n.gameScreenY,Do(Ao,n));for(var i,r=Ul.world.broadphase.retrieve(wu,jl.prototype._sortReverseZ),o=(r=r.concat([Ul.viewport])).length;i=r[--o];){if(Eu.has(i)&&!0!==i.isKinematic){var s,a=Eu.get(i),u=a.region,l=u.ancestor,h=u.getBounds();if(!0===u.isFloating?(n.gameX=n.gameLocalX=n.gameScreenX,n.gameY=n.gameLocalY=n.gameScreenY):(n.gameX=n.gameLocalX=n.gameWorldX,n.gameY=n.gameLocalY=n.gameWorldY),void 0!==l){var c=l.getBounds();n.gameLocalX=n.gameX-c.x,n.gameLocalY=n.gameY-c.y}var f=n.gameX,d=n.gameY;if(void 0!==u.currentTransform&&!u.currentTransform.isIdentity()){var p=u.currentTransform.applyInverse(Gr.pull("Vector2d",f,d));f=p.x,d=p.y,Gr.push(p)}switch(s=h.contains(f,d),n.type){case Cu[0]:case Cu[1]:case Cu[2]:case Cu[3]:if(a.pointerId!==n.pointerId||s){if(null===a.pointerId&&s&&Yu(a,Gu(Pu,Lu),n,n.pointerId)){e=!0;break}}else if(Yu(a,Gu(Pu,Bu),n,null)){e=!0;break}if(s&&Yu(a,n.type,n,n.pointerId)){e=!0;break}break;case Ru[0]:case Ru[1]:case Ru[2]:case Ru[3]:if(a.pointerId===n.pointerId&&s&&Yu(a,n.type,n,null)){e=!0;break}break;case Iu[0]:case Iu[1]:case Iu[2]:case Iu[3]:if(a.pointerId===n.pointerId&&Yu(a,n.type,n,null)){e=!0;break}break;default:if(s&&Yu(a,n.type,n,n.pointerId)){e=!0;break}}}if(!0===e)break}}return e}function Xu(t){var e;if(ys&&t.changedTouches)for(var n=0,i=t.changedTouches.length;n<i;n++){var r=t.changedTouches[n];(e=Tu.pop()).setEvent(t,r.pageX,r.pageY,r.clientX,r.clientY,r.identifier),Uu.push(e)}else(e=Tu.pop()).setEvent(t,t.pageX,t.pageY,t.clientX,t.clientY,t.pointerId),Uu.push(e);return!1===t.isPrimary||(Uu[0].isPrimary=!0,Object.assign(Qu,Uu[0])),Uu}function Ku(t){Wu(Xu(t))}function qu(t){Xu(t);var e=Uu[0].button;(Wu(Uu)||"wheel"===t.type)&&t.preventDefault();var n=Qu.bind[e];n&&bu(n,Mu.includes(t.type),e+1)}var Zu,Ju=null,Qu=new ku(0,0,1,1),$u=!1;function tl(t,e,n){n=n||Gr.pull("Vector2d");var i=Xs(Pc.getScreenCanvas()),r=globalThis.devicePixelRatio||1;t-=i.left+(globalThis.pageXOffset||0),e-=i.top+(globalThis.pageYOffset||0);var o=Ac;return 1===o.x&&1===o.y||(t/=o.x,e/=o.y),n.set(t*r,e*r)}function el(t,e){t.style["touch-action"]=e||"none"}function nl(t,e,n){if(Vu(),-1===Du.indexOf(t))throw new Error("invalid event type : "+t);if(void 0===e)throw new Error("registerPointerEvent: region for "+toString(e)+" event is undefined ");var i=Hu(Pu,zu[t]);Eu.has(e)||Eu.set(e,{region:e,callbacks:{},pointerId:null});for(var r=Eu.get(e),o=0;o<i.length;o++)t=i[o],r.callbacks[t]?r.callbacks[t].push(n):r.callbacks[t]=[n]}function il(t,e,n){if(-1===Du.indexOf(t))throw new Error("invalid event type : "+t);var i=Hu(Pu,zu[t]),r=Eu.get(e);if(void 0!==r){for(var o=0;o<i.length;o++)if(t=i[o],r.callbacks[t]){if(void 0!==n)Ir(r.callbacks[t],n);else for(;r.callbacks[t].length>0;)r.callbacks[t].pop();0===r.callbacks[t].length&&delete r.callbacks[t]}0===Object.keys(r.callbacks).length&&Eu.delete(e)}}function rl(t){if(Eu.has(t))for(var e=0;e<Du.length;e++)il(Du[e],t)}var ol=.1;function sl(t,e,n){return t>0?n===this.GAMEPAD.BUTTONS.L2?Math.max(0,t-2e4)/111070:(t-1)/131070:(65536+t)/131070+.5}var al=/^([0-9a-f]{1,4})-([0-9a-f]{1,4})-/i,ul=/^0+/;function ll(t,e){var n=t.replace(al,(function(t,e,n){return"000".slice(e.length-1)+e+"-"+"000".slice(n.length-1)+n+"-"})),i=t.replace(al,(function(t,e,n){return e.replace(ul,"")+"-"+n.replace(ul,"")+"-"}));e.analog=e.analog||e.buttons.map((function(){return-1})),e.normalize_fn=e.normalize_fn||function(t){return t},fl.set(n,e),fl.set(i,e)}var hl,cl={},fl=new Map;[["45e-28e-Xbox 360 Wired Controller",{axes:[0,1,3,4],buttons:[11,12,13,14,8,9,-1,-1,5,4,6,7,0,1,2,3,10],analog:[-1,-1,-1,-1,-1,-1,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:function(t,e,n){return n===this.GAMEPAD.BUTTONS.L2||n===this.GAMEPAD.BUTTONS.R2?(t+1)/2:t}}],["54c-268-PLAYSTATION(R)3 Controller",{axes:[0,1,2,3],buttons:[14,13,15,12,10,11,8,9,0,3,1,2,4,6,7,5,16]}],["54c-5c4-Wireless Controller",{axes:[0,1,2,3],buttons:[1,0,2,3,4,5,6,7,8,9,10,11,14,15,16,17,12,13]}],["2836-1-OUYA Game Controller",{axes:[0,3,7,9],buttons:[3,6,4,5,7,8,15,16,-1,-1,9,10,11,12,13,14,-1],analog:[-1,-1,-1,-1,-1,-1,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:sl}],["OUYA Game Controller (Vendor: 2836 Product: 0001)",{axes:[0,1,3,4],buttons:[0,3,1,2,4,5,12,13,-1,-1,6,7,8,9,10,11,-1],analog:[-1,-1,-1,-1,-1,-1,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:sl}]].forEach((function(t){ll(t[0],t[1])}));var dl=function(){var t=navigator.getGamepads();Object.keys(cl).forEach((function(e){var n=t[e];if(n){var i=null;"standard"!==n.mapping&&(i=fl.get(n.id));var r=cl[e];Object.keys(r.buttons).forEach((function(t){var o=r.buttons[t],s=t,a=-1;if(!(i&&(s=i.buttons[t],a=i.analog[t],s<0&&a<0))){var u=n.buttons[s]||{};if(i&&a>=0){var l=i.normalize_fn(n.axes[a],-1,+t);u={value:l,pressed:u.pressed||Math.abs(l)>=ol}}Do(So,e,"buttons",+t,u),!o.pressed&&u.pressed?bu(o.keyCode,!0,s+256):o.pressed&&!u.pressed&&bu(o.keyCode,!1,s+256),o.value=u.value,o.pressed=u.pressed}})),Object.keys(r.axes).forEach((function(t){var o=r.axes[t],s=t;if(!(i&&(s=i.axes[t])<0)){var a=n.axes[s];if(void 0!==a){i&&(a=i.normalize_fn(a,+t,-1));var u=Math.sign(a)||1;if(0!==o[u].keyCode){var l=Math.abs(a)>=ol+Math.abs(o[u].threshold);Do(So,e,"axes",+t,a),!o[u].pressed&&l?(o[-u].pressed&&(bu(o[-u].keyCode,!1,s+256),o[-u].value=0,o[-u].pressed=!1),bu(o[u].keyCode,!0,s+256)):!o[u].pressed&&!o[-u].pressed||l||bu(o[u=o[u].pressed?u:-u].keyCode,!1,s+256),o[u].value=a,o[u].pressed=l}}}}))}}))};globalThis.navigator&&"function"==typeof globalThis.navigator.getGamepads&&(globalThis.addEventListener("gamepadconnected",(function(t){Do(To,t.gamepad)}),!1),globalThis.addEventListener("gamepaddisconnected",(function(t){Do(Eo,t.gamepad)}),!1));for(var pl=ll,vl=!0,yl=Object.freeze({__proto__:null,preventDefault:vl,get pointerEventTarget(){return Ju},pointer:Qu,get locked(){return $u},get throttlingInterval(){return Zu},globalToLocal:tl,setTouchAction:el,bindPointer:function(){var t=arguments.length<2?Qu.LEFT:arguments[0],e=arguments.length<2?arguments[0]:arguments[1];if(Vu(),!xu(e))throw new Error("no action defined for keycode "+e);Qu.bind[t]=e},unbindPointer:function(t){Qu.bind[void 0===t?Qu.LEFT:t]=null},registerPointerEvent:nl,releasePointerEvent:il,releaseAllPointerEvents:rl,requestPointerLock:function(){return!!ws&&(Cc().requestPointerLock(),!0)},exitPointerLock:function(){return!!ws&&(document.exitPointerLock(),!0)},get keyBoardEventTarget(){return gu},KEY:{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,WINDOW_KEY:91,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,TILDE:126,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWAND_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},initKeyboardEvent:mu,isKeyPressed:function(t){return!(!lu[t]||cu[t]||(hu[t]&&(cu[t]=!0),0))},keyStatus:function(t){return lu[t]>0},triggerKeyEvent:bu,bindKey:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:vl;pu[t]=e,du[t]=i,lu[e]=0,hu[e]=n||!1,cu[e]=!1,fu[e]={}},getBindingKey:xu,unlockKey:function(t){cu[t]=!1},unbindKey:function(t){var e=pu[t];lu[e]=0,hu[e]=!1,fu[e]={},pu[t]=null,du[t]=null},GAMEPAD:{AXES:{LX:0,LY:1,RX:2,RY:3,EXTRA_1:4,EXTRA_2:5,EXTRA_3:6,EXTRA_4:7},BUTTONS:{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L1:4,R1:5,L2:6,R2:7,SELECT:8,BACK:8,START:9,FORWARD:9,L3:10,R3:11,UP:12,DOWN:13,LEFT:14,RIGHT:15,HOME:16,EXTRA_1:17,EXTRA_2:18,EXTRA_3:19,EXTRA_4:20}},bindGamepad:function(t,e,n){if(!xu(n))throw new Error("no action defined for keycode "+n);void 0===hl&&"function"==typeof navigator.getGamepads&&(hl=Fo(po,dl)),cl[t]||(cl[t]={axes:{},buttons:{}});var i={keyCode:n,value:0,pressed:!1,threshold:e.threshold},r=cl[t][e.type];if("buttons"===e.type)r[e.code]=i;else if("axes"===e.type){var o=Math.sign(e.threshold)||1;r[e.code]||(r[e.code]={});var s=r[e.code];s[o]=i,s[-o]||(s[-o]={keyCode:0,value:0,pressed:!1,threshold:-o})}},unbindGamepad:function(t,e){if(!cl[t])throw new Error("no bindings for gamepad "+t);cl[t].buttons[e]={}},setGamepadDeadzone:function(t){ol=t},setGamepadMapping:pl}),gl=function(t){o(n,t);var e=a(n);function n(t,i,r,o){var s;return c(this,n),(s=e.call(this,t,i,r,o)).isRenderable=!0,s.isKinematic=!0,s.body=void 0,void 0===s.currentTransform&&(s.currentTransform=Gr.pull("Matrix2d")),s.currentTransform.identity(),s.GUID=void 0,s.onVisibilityChange=void 0,s.alwaysUpdate=!1,s.updateWhenPaused=!1,s.isPersistent=!1,s.floating=!1,s.anchorPoint instanceof su?s.anchorPoint.setMuted(.5,.5).setCallback(s.onAnchorUpdate,l(s)):s.anchorPoint=Gr.pull("ObservableVector2d",.5,.5,{onUpdate:s.onAnchorUpdate,scope:l(s)}),s.autoTransform=!0,s.alpha=1,s.ancestor=void 0,s.mask=void 0,s.tint=Gr.pull("Color",255,255,255,1),s.blendMode="normal",s.name="",s.pos instanceof uu?s.pos.setMuted(t,i,0).setCallback(s.updateBoundsPos,l(s)):s.pos=Gr.pull("ObservableVector3d",t,i,0,{onUpdate:s.updateBoundsPos,scope:l(s)}),s.isDirty=!1,s._flip={x:!1,y:!1},s._inViewport=!1,s.setOpacity(1),s}return d(n,[{key:"isFloating",get:function(){return!0===this.floating||void 0!==this.ancestor&&!0===this.ancestor.floating}},{key:"inViewport",get:function(){return this._inViewport},set:function(t){this._inViewport!==t&&(this._inViewport=t,"function"==typeof this.onVisibilityChange&&this.onVisibilityChange.call(this,t))}},{key:"isFlippedX",get:function(){return!0===this._flip.x}},{key:"isFlippedY",get:function(){return!0===this._flip.y}},{key:"getBounds",value:function(){return void 0===this._bounds&&(i(h(n.prototype),"getBounds",this).call(this),this.isFinite()?this._bounds.setMinMax(this.pos.x,this.pos.y,this.pos.x+this.width,this.pos.y+this.height):this._bounds.setMinMax(this.pos.x,this.pos.y,this.width,this.height)),this._bounds}},{key:"getOpacity",value:function(){return this.alpha}},{key:"setOpacity",value:function(t){"number"==typeof t&&(this.alpha=Or(t,0,1),isNaN(this.alpha)&&(this.alpha=1),this.isDirty=!0)}},{key:"flipX",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._flip.x=!!t,this.isDirty=!0,this}},{key:"flipY",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._flip.y=!!t,this.isDirty=!0,this}},{key:"transform",value:function(t){return this.currentTransform.multiply(t),this.updateBoundsPos(this.pos.x,this.pos.y),this.isDirty=!0,this}},{key:"angleTo",value:function(t){var e,i,r=this.getBounds();if(t instanceof n){var o=t.getBounds();e=o.centerX-r.centerX,i=o.centerY-r.centerY}else e=t.x-r.centerX,i=t.y-r.centerY;return Math.atan2(i,e)}},{key:"distanceTo",value:function(t){var e,i,r=this.getBounds();if(t instanceof n){var o=t.getBounds();e=r.centerX-o.centerX,i=r.centerY-o.centerY}else e=r.centerX-t.x,i=r.centerY-t.y;return Math.sqrt(e*e+i*i)}},{key:"lookAt",value:function(t){var e;e=t instanceof n?t.pos:t;var i=this.angleTo(e);return this.rotate(i),this}},{key:"rotate",value:function(t,e){return isNaN(t)||(this.currentTransform.rotate(t,e),this.isDirty=!0),this}},{key:"scale",value:function(t,e){return this.currentTransform.scale(t,e),i(h(n.prototype),"scale",this).call(this,t,e),this.isDirty=!0,this}},{key:"scaleV",value:function(t){return this.scale(t.x,t.y),this}},{key:"update",value:function(t){return this.isDirty}},{key:"updateBounds",value:function(){return i(h(n.prototype),"updateBounds",this).call(this),this.updateBoundsPos(this.pos.x,this.pos.y),this.getBounds()}},{key:"updateBoundsPos",value:function(t,e){var n=this.getBounds();n.shift(t,e),void 0!==this.anchorPoint&&n.isFinite()&&n.translate(-this.anchorPoint.x*n.width,-this.anchorPoint.y*n.height),this.ancestor instanceof jl&&!0!==this.floating&&n.translate(this.ancestor.getAbsolutePosition()),this.isDirty=!0}},{key:"getAbsolutePosition",value:function(){return void 0===this._absPos&&(this._absPos=Gr.pull("Vector2d")),this._absPos.set(this.pos.x,this.pos.y),this.ancestor instanceof jl&&!0!==this.floating&&this._absPos.add(this.ancestor.getAbsolutePosition()),this._absPos}},{key:"onAnchorUpdate",value:function(t,e){this.anchorPoint.setMuted(t,e),this.updateBoundsPos(this.pos.x,this.pos.y)}},{key:"preDraw",value:function(t){var e=this.getBounds(),n=e.width*this.anchorPoint.x,i=e.height*this.anchorPoint.y;if(t.save(),t.setGlobalAlpha(t.globalAlpha()*this.getOpacity()),this._flip.x||this._flip.y){var r=this._flip.x?this.centerX-n:0,o=this._flip.y?this.centerY-i:0;t.translate(r,o),t.scale(this._flip.x?-1:1,this._flip.y?-1:1),t.translate(-r,-o)}void 0!==this.mask&&(t.translate(this.pos.x,this.pos.y),t.setMask(this.mask),t.translate(-this.pos.x,-this.pos.y)),!0!==this.autoTransform||this.currentTransform.isIdentity()||(t.translate(this.pos.x,this.pos.y),t.transform(this.currentTransform),t.translate(-this.pos.x,-this.pos.y)),t.translate(-n,-i),t.setTint(this.tint,this.getOpacity()),this.blendMode!==t.getBlendMode()&&t.setBlendMode(this.blendMode)}},{key:"draw",value:function(t,e){}},{key:"postDraw",value:function(t){t.clearTint(),void 0!==this.mask&&t.clearMask(),t.restore(),this.isDirty=!1}},{key:"onCollision",value:function(t,e){return!1}},{key:"destroy",value:function(){Gr.push(this.currentTransform),this.currentTransform=void 0,Gr.push(this.anchorPoint),this.anchorPoint=void 0,Gr.push(this.pos),this.pos=void 0,void 0!==this._absPos&&(Gr.push(this._absPos),this._absPos=void 0),Gr.push(this._bounds),this._bounds=void 0,this.onVisibilityChange=void 0,void 0!==this.mask&&(Gr.push(this.mask),this.mask=void 0),void 0!==this.tint&&(Gr.push(this.tint),this.tint=void 0),this.ancestor=void 0,void 0!==this.body&&(this.body.destroy.apply(this.body,arguments),this.body=void 0),rl(this),this.onDestroyEvent.apply(this,arguments)}},{key:"onDestroyEvent",value:function(){}}]),n}(Ba),ml=[],bl=0;bl<10;bl++)ml.push(new Hr);for(var xl=[],wl=0;wl<5;wl++)xl.push([]);function _l(t,e,n){for(var i=Number.MAX_VALUE,r=-Number.MAX_VALUE,o=t.length,s=0;s<o;s++){var a=t[s].dot(e);a<i&&(i=a),a>r&&(r=a)}n[0]=i,n[1]=r}function kl(t,e,n,i,r,o){var s=xl.pop(),a=xl.pop(),u=ml.pop().copy(e).sub(t),l=u.dot(r);if(_l(n,r,s),_l(i,r,a),a[0]+=l,a[1]+=l,s[0]>a[1]||a[0]>s[1])return ml.push(u),xl.push(s),xl.push(a),!0;if(o){var h=0;if(s[0]<a[0])if(o.aInB=!1,s[1]<a[1])h=s[1]-a[0],o.bInA=!1;else{var c=s[1]-a[0],f=a[1]-s[0];h=c<f?c:-f}else if(o.bInA=!1,s[1]>a[1])h=s[0]-a[1],o.aInB=!1;else{var d=s[1]-a[0],p=a[1]-s[0];h=d<p?d:-p}var v=Math.abs(h);v<o.overlap&&(o.overlap=v,o.overlapN.copy(r),h<0&&o.overlapN.negateSelf())}return ml.push(u),xl.push(s),xl.push(a),!1}function Tl(t,e){var n=t.length2(),i=e.dot(t);return i<0?-1:i>n?1:0}function El(t,e,n,i,r){for(var o=ml.pop().copy(n.pos).add(n.ancestor.getAbsolutePosition()).add(i.pos).sub(t.pos).add(t.ancestor.getAbsolutePosition()).sub(e.pos),s=i.radius,a=s*s,u=e.points,l=e.edges,h=l.length,c=ml.pop(),f=ml.pop(),d=ml.pop(),p=0,v=0;v<h;v++){var y=v===h-1?0:v+1,g=0===v?h-1:v-1,m=0,b=null;c.copy(l[v]),d.copy(o).sub(u[v]),r&&d.length2()>a&&(r.aInB=!1);var x=Tl(c,d),w=!0;if(-1===x){var _=null;if(h>1&&(c.copy(l[g]),1!==(x=Tl(c,_=ml.pop().copy(o).sub(u[g])))&&(w=!1)),w){if((p=d.length())>s)return ml.push(o),ml.push(c),ml.push(f),ml.push(d),_&&ml.push(_),!1;r&&(r.bInA=!1,b=d.normalize(),m=s-p)}_&&ml.push(_)}else if(1===x){if(h>1&&(c.copy(l[y]),d.copy(o).sub(u[y]),-1!==(x=Tl(c,d))&&(w=!1)),w){if((p=d.length())>s)return ml.push(o),ml.push(c),ml.push(f),ml.push(d),!1;r&&(r.bInA=!1,b=d.normalize(),m=s-p)}}else{f.copy(e.normals[v]),p=d.dot(f);var k=Math.abs(p);if((1===h||p>0)&&k>s)return ml.push(o),ml.push(c),ml.push(f),ml.push(d),!1;r&&(b=f,m=s-p,(p>=0||m<2*s)&&(r.bInA=!1))}b&&r&&Math.abs(m)<Math.abs(r.overlap)&&(r.overlap=m,r.overlapN.copy(b))}return r&&(r.a=t,r.b=n,r.overlapV.copy(r.overlapN).scale(r.overlap)),ml.push(o),ml.push(c),ml.push(f),ml.push(d),!0}var Sl=Object.freeze({__proto__:null,testPolygonPolygon:function(t,e,n,i,r){var o,s=e.points,a=e.normals,u=a.length,l=i.points,h=i.normals,c=h.length,f=ml.pop().copy(t.pos).add(t.ancestor.getAbsolutePosition()).add(e.pos),d=ml.pop().copy(n.pos).add(n.ancestor.getAbsolutePosition()).add(i.pos);for(o=0;o<u;o++)if(kl(f,d,s,l,a[o],r))return ml.push(f),ml.push(d),!1;for(o=0;o<c;o++)if(kl(f,d,s,l,h[o],r))return ml.push(f),ml.push(d),!1;return r&&(r.a=t,r.b=n,r.overlapV.copy(r.overlapN).scale(r.overlap)),ml.push(f),ml.push(d),!0},testEllipseEllipse:function(t,e,n,i,r){var o=ml.pop().copy(n.pos).add(n.ancestor.getAbsolutePosition()).add(i.pos).sub(t.pos).add(t.ancestor.getAbsolutePosition()).sub(e.pos),s=e.radius,a=i.radius,u=s+a,l=u*u,h=o.length2();if(h>l)return ml.push(o),!1;if(r){var c=Math.sqrt(h);r.a=t,r.b=n,r.overlap=u-c,r.overlapN.copy(o.normalize()),r.overlapV.copy(o).scale(r.overlap),r.aInB=s<=a&&c<=a-s,r.bInA=a<=s&&c<=s-a}return ml.push(o),!0},testPolygonEllipse:El,testEllipsePolygon:function(t,e,n,i,r){var o=El(n,i,t,e,r);if(o&&r){var s=r.a,a=r.aInB;r.overlapN.negateSelf(),r.overlapV.negateSelf(),r.a=r.b,r.b=s,r.aInB=r.bInA,r.bInA=a}return o}}),Al=function(){function t(){c(this,t),this.a=null,this.b=null,this.overlapN=new Hr,this.overlapV=new Hr,this.aInB=!0,this.bInA=!0,this.indexShapeA=-1,this.indexShapeB=-1,this.overlap=Number.MAX_VALUE}return d(t,[{key:"clear",value:function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this.indexShapeA=-1,this.indexShapeB=-1,this}}]),t}(),Pl={pos:new Hr(0,0),ancestor:{_absPos:new Hr(0,0),getAbsolutePosition:function(){return this._absPos}}},Ol=new Al;function Cl(t,e){return!0!==t.isKinematic&&!0!==e.isKinematic&&"object"===p(t.body)&&"object"===p(e.body)&&!(!0===t.body.isStatic&&!0===e.body.isStatic)&&0!=(t.body.collisionMask&e.body.collisionType)&&0!=(t.body.collisionType&e.body.collisionMask)}var Ml={maxChildren:8,maxDepth:4,types:{NO_OBJECT:0,PLAYER_OBJECT:1,NPC_OBJECT:2,ENEMY_OBJECT:4,COLLECTABLE_OBJECT:8,ACTION_OBJECT:16,PROJECTILE_OBJECT:32,WORLD_SHAPE:64,USER:128,ALL_OBJECT:4294967295},rayCast:function(t,e){return function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=0,r=Ul.world.broadphase.retrieve(t),o=r.length;e=r[--o];)if(e.body&&t.getBounds().overlaps(e.getBounds())){var s=e.body.shapes.length;if(0===e.body.shapes.length)continue;var a=t,u=0;do{var l=e.body.getShape(u);Sl["test"+a.shapeType+l.shapeType].call(this,Pl,a,e,l)&&(n[i]=e,i++),u++}while(u<s)}return n.length=i,n}(t,e)}},Rl=function(){function t(e,n,i){if(c(this,t),this.ancestor=e,void 0===this.bounds&&(this.bounds=Gr.pull("Bounds")),void 0===this.shapes&&(this.shapes=[]),this.collisionMask=Ml.types.ALL_OBJECT,this.collisionType=Ml.types.ENEMY_OBJECT,void 0===this.vel&&(this.vel=Gr.pull("Vector2d")),this.vel.set(0,0),void 0===this.force&&(this.force=Gr.pull("Vector2d")),this.force.set(0,0),void 0===this.friction&&(this.friction=Gr.pull("Vector2d")),this.friction.set(0,0),this.bounce=0,this.mass=1,void 0===this.maxVel&&(this.maxVel=Gr.pull("Vector2d")),this.maxVel.set(490,490),this.isStatic=!1,this.gravityScale=1,this.ignoreGravity=!1,this.falling=!1,this.jumping=!1,"function"==typeof i&&(this.onBodyUpdate=i),this.bounds.clear(),void 0!==n)if(Array.isArray(n))for(var r=0;r<n.length;r++)this.addShape(n[r]);else this.addShape(n);this.ancestor.isKinematic=!1}return d(t,[{key:"setStatic",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isStatic=!0===t}},{key:"addShape",value:function(t){if(t instanceof Ba||t instanceof za){var e=t.toPolygon();this.shapes.push(e),this.bounds.add(e.points),this.bounds.translate(e.pos)}else t instanceof Fa?(this.shapes.includes(t)||this.shapes.push(t),this.bounds.addBounds(t.getBounds()),this.bounds.translate(t.getBounds().x,t.getBounds().y)):t instanceof ja?(this.shapes.includes(t)||this.shapes.push(t),this.bounds.add(t.points),this.bounds.translate(t.pos)):this.fromJSON(t);return"function"==typeof this.onBodyUpdate&&this.onBodyUpdate(this),this.shapes.length}},{key:"setVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getShape(e);i instanceof ja?i.setShape(0,0,t):this.shapes[e]=Gr.pull("Polygon",0,0,t),this.bounds.add(this.shapes[e].points,n),"function"==typeof this.onBodyUpdate&&this.onBodyUpdate(this)}},{key:"addVertices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.setVertices(t,e,!1)}},{key:"fromJSON",value:function(t,e){var n=t;if(void 0!==e&&(n=t[e]),void 0===n)throw new Error("Identifier ("+e+") undefined for the given JSON object)");if(n.length){for(var i=0;i<n.length;i++)this.addVertices(n[i].shape,i);this.mass=n[0].density||0,this.friction.set(n[0].friction||0,n[0].friction||0),this.bounce=n[0].bounce||0}return n.length}},{key:"getShape",value:function(t){return this.shapes[t||0]}},{key:"getBounds",value:function(){return this.bounds}},{key:"removeShape",value:function(t){this.bounds.clear(),Ir(this.shapes,t);for(var e=0;e<this.shapes.length;e++)this.addShape(this.shapes[e]);return this.shapes.length}},{key:"removeShapeAt",value:function(t){return this.removeShape(this.getShape(t))}},{key:"setCollisionMask",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ml.types.ALL_OBJECT;this.collisionMask=t}},{key:"setCollisionType",value:function(t){if(void 0!==t){if(void 0===Ml.types[t])throw new Error("Invalid value for the collisionType property");this.collisionType=Ml.types[t]}}},{key:"respondToCollision",value:function(t){var e=t.overlapV;if(this.ancestor.pos.sub(e),0!==e.x&&(this.vel.x=~~(.5+this.vel.x-e.x)||0,this.bounce>0&&(this.vel.x*=-this.bounce)),0!==e.y&&(this.vel.y=~~(.5+this.vel.y-e.y)||0,this.bounce>0&&(this.vel.y*=-this.bounce),!this.ignoreGravity)){var n=!0===this.falling?1:!0===this.jumping?-1:0;this.falling=e.y>=n,this.jumping=e.y<=-n}}},{key:"forEach",value:function(t,e){var n=this,i=0,r=this.shapes,o=r.length;if("function"!=typeof t)throw new Error(t+" is not a function");for(arguments.length>1&&(n=e);i<o;)t.call(n,r[i],i,r),i++}},{key:"contains",value:function(){var t,e;if(2===arguments.length?(t=arguments[0],e=arguments[1]):(t=arguments[0].x,e=arguments[0].y),this.getBounds().contains(t,e))for(var n,i=this.shapes.length;i--,n=this.shapes[i];)if(n.contains(t,e))return!0;return!1}},{key:"rotate",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getBounds().center;return this.bounds.clear(),this.forEach((function(i){i.rotate(t,n),e.bounds.addBounds(i.getBounds()),i instanceof Fa?e.bounds.translate(i.getBounds().x,i.getBounds().y):e.bounds.translate(i.pos)})),this}},{key:"setMaxVelocity",value:function(t,e){this.maxVel.x=t,this.maxVel.y=e}},{key:"setFriction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.friction.x=t,this.friction.y=e}},{key:"update",value:function(t){var e=Fc.tick;if(0!==this.force.x&&(this.vel.x+=this.force.x*e),0!==this.force.y&&(this.vel.y+=this.force.y*e),this.friction.x>0){var n=this.friction.x*e,i=this.vel.x+n,r=this.vel.x-n;this.vel.x=i<0?i:r>0?r:0}if(this.friction.y>0){var o=this.friction.y*e,s=this.vel.y+o,a=this.vel.y-o;this.vel.y=s<0?s:a>0?a:0}return 0!==this.vel.y&&(this.vel.y=Or(this.vel.y,-this.maxVel.y,this.maxVel.y)),0!==this.vel.x&&(this.vel.x=Or(this.vel.x,-this.maxVel.x,this.maxVel.x)),this.falling=this.vel.y*Math.sign(this.force.y)>0,this.jumping=!this.falling&&this.jumping,this.ancestor.pos.add(this.vel),0!==this.vel.x||0!==this.vel.y}},{key:"destroy",value:function(){Gr.push(this.bounds),Gr.push(this.vel),Gr.push(this.force),Gr.push(this.friction),Gr.push(this.maxVel),this.shapes.forEach((function(t){Gr.push(t,!1)})),this.onBodyUpdate=void 0,this.ancestor=void 0,this.bounds=void 0,this.vel=void 0,this.force=void 0,this.friction=void 0,this.maxVel=void 0,this.shapes.length=0,this.setStatic(!1)}}]),t}(),Il=function(t,e){this.removeChildNow(t,e)},Ll=0,jl=function(t){o(n,t);var e=a(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ul.viewport.width,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ul.viewport.height,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return c(this,n),(t=e.call(this,i,r,o,s)).pendingSort=null,t.root=a,t.children=void 0,t.sortOn=Ul.sortOn,t.autoSort=!0,t.autoDepth=!0,t.clipping=!1,t.onChildChange=function(t){},t.enableChildBoundsUpdate=!1,t.backgroundColor=Gr.pull("Color",0,0,0,0),t.drawCount=0,t.autoTransform=!0,t.isKinematic=!1,t.anchorPoint.set(0,0),!0===t.root&&Fo(Co,t.updateBounds.bind(l(t),!0)),t}return d(n,[{key:"reset",value:function(){this.pendingSort&&(clearTimeout(this.pendingSort),this.pendingSort=null);for(var t,e=this.getChildren(),n=e.length;n>=0;t=e[--n])t&&!0!==t.isPersistent&&this.removeChildNow(t);void 0!==this.currentTransform&&this.currentTransform.identity(),this.backgroundColor.setColor(0,0,0,0)}},{key:"addChild",value:function(t,e){return t.ancestor instanceof n?t.ancestor.removeChildNow(t):t.isRenderable&&(t.GUID=Bc.createGUID(t.id)),t.ancestor=this,this.getChildren().push(t),void 0!==t.pos&&("number"==typeof e?t.pos.z=e:!0===this.autoDepth&&(t.pos.z=this.getChildren().length)),!0===this.autoSort&&this.sort(),"function"==typeof t.onActivateEvent&&this.isAttachedToRoot()&&t.onActivateEvent(),!0===this.isAttachedToRoot()&&Ul.repaint(),this.enableChildBoundsUpdate&&this.updateBounds(!0),t.body instanceof Rl&&Ul.world.addBody(t.body),this.onChildChange.call(this,this.getChildren().length-1),t}},{key:"addChildAt",value:function(t,e){if(e>=0&&e<this.getChildren().length)return t.ancestor instanceof n?t.ancestor.removeChildNow(t):t.isRenderable&&(t.GUID=Bc.createGUID()),t.ancestor=this,this.getChildren().splice(e,0,t),"function"==typeof t.onActivateEvent&&this.isAttachedToRoot()&&t.onActivateEvent(),!0===this.isAttachedToRoot()&&Ul.repaint(),this.enableChildBoundsUpdate&&this.updateBounds(!0),t.body instanceof Rl&&Ul.world.addBody(t.body),this.onChildChange.call(this,e),t;throw new Error("Index ("+e+") Out Of Bounds for addChildAt()")}},{key:"forEach",value:function(t,e){var n=this,i=0,r=this.getChildren(),o=r.length;if("function"!=typeof t)throw new Error(t+" is not a function");for(arguments.length>1&&(n=e);i<o;)t.call(n,r[i],i,r),i++}},{key:"swapChildren",value:function(t,e){var n=this.getChildIndex(t),i=this.getChildIndex(e);if(-1===n||-1===i)throw new Error(t+" Both the supplied childs must be a child of the caller "+this);var r=t.pos.z;t.pos.z=e.pos.z,e.pos.z=r,this.getChildren()[n]=e,this.getChildren()[i]=t,this.isDirty=!0}},{key:"getChildAt",value:function(t){if(t>=0&&t<this.getChildren().length)return this.getChildren()[t];throw new Error("Index ("+t+") Out Of Bounds for getChildAt()")}},{key:"getChildIndex",value:function(t){return this.getChildren().indexOf(t)}},{key:"getNextChild",value:function(t){var e=this.getChildren().indexOf(t)-1;if(e>=0&&e<this.getChildren().length)return this.getChildAt(e)}},{key:"hasChild",value:function(t){return this===t.ancestor}},{key:"getChildByProp",value:function(t,e){var i=[];return this.forEach((function(r){!function(t,n){var r=t[n];e instanceof RegExp&&"string"==typeof r?e.test(r)&&i.push(t):r===e&&i.push(t)}(r,t),r instanceof n&&(i=i.concat(r.getChildByProp(t,e)))})),i}},{key:"getChildByType",value:function(t){var e=[];return this.forEach((function(i){i instanceof t&&e.push(i),i instanceof n&&(e=e.concat(i.getChildByType(t)))})),e}},{key:"getChildByName",value:function(t){return this.getChildByProp("name",t)}},{key:"getChildByGUID",value:function(t){var e=this.getChildByProp("GUID",t);return e.length>0?e[0]:null}},{key:"getChildren",value:function(){return void 0===this.children&&(this.children=[]),this.children}},{key:"updateBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i(h(n.prototype),"updateBounds",this).call(this);var e=this.getBounds();return!0!==t&&!0!==this.enableChildBoundsUpdate||this.forEach((function(t){t.isRenderable&&t.getBounds().isFinite()&&e.addBounds(t.getBounds())})),e}},{key:"isAttachedToRoot",value:function(){if(!0===this.root)return!0;for(var t=this.ancestor;t;){if(!0===t.root)return!0;t=t.ancestor}return!1}},{key:"updateBoundsPos",value:function(t,e){var r=this;return i(h(n.prototype),"updateBoundsPos",this).call(this,t,e),this.forEach((function(n){n.isRenderable&&n.updateBoundsPos(n.pos.x+t-r.pos.x,n.pos.y+e-r.pos.y)})),this.getBounds()}},{key:"onActivateEvent",value:function(){this.forEach((function(t){"function"==typeof t.onActivateEvent&&t.onActivateEvent()}))}},{key:"removeChild",value:function(t,e){if(!this.hasChild(t))throw new Error("Child is not mine.");Bc.function.defer(Il,this,t,e)}},{key:"removeChildNow",value:function(t,e){if(this.hasChild(t)&&this.getChildIndex(t)>=0){"function"==typeof t.onDeactivateEvent&&t.onDeactivateEvent(),t.body instanceof Rl&&Ul.world.removeBody(t.body),e||!1===Gr.push(t,!1)&&"function"==typeof t.destroy&&t.destroy();var n=this.getChildIndex(t);n>=0&&(this.getChildren().splice(n,1),t.ancestor=void 0),!0===this.isAttachedToRoot()&&Ul.repaint(),this.enableChildBoundsUpdate&&this.updateBounds(!0),this.onChildChange.call(this,n)}}},{key:"setChildsProperty",value:function(t,e,i){this.forEach((function(r){!0===i&&r instanceof n&&r.setChildsProperty(t,e,i),r[t]=e}))}},{key:"moveUp",value:function(t){var e=this.getChildIndex(t);e-1>=0&&(this.swapChildren(t,this.getChildAt(e-1)),this.isDirty=!0)}},{key:"moveDown",value:function(t){var e=this.getChildIndex(t);e>=0&&e+1<this.getChildren().length&&(this.swapChildren(t,this.getChildAt(e+1)),this.isDirty=!0)}},{key:"moveToTop",value:function(t){var e=this.getChildIndex(t);if(e>0){var n=this.getChildren();n.splice(0,0,n.splice(e,1)[0]),t.pos.z=n[1].pos.z+1,this.isDirty=!0}}},{key:"moveToBottom",value:function(t){var e=this.getChildIndex(t),n=this.getChildren();e>=0&&e<n.length-1&&(n.splice(n.length-1,0,n.splice(e,1)[0]),t.pos.z=n[n.length-2].pos.z-1,this.isDirty=!0)}},{key:"sort",value:function(t){this.pendingSort||(!0===t&&this.forEach((function(e){e instanceof n&&e.sort(t)})),this.pendingSort=Bc.function.defer((function(){this.getChildren().sort(this["_sort"+this.sortOn.toUpperCase()]),this.pendingSort=null,Ul.repaint()}),this))}},{key:"onDeactivateEvent",value:function(){this.forEach((function(t){"function"==typeof t.onDeactivateEvent&&t.onDeactivateEvent()}))}},{key:"_sortZ",value:function(t,e){return e.pos&&t.pos?e.pos.z-t.pos.z:t.pos?-1/0:1/0}},{key:"_sortReverseZ",value:function(t,e){return t.pos&&e.pos?t.pos.z-e.pos.z:t.pos?1/0:-1/0}},{key:"_sortX",value:function(t,e){return e.pos&&t.pos?e.pos.z-t.pos.z||e.pos.x-t.pos.x:t.pos?-1/0:1/0}},{key:"_sortY",value:function(t,e){return e.pos&&t.pos?e.pos.z-t.pos.z||e.pos.y-t.pos.y:t.pos?-1/0:1/0}},{key:"destroy",value:function(){this.reset(),i(h(n.prototype),"destroy",this).call(this,arguments)}},{key:"update",value:function(t){for(var e,r=!1,o=ch.isPaused(),s=this.getChildren(),a=s.length;a--,e=s[a];)o&&!e.updateWhenPaused||(e.isRenderable?((r=Ll>0||e.floating)&&Ll++,e.inViewport=!1,ch.current().cameras.forEach((function(t){t.isVisible(e,r)&&(e.inViewport=!0)})),this.isDirty|=(e.inViewport||e.alwaysUpdate)&&e.update(t),Ll>0&&Ll--):this.isDirty|=e.update(t));return i(h(n.prototype),"update",this).call(this,t)}},{key:"draw",value:function(t,e){var n=!1,i=this.getBounds();this.drawCount=0,!1===this.root&&!0===this.clipping&&!0===i.isFinite()&&t.clipRect(i.left,i.top,i.width,i.height),t.translate(this.pos.x,this.pos.y),this.backgroundColor.alpha>1/255&&t.clearColor(this.backgroundColor);for(var r,o=this.getChildren(),s=o.length;r=o[--s];)r.isRenderable&&(n=!0===r.floating,(r.inViewport||n)&&(n&&(t.save(),t.resetTransform()),r.preDraw(t),r.draw(t,e),r.postDraw(t),n&&t.restore(),this.drawCount++))}}]),n}(gl),Bl=[];function Dl(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(Bl.length>0){var o=Bl.pop();return o.world=t,o.bounds=e,o.max_objects=n,o.max_levels=i,o.level=r,o}return new Nl(t,e,n,i,r)}var Fl=new Hr,Nl=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;c(this,t),this.world=e,this.bounds=n,this.max_objects=i,this.max_levels=r,this.level=o,this.bounds=n,this.objects=[],this.nodes=[]}return d(t,[{key:"split",value:function(){this.level;var t=this.bounds.width/2,e=this.bounds.height/2,n=this.bounds.left,i=this.bounds.top;this.nodes[0]=Dl(this.world,this.bounds,{left:n+t,top:i,width:t,height:e},this.max_objects,this.max_levels),this.nodes[1]=Dl(this.world,this.bounds,{left:n,top:i,width:t,height:e},this.max_objects,this.max_levels),this.nodes[2]=Dl(this.world,this.bounds,{left:n,top:i+e,width:t,height:e},this.max_objects,this.max_levels),this.nodes[3]=Dl(this.world,this.bounds,{left:n+t,top:i+e,width:t,height:e},this.max_objects,this.max_levels)}},{key:"getIndex",value:function(t){var e,n=t.getBounds(),i=-1,r=(e=!0===t.isFloating?this.world.app.viewport.localToWorld(n.left,n.top,Fl):Fl.set(t.left,t.top)).x,o=e.y,s=n.width,a=n.height,u=this.bounds.left+this.bounds.width/2,l=this.bounds.top+this.bounds.height/2,h=o<l&&o+a<l,c=o>l;return r<u&&r+s<u?h?i=1:c&&(i=2):r>u&&(h?i=0:c&&(i=3)),i}},{key:"insertContainer",value:function(t){for(var e,n=t.children.length;n--,e=t.children[n];)!0!==e.isKinematic&&(e instanceof jl?("rootContainer"!==e.name&&this.insert(e),this.insertContainer(e)):"function"==typeof e.getBounds&&this.insert(e))}},{key:"insert",value:function(t){var e=-1;if(this.nodes.length>0&&-1!==(e=this.getIndex(t)))this.nodes[e].insert(t);else if(this.objects.push(t),this.objects.length>this.max_objects&&this.level<this.max_levels){0===this.nodes.length&&this.split();for(var n=0;n<this.objects.length;)-1!==(e=this.getIndex(this.objects[n]))?this.nodes[e].insert(this.objects.splice(n,1)[0]):n+=1}}},{key:"retrieve",value:function(t,e){var n=this.objects;if(this.nodes.length>0){var i=this.getIndex(t);if(-1!==i)n=n.concat(this.nodes[i].retrieve(t));else for(var r=0;r<this.nodes.length;r+=1)n=n.concat(this.nodes[r].retrieve(t))}return"function"==typeof e&&n.sort(e),n}},{key:"remove",value:function(t){var e=!1;if(void 0===t.getBounds)return!1;if(this.nodes.length>0){var n=this.getIndex(t);-1!==n&&(e=Ir(this.nodes[n],t))&&this.nodes[n].isPrunable()&&this.nodes.splice(n,1)}return!1===e&&-1!==this.objects.indexOf(t)&&(Ir(this.objects,t),e=!0),e}},{key:"isPrunable",value:function(){return!(this.hasChildren()||this.objects.length>0)}},{key:"hasChildren",value:function(){for(var t=0;t<this.nodes.length;t+=1){var e=this.nodes[t];if(e.length>0||e.objects.length>0)return!0}return!1}},{key:"clear",value:function(t){this.objects.length=0;for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear(),n=this.nodes[e],Bl.push(n);var n;this.nodes.length=0,void 0!==t&&this.bounds.setMinMax(t.min.x,t.min.y,t.max.x,t.max.y)}}]),t}(),zl=function(t){o(n,t);var e=a(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return c(this,n),(t=e.call(this,i,r,o,s,!0)).name="rootContainer",t.anchorPoint.set(0,0),t.app=null,t.fps=60,t.gravity=new Hr(0,.98),t.preRender=!1,t.bodies=new Set,t.broadphase=new Nl(l(t),t.getBounds().clone(),Ml.maxChildren,Ml.maxDepth),Fo(fo,t.reset,l(t)),Fo(bo,(function(){t.broadphase.clear(t.getBounds())})),t}return d(n,[{key:"reset",value:function(){this.broadphase.clear(),this.anchorPoint.set(0,0),i(h(n.prototype),"reset",this).call(this),this.bodies.clear()}},{key:"addBody",value:function(t){return this.bodies.add(t),this}},{key:"removeBody",value:function(t){return this.bodies.delete(t),this}},{key:"bodyApplyGravity",value:function(t){if(!t.ignoreGravity&&0!==t.gravityScale){var e=this.gravity;t.force.x+=t.mass*e.x*t.gravityScale,t.force.y+=t.mass*e.y*t.gravityScale}}},{key:"update",value:function(t){var e=this,r=ch.isPaused();return this.broadphase.clear(),this.broadphase.insertContainer(this),this.bodies.forEach((function(n){if(!n.isStatic){var i=n.ancestor;r&&!i.updateWhenPaused||!i.inViewport&&!i.alwaysUpdate||(e.bodyApplyGravity(n),!0===n.update(t)&&(i.isDirty=!0),function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ol,i=Ul.world.broadphase.retrieve(t),r=i.length;e=i[--r];)if(e!==t&&Cl(t,e)&&t.body.getBounds().overlaps(e.body.getBounds())){var o=t.body.shapes.length,s=e.body.shapes.length;if(0===o||0===s)continue;var a=0;do{var u=t.body.getShape(a),l=0;do{var h=e.body.getShape(l);!0===Sl["test"+u.shapeType+h.shapeType].call(this,t,u,e,h,n.clear())&&(n.indexShapeA=a,n.indexShapeB=l,t.onCollision&&!1!==t.onCollision(n,e)&&!1===t.body.isStatic&&t.body.respondToCollision.call(t.body,n),e.onCollision&&!1!==e.onCollision(n,t)&&!1===e.body.isStatic&&e.body.respondToCollision.call(e.body,n)),l++}while(l<s);a++}while(a<o)}}(i),n.force.set(0,0))}})),i(h(n.prototype),"update",this).call(this,t)}}]),n}(jl),Ul=new(function(){function t(){c(this,t),this.viewport=null,this.world=null,this.mergeGroup=!0,this.sortOn="z",this.lastUpdate=0,this.isDirty=!0,this.isAlwaysDirty=!1,this.frameCounter=0,this.frameRate=1,this.accumulator=0,this.accumulatorMax=0,this.accumulatorUpdateDelta=0,this.stepSize=1e3/60,this.updateDelta=0,this.lastUpdateStart=null,this.updateAverageDelta=0}return d(t,[{key:"init",value:function(){this.world=new zl,this.world.app=this,this.lastUpdate=globalThis.performance.now(),Do(co,this)}},{key:"reset",value:function(){var t=ch.get();void 0!==t&&(this.viewport=t.cameras.get("default")),Do(fo),this.updateFrameRate()}},{key:"onLevelLoaded",value:function(){}},{key:"updateFrameRate",value:function(){this.frameCounter=0,this.frameRate=~~(.5+60/Fc.maxfps),this.stepSize=1e3/this.world.fps,this.accumulator=0,this.accumulatorMax=10*this.stepSize,this.isAlwaysDirty=Fc.maxfps>this.world.fps}},{key:"getParentContainer",value:function(t){return t.ancestor}},{key:"repaint",value:function(){this.isDirty=!0}},{key:"update",value:function(t,e){if(++this.frameCounter%this.frameRate==0){for(this.frameCounter=0,Do(po,t),this.accumulator+=Fc.getDelta(),this.accumulator=Math.min(this.accumulator,this.accumulatorMax),this.updateDelta=Fc.interpolation?Fc.getDelta():this.stepSize,this.accumulatorUpdateDelta=Fc.interpolation?this.updateDelta:Math.max(this.updateDelta,this.updateAverageDelta);this.accumulator>=this.accumulatorUpdateDelta||Fc.interpolation;)if(this.lastUpdateStart=globalThis.performance.now(),!0!==ch.isPaused()&&Do(yo,t),this.isDirty=e.update(this.updateDelta)||this.isDirty,this.lastUpdate=globalThis.performance.now(),this.updateAverageDelta=this.lastUpdate-this.lastUpdateStart,this.accumulator-=this.accumulatorUpdateDelta,Fc.interpolation){this.accumulator=0;break}Do(vo,this.lastUpdate)}}},{key:"draw",value:function(t){!0===Pc.isContextValid&&(this.isDirty||this.isAlwaysDirty)&&(Do(go,globalThis.performance.now()),Pc.clear(),t.draw(Pc),this.isDirty=!1,Pc.flush(),Do(mo,globalThis.performance.now()))}}]),t}());Fo(ro,(function(){Ul.init()}));var Vl,Gl=Math.min,Hl=Math.max,Yl=new Hr,Wl=function(t){o(n,t);var e=a(n);function n(t,i,r,o){var s;return c(this,n),(s=e.call(this,t,i,r-t,o-i)).AXIS={NONE:0,HORIZONTAL:1,VERTICAL:2,BOTH:3},s.bounds=Gr.pull("Bounds"),s.smoothFollow=!0,s.damping=1,s.near=-1e3,s.far=1e3,s.projectionMatrix=new $r,s.invCurrentTransform=new to,s.offset=new Hr,s.target=null,s.follow_axis=s.AXIS.NONE,s._shake={intensity:0,duration:0,axis:s.AXIS.BOTH,onComplete:null},s._fadeOut={color:null,tween:null},s._fadeIn={color:null,tween:null},s.name="default",s.setDeadzone(s.width/6,s.height/6),s.anchorPoint.set(0,0),s.isKinematic=!1,s.bounds.setMinMax(t,i,r,o),s._updateProjectionMatrix(),Fo(fo,s.reset,l(s)),Fo(Co,s.resize,l(s)),s}return d(n,[{key:"_updateProjectionMatrix",value:function(){this.projectionMatrix.ortho(0,this.width,this.height,0,this.near,this.far)}},{key:"_followH",value:function(t){var e=this.pos.x;return t.x-this.pos.x>this.deadzone.right?e=Gl(t.x-this.deadzone.right,this.bounds.width-this.width):t.x-this.pos.x<this.deadzone.pos.x&&(e=Hl(t.x-this.deadzone.pos.x,this.bounds.left)),e}},{key:"_followV",value:function(t){var e=this.pos.y;return t.y-this.pos.y>this.deadzone.bottom?e=Gl(t.y-this.deadzone.bottom,this.bounds.height-this.height):t.y-this.pos.y<this.deadzone.pos.y&&(e=Hl(t.y-this.deadzone.pos.y,this.bounds.top)),e}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.pos.x=t,this.pos.y=e,this.unfollow(),this.smoothFollow=!0,this.damping=1,this.currentTransform.identity(),this.invCurrentTransform.identity().invert(),this._updateProjectionMatrix()}},{key:"setDeadzone",value:function(t,e){void 0===this.deadzone&&(this.deadzone=new Ba(0,0,0,0)),this.deadzone.pos.set(~~((this.width-t)/2),~~((this.height-e)/2-.25*e)),this.deadzone.resize(t,e),this.smoothFollow=!1,this.updateTarget(),this.smoothFollow=!0}},{key:"resize",value:function(t,e){return i(h(n.prototype),"resize",this).call(this,t,e),this.smoothFollow=!1,this.setBounds(0,0,t,e),this.setDeadzone(t/6,e/6),this.update(),this.smoothFollow=!0,this._updateProjectionMatrix(),Do(Mo,this.width,this.height,this),this}},{key:"setBounds",value:function(t,e,n,i){this.smoothFollow=!1,this.bounds.setMinMax(t,e,n+t,i+e),this.moveTo(this.pos.x,this.pos.y),this.update(),this.smoothFollow=!0}},{key:"follow",value:function(t,e,n){if(t instanceof gl)this.target=t.pos;else{if(!(t instanceof Hr||t instanceof au||t instanceof su||t instanceof uu))throw new Error("invalid target for me.Camera2d.follow");this.target=t}this.follow_axis=void 0===e?this.AXIS.BOTH:e,this.smoothFollow=!1,this.damping="number"!=typeof n?1:Or(n,0,1),this.updateTarget(),this.smoothFollow=!0}},{key:"unfollow",value:function(){this.target=null,this.follow_axis=this.AXIS.NONE}},{key:"move",value:function(t,e){this.moveTo(this.pos.x+t,this.pos.y+e)}},{key:"moveTo",value:function(t,e){var n=this.pos.x,i=this.pos.y;this.pos.x=Or(t,this.bounds.left,this.bounds.width),this.pos.y=Or(e,this.bounds.top,this.bounds.height),n===this.pos.x&&i===this.pos.y||(this.isDirty=!0)}},{key:"updateTarget",value:function(){if(this.target){switch(Yl.setV(this.pos),this.follow_axis){case this.AXIS.NONE:break;case this.AXIS.HORIZONTAL:Yl.x=this._followH(this.target);break;case this.AXIS.VERTICAL:Yl.y=this._followV(this.target);break;case this.AXIS.BOTH:Yl.x=this._followH(this.target),Yl.y=this._followV(this.target)}if(!this.pos.equals(Yl)){if(!0===this.smoothFollow&&this.damping<1){if(Rr(Yl.x,this.pos.x,2)&&Rr(Yl.y,this.pos.y,2))return void this.pos.setV(Yl);this.pos.lerp(Yl,this.damping)}else this.pos.setV(Yl);this.isDirty=!0}}}},{key:"update",value:function(t){return this.updateTarget(t),this._shake.duration>0&&(this._shake.duration-=t,this._shake.duration<=0?(this._shake.duration=0,this.offset.setZero(),"function"==typeof this._shake.onComplete&&this._shake.onComplete()):(this._shake.axis!==this.AXIS.BOTH&&this._shake.axis!==this.AXIS.HORIZONTAL||(this.offset.x=(Math.random()-.5)*this._shake.intensity),this._shake.axis!==this.AXIS.BOTH&&this._shake.axis!==this.AXIS.VERTICAL||(this.offset.y=(Math.random()-.5)*this._shake.intensity)),this.isDirty=!0),!0===this.isDirty&&Do(Lo,this.pos),null==this._fadeIn.tween&&null==this._fadeOut.tween||(this.isDirty=!0),this.currentTransform.isIdentity()?this.invCurrentTransform.identity():this.invCurrentTransform.copy(this.currentTransform).invert(),i(h(n.prototype),"update",this).call(this,t)}},{key:"shake",value:function(t,e,n,i,r){0!==this._shake.duration&&!0!==r||(this._shake.intensity=t,this._shake.duration=e,this._shake.axis=n||this.AXIS.BOTH,this._shake.onComplete="function"==typeof i?i:void 0)}},{key:"fadeOut",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2?arguments[2]:void 0;this._fadeOut.color=Gr.pull("Color").copy(t),this._fadeOut.tween=Gr.pull("Tween",this._fadeOut.color).to({alpha:0},e).onComplete(n||null),this._fadeOut.tween.isPersistent=!0,this._fadeOut.tween.start()}},{key:"fadeIn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2?arguments[2]:void 0;this._fadeIn.color=Gr.pull("Color").copy(t);var i=this._fadeIn.color.alpha;this._fadeIn.color.alpha=0,this._fadeIn.tween=Gr.pull("Tween",this._fadeIn.color).to({alpha:i},e).onComplete(n||null),this._fadeIn.tween.isPersistent=!0,this._fadeIn.tween.start()}},{key:"focusOn",value:function(t){var e=t.getBounds();this.moveTo(t.pos.x+e.left+e.width/2,t.pos.y+e.top+e.height/2)}},{key:"isVisible",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.floating;return!0===e||!0===t.floating?Pc.overlaps(t.getBounds()):t.getBounds().overlaps(this)}},{key:"localToWorld",value:function(t,e,n){return(n=n||Gr.pull("Vector2d")).set(t,e).add(this.pos).sub(Ul.world.pos),this.currentTransform.isIdentity()||this.invCurrentTransform.apply(n),n}},{key:"worldToLocal",value:function(t,e,n){return(n=n||Gr.pull("Vector2d")).set(t,e),this.currentTransform.isIdentity()||this.currentTransform.apply(n),n.sub(this.pos).add(Ul.world.pos)}},{key:"drawFX",value:function(t){this._fadeIn.tween&&(t.save(),t.resetTransform(),t.setColor(this._fadeIn.color),t.fillRect(0,0,this.width,this.height),t.restore(),1===this._fadeIn.color.alpha&&(this._fadeIn.tween=null,Gr.push(this._fadeIn.color),this._fadeIn.color=null)),this._fadeOut.tween&&(t.save(),t.resetTransform(),t.setColor(this._fadeOut.color),t.fillRect(0,0,this.width,this.height),t.restore(),0===this._fadeOut.color.alpha&&(this._fadeOut.tween=null,Gr.push(this._fadeOut.color),this._fadeOut.color=null))}},{key:"draw",value:function(t,e){var n=this.pos.x+this.offset.x,i=this.pos.y+this.offset.y;e.currentTransform.translate(-n,-i),t.setProjection(this.projectionMatrix),t.clipRect(0,0,this.width,this.height),this.preDraw(t),e.preDraw(t,this),e.draw(t,this),this.drawFX(t),e.postDraw(t,this),this.postDraw(t),e.currentTransform.translate(n,i)}}]),n}(gl),Xl={cameras:[]},Kl=function(){function t(e){c(this,t),this.cameras=new Map,this.lights=new Map,this.ambientLight=new Qr(0,0,0,0),this.settings=Object.assign(Xl,e||{})}return d(t,[{key:"reset",value:function(){var t=this;if(this.settings.cameras.forEach((function(e){t.cameras.set(e.name,e)})),!1===this.cameras.has("default")){if(void 0===Vl){var e=Pc.getWidth(),n=Pc.getHeight();Vl=new Wl(0,0,e,n)}this.cameras.set("default",Vl)}Ul.reset(),this.onResetEvent.apply(this,arguments)}},{key:"update",value:function(t){var e=Ul.world.update(t);return this.cameras.forEach((function(n){!0===n.update(t)&&(e=!0)})),this.lights.forEach((function(n){!0===n.update(t)&&(e=!0)})),e}},{key:"draw",value:function(t){var e=this;this.cameras.forEach((function(n){n.draw(t,Ul.world),0!==e.ambientLight.alpha&&(t.save(),e.lights.forEach((function(e){t.setMask(e.getVisibleArea(),!0)})),t.setColor(e.ambientLight),t.fillRect(0,0,n.width,n.height),t.clearMask(),t.restore()),e.lights.forEach((function(e){e.preDraw(t,Ul.world),e.draw(t,Ul.world),e.postDraw(t,Ul.world)}))}))}},{key:"destroy",value:function(){this.cameras.clear(),this.lights.forEach((function(t){t.destroy()})),this.lights.clear(),this.onDestroyEvent.apply(this,arguments)}},{key:"onResetEvent",value:function(){"function"==typeof this.settings.onResetEvent&&this.settings.onResetEvent.apply(this,arguments)}},{key:"onDestroyEvent",value:function(){"function"==typeof this.settings.onDestroyEvent&&this.settings.onDestroyEvent.apply(this,arguments)}}]),t}(),ql=function(t){o(n,t);var e=a(n);function n(t,i,r,o){var s;return c(this,n),(s=e.call(this,t,i,r,o)).barHeight=o,s.anchorPoint.set(0,0),Fo(wo,s.onProgressUpdate,l(s)),Fo(Mo,s.resize,l(s)),s.anchorPoint.set(0,0),s.progress=0,s}return d(n,[{key:"onProgressUpdate",value:function(t){this.progress=~~(t*this.width),this.isDirty=!0}},{key:"draw",value:function(t,e){t.setColor("black"),t.fillRect(this.pos.x,e.centerY,t.getWidth(),this.barHeight/2),t.setColor("#55aa00"),t.fillRect(this.pos.x,e.centerY,this.progress,this.barHeight/2)}},{key:"onDestroyEvent",value:function(){zo(wo,this.onProgressUpdate),zo(Mo,this.resize)}}]),n}(gl),Zl=function(t){o(n,t);var e=a(n);function n(){return c(this,n),e.apply(this,arguments)}return d(n,[{key:"onResetEvent",value:function(){Ul.world.backgroundColor.parseCSS("#202020"),Ul.world.addChild(new ql(0,Pc.getHeight()/2,Pc.getWidth(),8),1),$h.load({name:"melonjs_logo",type:"image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAA8FBMVEUgICBrqDHRZVtqpzEhJCAjKCBurTIfHyDQZFptrDEWAB8OAB7VZ1wtIiIAEhYlISDYaF4SAB4pIiEAFhkcFh8eGyBopDAMAB5noS8kKyAAGhtjmy4bEB9lni8ZBR/HYFdPeim/XFQ9XCUaCh9flS1VhCtSfyorOSEVHh4HHB1EZyatVExhmC5ajCxHbSc0SyMuQCInMiFKcSgxRSI6VSRBYiWdTUZdki09JyZ8PzpYiSs3UCRlNjK1WE9ckC1MdShbjywyJCONRkDKYliUSUNeMzBDKShXMC2kUEl1PDeEQj1OLStnNjNxOjZsODQAAAcMh1CFAAAU4UlEQVR42uyaa3fSMBjHk5EQkgClkBZKoXblNhlswIooc2N6pp7jUb//x/FpRbnt4JWwzv7eraQvfs/zby7tUEpKSkpKSkpKSkpKSkpKSkqKTsg30P8E+FIArJllqQaglMXQt6tPuhogGSlaLWFKKU2hEB33eqPRqDemRAlhRhdbVjwIBj8xogajhpBSkNH1dOJ37mYDt1mr2UCt1mwOZned7qQfjhxPVs0WovTpRIFFNkpIU42CSWfm2phnIzjHP+DLS9hutjuL4IqZUigC9yU/CWDBhBROOJkPbBxL4swKjDf/jEvBbXe4CMeiKixKEx0EAq03JbqeDJs4Ul9a7mE5AqqAazM/pJCb5JaAUmWa42nHBflYDf8y8WC4qznv9yRKZAUIRUKO+/Maz/J1+d8ugu0rK3kVoNSTVhDZr8v/WRGyQw8lC0KJMK989+/sVzXILiRNzmrACGXSC4Z2lsf2f08GN2lyHgJCLUn6bRw1/2dim+A9hIKiJMAQ6NOJu7f5a7r8B+u/7N7BAzMZBaBIkkkz0t83sfMsgDHsgN1BOybaFNvww2qblMgEUGKqi2aU/X3u2HZnHf8iuL4aO0S1PKDVQM54dBn0F50718bfq5CwOYBQIaaDVfd37MG91u5MwhER8WHQU8qC2wCEmFJefEYUrBdedGe15b4xQasAtaqXt/wh/W87W1679YNeCxQbjNCItTchBFheRErAmHEYb575ch/Qeuz9ByXpdHH2QX2wx4NuMBbSbJCfn3IJWZ4dndBvZ6Bytt949A8AbZjT6OHftQeDTHtx2VgebhFj6KfAmGisJaS46k+mj/4sELW/N+QP6UOIXf/Sqwq0p/F7okA8KU312BcAqmTf3k1/1Hx7HlgyskfsL96h7b3XMNCRcYQzz+KH9N3FSC57fxiYUTDOWLmAjgcjpBo2d9oPKxdv95Fs0UPGl5XPinWDVYqGwdBxYFQJH/Mdfc5nQUuyw77KYYXKm/ub09PzV/Xn5SNVAOJ/B/Hf0W8HwiQUHRTwf/2slM/nS6WbN/XjZIDK6534w8zv9r1In6GDUq6/y+VzMaVTdGYg7cDj38/wHX17YknQPzSGUb8p5U5icqX7ovaZkBFk+nw7/hx3epIdvPtAufIpf7Ikl39W0B0BRpToQPy32j8IZUPPW+xC8S0E4Afv6noLwGgL3WZ32u8roetbTqF4v1aA/JdKGWmEUc8ZgP/m0j+4riKKNFEoflwrQO6D1gQwKnrulj/mXUto048XgZV+/vQMaYQ5otfc8s/Wpprav5oFz5cRgHXwo85VgFHw55nN+Ld7UvMnPOP5y2elXMRJ6VzDA7DPH2e7XstBemHl+vubfAk4efGc6SsAo9542x9fVJH+D/lQgfrnF+fn9++KWv0bdHP+z3A7rFKC9MMMo1KsVIr1ssYHgFiqvemfdUemg45EuVAuFMpIH4SI4ZZ/2xEOQ8eCAUgjVHa3/G+txuN/Z/+vYE51suU/9NT/5G8GIL3uPxfsCfwf11fyrW1FgRiGTkna0vZpYHQUXRHdVZBhvCMorP7/V+3oyprgPiy2Dxk2HzA06TknpyHz19CjVfcpf9kj+6SBtqgcMPz/q/vPdPgwLP/DsCM1f2vTf7Ifap5/hYXQ/FGnX7S16LdABADc23oqVP91kYfgrU5b1GxKHSCo7tILzR/z9eJ8nliv0zqAMZ8ATEJfaP6+7jlj3CDlXpHVfsfnH+eyn4kMzMdGQRNO7fNkGEXbGTigBkDq1lZzU07BnaXzIab6LCMAuEEmdWcD8+ax9uNTckxFqyWxwKBgKXZrzerHtAbcPhFQ0R8oAExdChXADIt1Tz0KkGi9TjML1CBLqgA0YZGIFZhZqVNUtf9GCdBbF0IF4Be/vvQYz6pyxhRwH+QC4CpXoAgELvE6iKMtfwJLzv+5YU2iDasOR0MJMBdMgFsMK6ICrppGY+rELGAdhFpAYoXYgRdBRzsLUtB3L/z+7zpITFvHYhQAdorGyQudAdCuNe8qoJjVNgYAF0M+9iFbAe9tK2w4BKIIdVJ0CLASv7jeBFo7cBwCrxcgP1IAjEv5ALipwII1gmGGMR4A2uEB+blJK4x4E1kdZhQA5xYowPe58z3lwKfH199WbQRAc/LpuwPWu17k0qaFCnANAgHSvKJcZdMCxJtgOsQuKsexG2uCwMxa8O8aUa/axHZCe/OUZA42ag0Avqi5ll2nYSAaRQEbZI+NrbKwEFFYJURCiEcpqEE0aZOmBfH/f4PLQ+OEttwxLKg3jq5Or3TG9jyOJ/FjgSIGZvBRLhB1oFvi7/3X5CIDhZHodOLtfyyEXUlh0IGzyDoQM+rbGljFRNaE2ZOXj0MT3pALxGQo8v1z1ILRBb6+hTJoZgLvBoMYRjZAeALuv/v/hZCzeTxWRIu/iwEvbqQMmKcxUekwHqF/KQSo74OCVX8rCyQoC9C/QYBZENZTcYMlRkqjWFlVZfn9OWGXwcoDVFKewD+fo33v9AwQD3HGFqH5XsXHACWVA7BObfp+YyoL4BKpLvb+MuvBlVn1q03iwIONVNFy1jPUBvGyPOaGJT4GGOPAHd9v66bIuy7Pi3p5GKoTrYSdeRXaQrk7LD02P2Gbejv2FqrYdugFxgHM5ChBEFNpIn/czxaObdMJrcXP4Z94sdxZUGZmAZmA+7ws0im4a9oenFQsKg58uE8NhBgE43+LlBysa65FmvJweIppMzobsmJKWve+EFrMsUJ3+wEqGaUKPA9XkSYNhj0xUd8xYkbBsU516lnMhv+LFs1nKCX7BZYVjIUQZ8FC830PRjG6LnSqBzCSPcloP0U9IaLZhknntlynSGhOS+yV/bWuEla1EPwSONXdAc0VKYv4ZcyoWQBGEDp/2zdI/zyrYgfyR6CAL7nm18BC18pJFnlLhuUMsScgvs9CwjrXyOgCq/Q9yIQpBa0Q/DqW6+JoJSNX9AGNT4S2uezhx8B9kBvu2AZGjpQubwLRglHKLnX6Z7DodmgBQjDHkji7O3+MoFFZgITx+pLiMdiChL1G7DUL8DWQLBDPw3dGh5Yjn38YT+TuMrhuvy71HbGiGyzRAg8DVYQQzO49evYg7ArLiP7v82/7n3OcZ8u6F36+IzjfVCqivwkTetqNCHpP2nvdfS74PJTr7zH+NM9pTflPwTMbcN1YkgEwFcL7EXIddf85LQ1SrtZ8FsO6uh13w7Abt02nZ7tjbiuR1+2Xn2COYPxaCCM3+KCqQz86fnpDSgOkPQg+i/dtb8E6P/zUt8Vln+/pF4fVD7D103Gbz8B8cIbULeJlHXqLM2ZQZDHEuGMnpsF+m0Alpfk+pKmAtZdCJNf5wUGJYAervRB8eggotSH2SlAy2myBchi14VbCxKlzka+BScWCqofBUASYCbsVKAQzD65g7CbmEl9OCTQtocEm74ysiPsq6imhilLVxANyUfR2o9i0SN7YstH8DP+9db+DYcD/iFsgqnXWd02SXAc9CrLpx124yFd2w35HlQ4tEPCHxPwO9haY7oG1NbQbMnLPYPbw2YNIMYAlxeTIDlP+WP0axAUhTrGzefUXEeK+kXetvU3DUDQtqdxKSQwJG1romIbQSLWhfuChFRioG92rsP//c3AiwbErxfKxBMoFf/am5cyPc+899/hDkTOJHZ4IKMQQrC6irDZTh+YVa9VHlsbuyK6uEe7tINCdK9hVutGkUgL/S0pox5cEchPX2X9qrXVfuIQIoAcsDN2sj+yb5XuVU8JZlgkpZ+PMzMbhvG0AwKqfteh6O3VZbqL8J4tNhggAluxxBgaNEIK7A/BNWvkWC7DCV/X+3qsMU0+LkqiS75NyMUhD+LqqrjdT51TPlQeAVTZ11nXpW1nm1sDOWhA1blBBcGEincwV1crqwV7Vq6r0U8ZxiCEevONwtzaaKnGS6X3lCGRHSwaAuyzU4Uyr5tjaLv4wL6+cm3BbxwFw9pSujJsfowBY2UfAutHeyRftZGwXb4RxY2+XDQHAgQGAlblMHI382xeRABwnSicBpyDYjS/HADYILhiYFAMA6k8DUDgANCQAfue0bPy3AeC3QD48AGK2gHLOgJFwAKhDENfgvwkArkGGCH0SDcAuEeKp8MhQYcEAtFT4EU2Fn9nB0HvJAExQHEMwRIfDogFgw2GI7eGXIhkANyESlxITvQLc/2UwAO+cLILgW4BMikIg46TF01QwAGxaHOwBuoI9uQBwhRGMPbs09nouFwCo3fAlLG6GCooFAMVRrGVaXTUz5XGxAHjK44xAQioArUBiZgskYiUyUrcAKhygdDEiqT2xPACZDS6qSe2+y04hIROAFM5aSO6F2qe5pmxDAMBJivJCydFhqsiOK9SHhQLQNb/ahTHFycsglh7EFogB4IQUSyORsqT841Aay8aBxR7VqYlQHPfK33SysAUVwY/qzF/ZO5kRfKLljAkidJMfZaEPgJXVD+ubNnUZqL0yS0upwKAOWidW7ZY++UhSIRQxp79KmAvth8sIha5Q8VZJ0B6YdquFaZlBTjyl7UMQEQcXyG8fZ93TN+MHCJv75l4bzWQ3+RhlRI8A2UzGozpEdpvjgSDRYALh7TY6qS+PWpHvBcT9nmdizk+nmQHsNq+xAHoRuLkYt21k32qlQ/01D0es0gVUCIcAZUimdbG+u7z/XOP7PQgsiu395WpbNKUKaEKqNmbyeZFoNiEKOscrDHkf1bxpmz91GdZY2HWHhjWHlt3kRc6bS/I2IoijIkyadZ7nJTNZU5PpByHAAmhXvkgfGqXUACY77fOc5h2SeXRciTNQ2Gkef56oOAsNtF1KQwCRIN/9CxqFZII8E5WXFpdFiZeW2oNHyRrIhSAfGrMHUCUfrKN8yAI+oYyUkFK2HaVFW2khtR/rPzDal+UkZGjwzOMAwRSJkReScwyi5QGdEvxI2wqZSEdNeGryRNYl018dT9X/zlIzndt0eHR4MNSnVXyPgoAGR3tKYidJ8dOa4PRCTTD2eRl7CUyEmAqirIHqbuxveuOcAjIuApwAHjNFKqmC5lsZIdH8zGuuzp8mYJQCTgGo/FARix7KMSQzYzn8vAAU8gFGcPQS+DJ8AH4rndH8PqQ3S35yd2U7isNAMFHasWw/WcopQhRBIBICQsggJCIx/P9XrTMcDWbZY5YQs36Yh4EZXNXl7vJB3Hkjd7fCkCfc3/ZGbgh4zp5xwYbuBdBWGr00pF2OrT0E6p/sIH6V1uRHTANeDv1NE/j4rB1mFYMHgTYJsJtnrGORL1W9w107NA4/u+gqjL+cFXprU2+cbSvA828GxFKImwRmLpDiji6WwCdvsuDjOU1MA7iI+WzXBj4MmfFpQKuAeC7wOdss6n8afe8qjaUaqNdRWoeEPt1g4wPGpFkMUJKuIruDAaA/ahsToVmXr4NnYanq4GI4eq4waLKJZxADYF12MvFIEO3EZKPLTMxxhADo1ztK0zgtxIND3JhieKnTeKEEhacT4F9OHOB+qRkMXHZwcCOzgwxFv76IfKszMxgg4bqNDDa26cSs01hsmKMtDlj9X8La4sfAdHkvHn6vHhngtGcGAJT+EX+3RxnwDDV+GPf7rIYUQGQa/tyj3RFA063GwN4f98cAJT6f3HaIDaukO1FS8GCuMTCveGz10yhJvIWGP+rWolKSFkMtEw7LvuaGMa/yW/y208iO8GMxXEXslnRnE8LrUyEFIpqhht8edb5aRWNeawzYLJMvnxhQsMKZw16KHw2RzoC7iF+dCOJ0PGX2a/Hj0sNFA5gIPl4zDFD+KzX8dfzhoyh0zwCzP/nrREA8MQu0HtjOSHTeAcwDxcDVPt/d1iGQVygQiKx2rq1FIPh4BX7MA/G5AOEwCNZKBN3PjuJEbCLX0cZgVL90kY6SxFcW5E4EZegTq9N+ECssdszWyZ8X/DX4UYc+n+oydFx7SgR0Z4sogEzWgc684x6s9PV1GMS6DbsmguGMc9IRBUC4HM3d+w+d9jIlAxKOIi0R2A5z85HkHWRDCiQV5YIxR8PP7KWAfiblsSxyV++P6tDhQz5dBS38emLfhV9ZkKa/Q8xknKAdu04Fiw/OLfKssFCLAJf1xEH4PZpQ3ZBvMCdddcvejxLhE3hO8KnkzQ7hX8t/LfvdnwAiiz327IoCli9jwUFxQP8l9kBgLKzNvhX/Pc/zpo+JqD4M+NpBEVzlAjeaNqkYA4Hv00s8wetswJDj6/BPfQNOKlCAsN7+rIPtSMjXKy4SIH8rBGoBEPCkqGYHx8XMfx3+wUdombE9RzhfBg8ocIPDUnHAfULgr0JP1R8Vs13kovZvEq2TqfCbsC1xMkXFzsY46RxsPxuQioRWCQC/RA5AFPhUCL9cL6JW+j+Dz1rXTfuXPzaSiNEcY3XHgT3YLRvCheSeBQR5oKpdIQfLS6WQUM4mA8e9Qa/7TWPCf/FpfLwcIgU6B0zBGe6zWVklMlQ8jD2/BX0mg3pjLkUo07jcZIsWPEP0OvwgA9l78r9vBAT5jB5QcESjYDlRvpsuN01dES/lnEupfqQeVKtmtMx2+dBhJ/APmHSdaWGW+rERPyymAVKgtRMq5rYIg2g4z/P9YbFY7PN8PoyC4wuI/QH8yUokxDIu/Ofk7YVFFmllSyfhjJCxFvIXaqa99Ah+MKnF2KzBf0dBElbrAdNk8IAKbL9/txJIlK1EajT8Yzb0hTXb2pjC/7k5X55qvqzCxHT458mL4M10iDL4bsMSEuxGifDeAv5RBcBFPDsEWMq/H3vmOttlIbhFzKt8v5SBL/hquW85QBL+Xvmuk3+W/H2CfyuDccvBIrKxsP859jb0LNqvy1RweK/gYwMCiZDVKMsDdlLCr2m4vEWBD+bTTcFFCu8XfI0Dr53XjbL9yeRh/dNgo0+yo+10s1LcJW+O/ryo05IQ8ricZYt5pGg4Wr6bxo6/taP5YTprKh624AmYavn+urVgfC6F9KpSef7JYTtQ7jcInLYFyhcP8sMkW27KwudCcA/I+4f+Tgnn+a5CKCT3SVWs6ros63q1qgg9/do7vY3+L6H/0a4dqgAAg1AULYPBsjax+P//uA3TwuJAxj3RJiYf7xJ5rBVVLNzHcA8T7fkZl6iePpchSDvs8b9XBwAAAAAAqGQCc31B4/xqSwwAAAAASUVORK5CYII="},(function(){Ul.world.addChild(new tc(Pc.getWidth()/2,Pc.getHeight()/2,{image:"melonjs_logo",framewidth:256,frameheight:256}),2)}))}},{key:"onDestroyEvent",value:function(){$h.unload({name:"melonjs_logo",type:"image"})}}]),n}(Kl),Jl=-1,Ql=-1,$l=!1,th={},eh={color:"",duration:0},nh=null,ih=null,rh=0;function oh(){-1===Ql&&-1!==Jl&&(Ql=globalThis.requestAnimationFrame(uh))}function sh(){$l&&-1!==Jl&&($l=!1)}function ah(){$l=!0}function uh(t){var e=th[Jl].stage;Ul.update(t,e),Ul.draw(e),-1!==Ql&&(Ql=globalThis.requestAnimationFrame(uh))}function lh(){globalThis.cancelAnimationFrame(Ql),Ql=-1}function hh(t){lh(),th[Jl]&&th[Jl].stage.destroy(),th[t]&&(th[Jl=t].stage.reset.apply(th[Jl].stage,ih),oh(),Do(lo),nh&&nh(),Ul.repaint())}Fo(ro,(function(){ch.set(ch.LOADING,new Zl),ch.set(ch.DEFAULT,new Kl),Fo(ho,(function(){ch.change(ch.DEFAULT,!0)})),"function"==typeof globalThis.addEventListener&&(globalThis.addEventListener("blur",(function(){ch.pause(!0)}),!1),globalThis.addEventListener("focus",(function(){ch.resume(!0),Js()}),!1)),void 0!==globalThis.document&&"function"==typeof globalThis.document.addEventListener&&globalThis.document.addEventListener("visibilitychange",(function(){"visible"===globalThis.document.visibilityState?ch.resume(!0):ch.pause(!0)}),!1)}));var ch={LOADING:0,MENU:1,READY:2,PLAY:3,GAMEOVER:4,GAME_END:5,SCORE:6,CREDITS:7,SETTINGS:8,DEFAULT:9,USER:100,stop:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Jl!==this.LOADING&&this.isRunning()&&(lh(),!0===t&&t(),rh=globalThis.performance.now(),Do(ao))},pause:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Jl===this.LOADING||this.isPaused()||(ah(),!0===t&&Qa(),rh=globalThis.performance.now(),Do(oo))},restart:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRunning()||(oh(),!0===t&&$a(),rh=globalThis.performance.now()-rh,Ul.repaint(),Do(uo,rh))},resume:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isPaused()&&(sh(),!0===t&&$a(),rh=globalThis.performance.now()-rh,Do(so,rh))},isRunning:function(){return-1!==Ql},isPaused:function(){return $l},set:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!(e instanceof Kl))throw new Error(e+" is not an instance of me.Stage");th[t]={},th[t].stage=e,th[t].transition=!0,!0===n&&this.change(t)},get:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jl;return void 0!==th[t]?th[t].stage:void 0},current:function(){return this.get()},transition:function(t,e,n){"fade"===t&&(eh.color=e,eh.duration=n)},setTransition:function(t,e){th[t].transition=e},change:function(t,e){if(void 0===th[t])throw new Error("Undefined Stage for state '"+t+"'");this.isCurrent(t)||(ih=null,arguments.length>1&&(ih=Array.prototype.slice.call(arguments,1)),eh.duration&&th[t].transition?(nh=function(){Ul.viewport.fadeOut(eh.color,eh.duration)},Ul.viewport.fadeIn(eh.color,eh.duration,(function(){zr(hh,this,t)}))):!0===e?hh(t):zr(hh,this,t))},isCurrent:function(t){return Jl===t}};function fh(t,e,n){var i;if("string"!=typeof n)return n;switch(e){case"int":case"float":n=Number(n);break;case"bool":n="true"===n;break;default:if(!n||vr(n))n=!n||"true"===n;else if(pr(n))n=Number(n);else if(0===n.search(/^json:/i)){i=n.split(/^json:/i)[1];try{n=JSON.parse(i)}catch(t){throw new Error("Unable to parse JSON: "+i)}}else if(0===n.search(/^eval:/i)){i=n.split(/^eval:/i)[1];try{n=Function("'use strict';return ("+i+")")()}catch(t){throw new Error("Unable to evaluate: "+i)}}else((i=n.match(/^#([\da-fA-F])([\da-fA-F]{3})$/))||(i=n.match(/^#([\da-fA-F]{2})([\da-fA-F]{6})$/)))&&(n="#"+i[2]+i[1]);0===t.search(/^(ratio|anchorPoint)$/)&&"number"==typeof n&&(n={x:n,y:n})}return n}function dh(t,e,n){switch(n=n||"none",e=e||"none"){case"csv":return function(t){for(var e=t.replace("\n","").trim().split(","),n=[],i=0;i<e.length;i++)n.push(+e[i]);return n}(t);case"base64":var i=function(t,e){var n,i,r;e=e||1;var o=globalThis.atob(t.replace(/[^A-Za-z0-9\+\/\=]/g,"")),s=new Uint32Array(o.length/e);for(n=0,r=o.length/e;n<r;n++)for(s[n]=0,i=e-1;i>=0;--i)s[n]+=o.charCodeAt(n*e+i)<<(i<<3);return s}(t,4);return"none"===n?i:function(){throw new Error("GZIP/ZLIB compressed TMX Tile Map not supported!")}();case"none":return t;case"xml":throw new Error("XML encoding is deprecated, use base64 instead");default:throw new Error("Unknown layer encoding: "+e)}}function ph(t,e){var n=e.nodeName;switch(n){case"data":var i=vh(e);i.text=i.text||i.chunk.text,i.encoding=i.encoding||"xml",t.data=dh(i.text,i.encoding,i.compression),t.encoding="none";break;case"imagelayer":case"layer":case"objectgroup":case"group":var r=vh(e);r.type="layer"===n?"tilelayer":n,r.image&&(r.image=r.image.source),t.layers=t.layers||[],t.layers.push(r);break;case"animation":t.animation=vh(e).frames;break;case"frame":case"object":var o=n+"s";t[o]=t[o]||[],t[o].push(vh(e));break;case"tile":var s=vh(e);s.image&&(s.imagewidth=s.image.width,s.imageheight=s.image.height,s.image=s.image.source),t.tiles=t.tiles||{},t.tiles[s.id]=s;break;case"tileset":var a=vh(e);a.image&&(a.imagewidth=a.image.width,a.imageheight=a.image.height,a.image=a.image.source),t.tilesets=t.tilesets||[],t.tilesets.push(a);break;case"polygon":case"polyline":t[n]=[];for(var u,l=vh(e).points.split(" "),h=0;h<l.length;h++)u=l[h].split(","),t[n].push({x:+u[0],y:+u[1]});break;case"properties":t.properties=vh(e);break;case"property":var c=vh(e),f=void 0!==c.value?c.value:c.text;t[c.name]=fh(c.name,c.type||"string",f);break;default:t[n]=vh(e)}}function vh(t){var e={},n="";if(1===t.nodeType&&function(t,e){if(e.attributes&&e.attributes.length>0)for(var n=0;n<e.attributes.length;n++){var i=e.attributes.item(n);void 0!==i.name?t[i.name]=i.value:t[i.nodeName]=i.nodeValue}}(e,t),t.hasChildNodes())for(var i=0;i<t.childNodes.length;i++){var r=t.childNodes.item(i);switch(r.nodeType){case 1:ph(e,r);break;case 3:n+=r.nodeValue.trim()}}return n&&(e.text=n),e}function yh(t,e){var n=e.properties,i=e.propertytypes;if(void 0!==n)for(var r in n)if(n.hasOwnProperty(r)){var o="string",s=r,a=n[r];void 0!==n[r].name&&(s=n[r].name),void 0!==i?o=i[r]:void 0!==n[r].type&&(o=n[r].type),void 0!==n[r].value&&(a=n[r].value),t[s]=fh(s,o,a)}}var gh=536870911,mh=function(t){o(n,t);var e=a(n);function n(t,i,r,o){var s,a,u;if(c(this,n),s=e.call(this),o.isCollection){var l=o.getTileImage(r&gh);a=l.width,u=l.height}else a=o.tilewidth,u=o.tileheight;return s.setMinMax(0,0,a,u),s.tileset=o,s.currentTransform=null,s.col=t,s.row=i,s.tileId=r,s.flippedX=0!=(2147483648&s.tileId),s.flippedY=0!=(1073741824&s.tileId),s.flippedAD=0!=(536870912&s.tileId),s.flipped=s.flippedX||s.flippedY||s.flippedAD,!0===s.flipped&&(null===s.currentTransform&&(s.currentTransform=new to),s.setTileTransform(s.currentTransform.identity())),s.tileId&=gh,s}return d(n,[{key:"setTileTransform",value:function(t){t.translate(this.width/2,this.height/2),this.flippedAD&&(t.rotate(-90*Math.PI/180),t.scale(-1,1)),this.flippedX&&t.scale(this.flippedAD?1:-1,this.flippedAD?-1:1),this.flippedY&&t.scale(this.flippedAD?-1:1,this.flippedAD?1:-1),t.translate(-this.width/2,-this.height/2)}},{key:"getRenderable",value:function(t){var e,n=this.tileset;if(n.animations.has(this.tileId)){var i=[],r=[];n.animations.get(this.tileId).frames.forEach((function(t){r.push(t.tileid),i.push({name:""+t.tileid,delay:t.duration})})),(e=n.texture.createAnimationFromName(r,t)).addAnimation(this.tileId-n.firstgid,i),e.setCurrentAnimation(this.tileId-n.firstgid)}else if(!0===n.isCollection){var o=n.getTileImage(this.tileId);(e=new tc(0,0,Object.assign({image:o}))).anchorPoint.set(0,0),e.scale(t.width/this.width,t.height/this.height),void 0!==t.rotation&&(e.anchorPoint.set(.5,.5),e.currentTransform.rotate(t.rotation),e.currentTransform.translate(t.width/2,t.height/2),t.rotation=void 0)}else(e=n.texture.createSpriteFromName(this.tileId-n.firstgid,t)).anchorPoint.set(0,0);return this.setTileTransform(e.currentTransform),e}}]),n}(za),bh=function(t){o(n,t);var e=a(n);function n(t){var i;return c(this,n),(i=e.call(this,t)).context=i.getContext2d(i.getScreenCanvas(),i.settings.transparent),i.settings.doubleBuffering?(i.backBufferCanvas=Oc(i.settings.width,i.settings.height,!0),i.backBufferContext2D=i.getContext2d(i.backBufferCanvas)):(i.backBufferCanvas=i.getScreenCanvas(),i.backBufferContext2D=i.context),i.setBlendMode(i.settings.blendMode),i.setColor(i.currentColor),i.cache=new bc,!1===i.settings.textureSeamFix||i.settings.antiAlias||(i.uvOffset=1),i.getScreenCanvas().addEventListener("contextlost",(function(t){t.preventDefault(),i.isContextValid=!1,Do(jo,l(i))}),!1),i.getScreenCanvas().addEventListener("contextrestored",(function(){i.isContextValid=!0,Do(Bo,l(i))}),!1),i}return d(n,[{key:"reset",value:function(){i(h(n.prototype),"reset",this).call(this),this.clearColor(this.currentColor,!0!==this.settings.transparent)}},{key:"resetTransform",value:function(){this.backBufferContext2D.setTransform(1,0,0,1,0,0)}},{key:"setBlendMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",e=arguments.length>1?arguments[1]:void 0;switch(e=e||this.getContext(),this.currentBlendMode=t,t){case"screen":e.globalCompositeOperation="screen";break;case"lighter":case"additive":e.globalCompositeOperation="lighter";break;case"multiply":e.globalCompositeOperation="multiply";break;default:e.globalCompositeOperation="source-over",this.currentBlendMode="normal"}this.settings.doubleBuffering&&this.settings.transparent&&(this.context.globalCompositeOperation="copy")}},{key:"clear",value:function(){this.settings.transparent&&this.clearColor("rgba(0,0,0,0)",!0)}},{key:"flush",value:function(){this.settings.doubleBuffering&&this.context.drawImage(this.backBufferCanvas,0,0)}},{key:"clearColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000000",e=arguments.length>1?arguments[1]:void 0;this.save(),this.resetTransform(),this.backBufferContext2D.globalCompositeOperation=e?"copy":"source-over",this.backBufferContext2D.fillStyle=t instanceof Qr?t.toRGBA():t,this.fillRect(0,0,this.backBufferCanvas.width,this.backBufferCanvas.height),this.restore()}},{key:"clearRect",value:function(t,e,n,i){this.getContext().clearRect(t,e,n,i)}},{key:"createPattern",value:function(t,e){return this.getContext().createPattern(t,e)}},{key:"drawImage",value:function(t,e,n,i,r,o,s,a,u){if(!(this.getGlobalAlpha()<1/255)){var l=this.getContext();void 0===i?(i=a=t.width,r=u=t.height,o=e,s=n,e=0,n=0):void 0===o&&(o=e,s=n,a=i,u=r,i=t.width,r=t.height,e=0,n=0),!1===this.settings.subPixel&&(o=~~o,s=~~s);var h=t,c=this.currentTint.toArray();1===c[0]&&1===c[1]&&1===c[2]||(h=this.cache.tint(t,this.currentTint.toRGB())),l.drawImage(h,e,n,i,r,o,s,a,u)}}},{key:"drawPattern",value:function(t,e,n,i,r){if(!(this.getGlobalAlpha()<1/255)){var o=this.getContext(),s=o.fillStyle;o.fillStyle=t,o.fillRect(e,n,i,r),o.fillStyle=s}}},{key:"strokeArc",value:function(t,e,n,i,r,o){var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!(this.getGlobalAlpha()<1/255)){var a=this.getContext();a.translate(t,e),a.beginPath(),a.arc(0,0,n,i,r,o||!1),a[!0===s?"fill":"stroke"](),a.translate(-t,-e)}}},{key:"fillArc",value:function(t,e,n,i,r,o){this.strokeArc(t,e,n,i,r,o||!1,!0)}},{key:"strokeEllipse",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(this.getGlobalAlpha()<1/255)){var o=this.getContext(),s=n,a=i,u=t-s,l=t+s,h=e-a,c=e+a,f=.551784*s,d=.551784*a,p=t-f,v=t+f,y=e-d,g=e+d;o.beginPath(),o.moveTo(t,h),o.bezierCurveTo(v,h,l,y,l,e),o.bezierCurveTo(l,g,v,c,t,c),o.bezierCurveTo(p,c,u,g,u,e),o.bezierCurveTo(u,y,p,h,t,h),o[!0===r?"fill":"stroke"](),o.closePath()}}},{key:"fillEllipse",value:function(t,e,n,i){this.strokeEllipse(t,e,n,i,!0)}},{key:"strokeLine",value:function(t,e,n,i){if(!(this.getGlobalAlpha()<1/255)){var r=this.getContext();r.beginPath(),r.moveTo(t,e),r.lineTo(n,i),r.stroke()}}},{key:"fillLine",value:function(t,e,n,i){this.strokeLine(t,e,n,i)}},{key:"strokePolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(this.getGlobalAlpha()<1/255)){var n,i=this.getContext();this.translate(t.pos.x,t.pos.y),i.beginPath(),i.moveTo(t.points[0].x,t.points[0].y);for(var r=1;r<t.points.length;r++)n=t.points[r],i.lineTo(n.x,n.y);i.lineTo(t.points[0].x,t.points[0].y),i[!0===e?"fill":"stroke"](),i.closePath(),this.translate(-t.pos.x,-t.pos.y)}}},{key:"fillPolygon",value:function(t){this.strokePolygon(t,!0)}},{key:"strokeRect",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(this.getGlobalAlpha()<1/255)){var o=this.getContext();o[!0===r?"fillRect":"strokeRect"](t,e,n,i)}}},{key:"fillRect",value:function(t,e,n,i){this.strokeRect(t,e,n,i,!0)}},{key:"strokeRoundRect",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!(this.getGlobalAlpha()<1/255)){var s=this.getContext();s.beginPath(),s.roundRect(t,e,n,i,r),s[!0===o?"fill":"stroke"]()}}},{key:"fillRoundRect",value:function(t,e,n,i,r){this.strokeRoundRect(t,e,n,i,r,!0)}},{key:"getContext",value:function(){return this.backBufferContext2D}},{key:"getFontContext",value:function(){return this.getContext()}},{key:"save",value:function(){this.backBufferContext2D.save()}},{key:"restore",value:function(){this.backBufferContext2D.restore(),this.currentColor.glArray[3]=this.getGlobalAlpha(),this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=this.backBufferCanvas.width,this.currentScissor[3]=this.backBufferCanvas.height}},{key:"rotate",value:function(t){this.backBufferContext2D.rotate(t)}},{key:"scale",value:function(t,e){this.backBufferContext2D.scale(t,e)}},{key:"setColor",value:function(t){this.backBufferContext2D.strokeStyle=this.backBufferContext2D.fillStyle=t instanceof Qr?t.toRGBA():t}},{key:"setGlobalAlpha",value:function(t){this.backBufferContext2D.globalAlpha=this.currentColor.glArray[3]=t}},{key:"getGlobalAlpha",value:function(){return this.backBufferContext2D.globalAlpha}},{key:"setLineWidth",value:function(t){this.backBufferContext2D.lineWidth=t}},{key:"setTransform",value:function(t){this.resetTransform(),this.transform(t)}},{key:"transform",value:function(t){var e=t.toArray(),n=e[0],i=e[1],r=e[3],o=e[4],s=e[6],a=e[7];!1===this.settings.subPixel&&(s|=0,a|=0),this.backBufferContext2D.transform(n,i,r,o,s,a)}},{key:"translate",value:function(t,e){!1===this.settings.subPixel?this.backBufferContext2D.translate(~~t,~~e):this.backBufferContext2D.translate(t,e)}},{key:"clipRect",value:function(t,e,n,i){var r=this.backBufferCanvas;if(0!==t||0!==e||n!==r.width||i!==r.height){var o=this.currentScissor;if(o[0]!==t||o[1]!==e||o[2]!==n||o[3]!==i){var s=this.backBufferContext2D;s.beginPath(),s.rect(t,e,n,i),s.clip(),o[0]=t,o[1]=e,o[2]=n,o[3]=i}}}},{key:"setMask",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getContext();if(0===this.maskLevel)n.save(),n.beginPath();else if(t instanceof Da)n.roundRect(t.top,t.left,t.width,t.height,t.radius);else if(t instanceof Ba||t instanceof za)n.rect(t.top,t.left,t.width,t.height);else if(t instanceof Fa){var i=t.pos.x,r=t.pos.y,o=t.radiusV.x,s=t.radiusV.y,a=i-o,u=i+o,l=r-s,h=r+s,c=.551784*o,f=.551784*s,d=i-c,p=i+c,v=r-f,y=r+f;n.moveTo(i,l),n.bezierCurveTo(p,l,u,v,u,r),n.bezierCurveTo(u,y,p,h,i,h),n.bezierCurveTo(d,h,a,y,a,r),n.bezierCurveTo(a,v,d,l,i,l)}else{var g,m=t.pos.x,b=t.pos.y;n.moveTo(m+t.points[0].x,b+t.points[0].y);for(var x=1;x<t.points.length;x++)g=t.points[x],n.lineTo(m+g.x,b+g.y)}this.maskLevel++,!0===e?(n.closePath(),n.globalCompositeOperation="destination-atop",n.fill()):n.clip()}},{key:"clearMask",value:function(){this.maskLevel>0&&(this.maskLevel=0,this.getContext().restore())}}]),n}(Va);var xh=function(t){o(n,t);var e=a(n);function n(t,i,r,o,s,a,u){var h;c(this,n),(h=e.call(this,0,0,0,0)).tilewidth=i.tilewidth||r,h.tileheight=i.tileheight||o,h.orientation=s,h.tilesets=a,h.tileset=h.tilesets?h.tilesets.getTilesetByIndex(0):null,h.maxTileSize={width:0,height:0};for(var f=0;f<h.tilesets.length;f++){var d=h.tilesets.getTilesetByIndex(f);h.maxTileSize.width=Math.max(h.maxTileSize.width,d.tilewidth),h.maxTileSize.height=Math.max(h.maxTileSize.height,d.tileheight)}h.animatedTilesets=[],h.isAnimated=!1,h.renderorder=i.renderorder||"right-down",h.pos.z=u,h.anchorPoint.set(0,0),h.name=i.name,h.cols=+i.width,h.rows=+i.height;var p=void 0!==i.visible?+i.visible:1;return h.setOpacity(p?+i.opacity:0),"string"==typeof i.tintcolor&&h.tint.parseHex(i.tintcolor,!0),"isometric"===h.orientation?(h.width=(h.cols+h.rows)*(h.tilewidth/2),h.height=(h.cols+h.rows)*(h.tileheight/2)):(h.width=h.cols*h.tilewidth,h.height=h.rows*h.tileheight),yh(l(h),i),void 0===h.preRender&&(h.preRender=Ul.world.preRender),h.setRenderer(t.getRenderer()),function(t,e){var n=0;!function(t){t.layerData=new Array(t.cols);for(var e=0;e<t.cols;e++){t.layerData[e]=new Array(t.rows);for(var n=0;n<t.rows;n++)t.layerData[e][n]=null}}(t);for(var i=0;i<t.rows;i++)for(var r=0;r<t.cols;r++){var o=e[n++];0!==o&&(t.layerData[r][i]=t.getTileById(o,r,i))}}(l(h),dh(i.data,i.encoding,i.compression)),h}return d(n,[{key:"onActivateEvent",value:function(){if(void 0===this.animatedTilesets&&(this.animatedTilesets=[]),this.tilesets)for(var t=this.tilesets.tilesets,e=0;e<t.length;e++)t[e].isAnimated&&this.animatedTilesets.push(t[e]);this.isAnimated=this.animatedTilesets.length>0,this.isAnimated&&(this.preRender=!1),this.getBounds().addBounds(this.getRenderer().getBounds(),!0),this.getBounds().shift(this.pos),!0!==this.preRender||this.canvasRenderer||(this.canvasRenderer=new bh({canvas:Oc(this.width,this.height),widht:this.width,heigth:this.height,transparent:!0}),function(t,e){for(var n=0;n<t.rows;n++)for(var i=0;i<t.cols;i++){var r=t.layerData[i][n];r instanceof mh&&t.getRenderer().drawTile(e,i,n,r)}}(this,this.canvasRenderer))}},{key:"onDeactivateEvent",value:function(){this.animatedTilesets=void 0}},{key:"setRenderer",value:function(t){this.renderer=t}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getTileId",value:function(t,e){var n=this.getTile(t,e);return n?n.tileId:null}},{key:"getTile",value:function(t,e){var n=null;if(this.contains(t,e)){var i=this.getRenderer().pixelToTileCoords(t,e,Gr.pull("Vector2d"));n=this.cellAt(i.x,i.y),Gr.push(i)}return n}},{key:"setTile",value:function(t,e,n){return this.layerData[e][n]=t,t}},{key:"getTileById",value:function(t,e,n){return this.tileset.contains(t)||(this.tileset=this.tilesets.getTilesetByGid(t)),new mh(e,n,t,this.tileset)}},{key:"cellAt",value:function(t,e,n){var i=~~t,r=~~e,o=this.getRenderer();return!1===n||i>=0&&i<o.cols&&r>=0&&r<o.rows?this.layerData[i][r]:null}},{key:"clearTile",value:function(t,e){this.layerData[t][e]=null,this.preRender&&this.canvasRenderer.clearRect(t*this.tilewidth,e*this.tileheight,this.tilewidth,this.tileheight)}},{key:"update",value:function(t){if(this.isAnimated){for(var e=!1,n=0;n<this.animatedTilesets.length;n++)e=this.animatedTilesets[n].update(t)||e;return e}return!1}},{key:"draw",value:function(t,e){if(this.preRender){var n=Math.min(e.width,this.width),i=Math.min(e.height,this.height);t.drawImage(this.canvasRenderer.getCanvas(),e.pos.x,e.pos.y,n,i,e.pos.x,e.pos.y,n,i)}else this.getRenderer().drawTileLayer(t,this,e)}}]),n}(gl),wh=function(){function t(e,n,i,r){c(this,t),this.cols=e,this.rows=n,this.tilewidth=i,this.tileheight=r,this.bounds=new za}return d(t,[{key:"canRender",value:function(t){return this.tilewidth===t.tilewidth&&this.tileheight===t.tileheight}},{key:"getBounds",value:function(t){var e=t instanceof xh?Gr.pull("Bounds"):this.bounds;return e.setMinMax(0,0,this.cols*this.tilewidth,this.rows*this.tileheight),e}},{key:"pixelToTileCoords",value:function(t,e,n){return n}},{key:"tileToPixelCoords",value:function(t,e,n){return n}},{key:"drawTile",value:function(t,e,n,i){}},{key:"drawTileLayer",value:function(t,e,n){}}]),t}(),_h=function(t){o(n,t);var e=a(n);function n(t){return c(this,n),e.call(this,t.cols,t.rows,t.tilewidth,t.tileheight)}return d(n,[{key:"canRender",value:function(t){return"orthogonal"===t.orientation&&i(h(n.prototype),"canRender",this).call(this,t)}},{key:"pixelToTileCoords",value:function(t,e,n){return(n||new Hr).set(t/this.tilewidth,e/this.tileheight)}},{key:"tileToPixelCoords",value:function(t,e,n){return(n||new Hr).set(t*this.tilewidth,e*this.tileheight)}},{key:"adjustPosition",value:function(t){"number"==typeof t.gid&&(t.y-=t.height)}},{key:"drawTile",value:function(t,e,n,i){var r=i.tileset;r.drawTile(t,r.tileoffset.x+e*this.tilewidth,r.tileoffset.y+(n+1)*this.tileheight-r.tileheight,i)}},{key:"drawTileLayer",value:function(t,e,n){var i=1,r=1,o=this.pixelToTileCoords(Math.max(n.pos.x-(e.maxTileSize.width-e.tilewidth),0),Math.max(n.pos.y-(e.maxTileSize.height-e.tileheight),0),Gr.pull("Vector2d")).floorSelf(),s=this.pixelToTileCoords(n.pos.x+n.width+this.tilewidth,n.pos.y+n.height+this.tileheight,Gr.pull("Vector2d")).ceilSelf();switch(s.x=s.x>this.cols?this.cols:s.x,s.y=s.y>this.rows?this.rows:s.y,e.renderorder){case"right-up":s.y=o.y+(o.y=s.y)-s.y,r=-1;break;case"left-down":s.x=o.x+(o.x=s.x)-s.x,i=-1;break;case"left-up":s.x=o.x+(o.x=s.x)-s.x,s.y=o.y+(o.y=s.y)-s.y,i=-1,r=-1}for(var a=o.y;a!==s.y;a+=r)for(var u=o.x;u!==s.x;u+=i){var l=e.cellAt(u,a,!1);l&&this.drawTile(t,u,a,l)}Gr.push(o),Gr.push(s)}}]),n}(wh),kh=function(t){o(n,t);var e=a(n);function n(t){var i;return c(this,n),(i=e.call(this,t.cols,t.rows,t.tilewidth,t.tileheight)).hTilewidth=i.tilewidth/2,i.hTileheight=i.tileheight/2,i.originX=i.rows*i.hTilewidth,i}return d(n,[{key:"canRender",value:function(t){return"isometric"===t.orientation&&i(h(n.prototype),"canRender",this).call(this,t)}},{key:"getBounds",value:function(t){var e=t instanceof xh?Gr.pull("Bounds"):this.bounds;return e.setMinMax(0,0,(this.cols+this.rows)*(this.tilewidth/2),(this.cols+this.rows)*(this.tileheight/2)),e}},{key:"pixelToTileCoords",value:function(t,e,n){return(n||new Hr).set(e/this.tileheight+(t-this.originX)/this.tilewidth,e/this.tileheight-(t-this.originX)/this.tilewidth)}},{key:"tileToPixelCoords",value:function(t,e,n){return(n||new Hr).set((t-e)*this.hTilewidth+this.originX,(t+e)*this.hTileheight)}},{key:"adjustPosition",value:function(t){var e=t.x/this.hTilewidth,n=t.y/this.tileheight,i=Gr.pull("Vector2d");this.tileToPixelCoords(e,n,i),t.x=i.x,t.y=i.y,Gr.push(i)}},{key:"drawTile",value:function(t,e,n,i){var r=i.tileset;r.drawTile(t,(this.cols-1)*r.tilewidth+(e-n)*r.tilewidth>>1,-r.tilewidth+(e+n)*r.tileheight>>2,i)}},{key:"drawTileLayer",value:function(t,e,n){var i=e.tileset,r=this.pixelToTileCoords(n.pos.x-i.tilewidth,n.pos.y-i.tileheight,Gr.pull("Vector2d")).floorSelf(),o=this.pixelToTileCoords(n.pos.x+n.width+i.tilewidth,n.pos.y+n.height+i.tileheight,Gr.pull("Vector2d")).ceilSelf(),s=this.tileToPixelCoords(o.x,o.y,Gr.pull("Vector2d")),a=this.tileToPixelCoords(r.x,r.y,Gr.pull("Vector2d"));a.x-=this.hTilewidth,a.y+=this.tileheight;var u=a.y-n.pos.y>this.hTileheight,l=n.pos.x-a.x<this.hTilewidth;u&&(l?(r.x--,a.x-=this.hTilewidth):(r.y--,a.x+=this.hTilewidth),a.y-=this.hTileheight);for(var h=u^l,c=r.clone(),f=2*a.y;f-2*this.tileheight<2*s.y;f+=this.tileheight){c.setV(r);for(var d=a.x;d<s.x;d+=this.tilewidth){var p=e.cellAt(c.x,c.y);if(p){var v=(i=p.tileset).tileoffset;i.drawTile(t,v.x+d,v.y+f/2-i.tileheight,p)}c.x++,c.y--}h?(r.y++,a.x-=this.hTilewidth,h=!1):(r.x++,a.x+=this.hTilewidth,h=!0)}Gr.push(c),Gr.push(r),Gr.push(o),Gr.push(s),Gr.push(a)}}]),n}(wh),Th=[{x:0,y:0},{x:1,y:-1},{x:1,y:0},{x:2,y:0}],Eh=[{x:0,y:0},{x:-1,y:1},{x:0,y:1},{x:0,y:2}],Sh=function(t){o(n,t);var e=a(n);function n(t){var i;return c(this,n),(i=e.call(this,t.cols,t.rows,-2&t.tilewidth,-2&t.tileheight)).hexsidelength=t.hexsidelength||0,i.staggerX="x"===t.staggeraxis,i.staggerEven="even"===t.staggerindex,i.sidelengthx=0,i.sidelengthy=0,"hexagonal"===t.orientation&&(i.staggerX?i.sidelengthx=i.hexsidelength:i.sidelengthy=i.hexsidelength),i.sideoffsetx=(i.tilewidth-i.sidelengthx)/2,i.sideoffsety=(i.tileheight-i.sidelengthy)/2,i.columnwidth=i.sideoffsetx+i.sidelengthx,i.rowheight=i.sideoffsety+i.sidelengthy,i.centers=[new Hr,new Hr,new Hr,new Hr],i}return d(n,[{key:"canRender",value:function(t){return"hexagonal"===t.orientation&&i(h(n.prototype),"canRender",this).call(this,t)}},{key:"getBounds",value:function(t){var e=t instanceof xh?Gr.pull("Bounds"):this.bounds;return this.staggerX?(e.setMinMax(0,0,this.cols*this.columnwidth+this.sideoffsetx,this.rows*(this.tileheight+this.sidelengthy)),e.width>1&&(e.height+=this.rowheight)):(e.setMinMax(0,0,this.cols*(this.tilewidth+this.sidelengthx),this.rows*this.rowheight+this.sideoffsety),e.height>1&&(e.width+=this.columnwidth)),e}},{key:"doStaggerX",value:function(t){return this.staggerX&&1&t^this.staggerEven}},{key:"doStaggerY",value:function(t){return!this.staggerX&&1&t^this.staggerEven}},{key:"topLeft",value:function(t,e,n){var i=n||new Hr;return this.staggerX?1&t^this.staggerEven?i.set(t-1,e):i.set(t-1,e-1):1&e^this.staggerEven?i.set(t,e-1):i.set(t-1,e-1),i}},{key:"topRight",value:function(t,e,n){var i=n||new Hr;return this.staggerX?1&t^this.staggerEven?i.set(t+1,e):i.set(t+1,e-1):1&e^this.staggerEven?i.set(t+1,e-1):i.set(t,e-1),i}},{key:"bottomLeft",value:function(t,e,n){var i=n||new Hr;return this.staggerX?1&t^this.staggerEven?i.set(t-1,e+1):i.set(t-1,e):1&e^this.staggerEven?i.set(t,e+1):i.set(t-1,e+1),i}},{key:"bottomRight",value:function(t,e,n){var i=n||new Hr;return this.staggerX?1&t^this.staggerEven?i.set(t+1,e+1):i.set(t+1,e):1&e^this.staggerEven?i.set(t+1,e+1):i.set(t,e+1),i}},{key:"pixelToTileCoords",value:function(t,e,n){var i=n||new Hr;this.staggerX?t-=this.staggerEven?this.tilewidth:this.sideoffsetx:e-=this.staggerEven?this.tileheight:this.sideoffsety;var r,o,s,a,u=Gr.pull("Vector2d",Math.floor(t/(2*this.columnwidth)),Math.floor(e/(2*this.rowheight))),l=Gr.pull("Vector2d",t-u.x*(2*this.columnwidth),e-u.y*(2*this.rowheight));this.staggerX?(u.x=2*u.x,this.staggerEven&&++u.x):(u.y=2*u.y,this.staggerEven&&++u.y),this.staggerX?(s=(r=this.sidelengthx/2)+this.columnwidth,a=this.tileheight/2,this.centers[0].set(r,a),this.centers[1].set(s,a-this.rowheight),this.centers[2].set(s,a+this.rowheight),this.centers[3].set(s+this.columnwidth,a)):(o=this.sidelengthy/2,s=this.tilewidth/2,a=o+this.rowheight,this.centers[0].set(s,o),this.centers[1].set(s-this.columnwidth,a),this.centers[2].set(s+this.columnwidth,a),this.centers[3].set(s,a+this.rowheight));for(var h=0,c=Number.MAX_VALUE,f=0;f<4;++f){var d=this.centers[f].sub(l).length2();d<c&&(c=d,h=f)}var p=this.staggerX?Th:Eh;return i.set(u.x+p[h].x,u.y+p[h].y),Gr.push(u),Gr.push(l),i}},{key:"tileToPixelCoords",value:function(t,e,n){var i=Math.floor(t),r=Math.floor(e),o=n||new Hr;return this.staggerX?(o.y=r*(this.tileheight+this.sidelengthy),this.doStaggerX(i)&&(o.y+=this.rowheight),o.x=i*this.columnwidth):(o.x=i*(this.tilewidth+this.sidelengthx),this.doStaggerY(r)&&(o.x+=this.columnwidth),o.y=r*this.rowheight),o}},{key:"adjustPosition",value:function(t){"number"==typeof t.gid&&(t.y-=t.height)}},{key:"drawTile",value:function(t,e,n,i){var r=i.tileset,o=this.tileToPixelCoords(e,n,Gr.pull("Vector2d"));r.drawTile(t,r.tileoffset.x+o.x,r.tileoffset.y+o.y+(this.tileheight-r.tileheight),i),Gr.push(o)}},{key:"drawTileLayer",value:function(t,e,n){var i,r=this.pixelToTileCoords(n.pos.x,n.pos.y,Gr.pull("Vector2d"));r.sub(e.pos);var o=this.tileToPixelCoords(r.x+e.pos.x,r.y+e.pos.y,Gr.pull("Vector2d")),s=r.clone(),a=o.clone(),u=n.pos.y-o.y<this.sideoffsety,l=n.pos.x-o.x<this.sideoffsetx;u&&r.y--,l&&r.x--;var h=e.cols,c=e.rows;if(this.staggerX){r.x=Math.max(0,r.x),r.y=Math.max(0,r.y),o=this.tileToPixelCoords(r.x+e.pos.x,r.y+e.pos.y);for(var f=this.doStaggerX(r.x+e.pos.x);o.y<n.bottom&&r.y<c;){for(s.setV(r),a.setV(o);a.x<n.right&&s.x<h;s.x+=2)(i=e.cellAt(s.x,s.y,!1))&&i.tileset.drawTile(t,a.x,a.y,i),a.x+=this.tilewidth+this.sidelengthx;f?(r.x-=1,r.y+=1,o.x-=this.columnwidth,f=!1):(r.x+=1,o.x+=this.columnwidth,f=!0),o.y+=this.rowheight}Gr.push(s),Gr.push(a)}else{for(r.x=Math.max(0,r.x),r.y=Math.max(0,r.y),o=this.tileToPixelCoords(r.x+e.pos.x,r.y+e.pos.y),this.doStaggerY(r.y)&&(o.x-=this.columnwidth);o.y<n.bottom&&r.y<c;r.y++){for(s.setV(r),a.setV(o),this.doStaggerY(r.y)&&(a.x+=this.columnwidth);a.x<n.right&&s.x<h;s.x++)(i=e.cellAt(s.x,s.y,!1))&&i.tileset.drawTile(t,a.x,a.y,i),a.x+=this.tilewidth+this.sidelengthx;o.y+=this.rowheight}Gr.push(s),Gr.push(a)}Gr.push(r),Gr.push(o)}}]),n}(wh),Ah=function(t){o(n,t);var e=a(n);function n(){return c(this,n),e.apply(this,arguments)}return d(n,[{key:"canRender",value:function(t){return"staggered"===t.orientation&&i(h(n.prototype),"canRender",this).call(this,t)}},{key:"pixelToTileCoords",value:function(t,e,n){var i=n||new Hr,r=t,o=e;this.staggerX?r-=this.staggerEven?this.sideoffsetx:0:o-=this.staggerEven?this.sideoffsety:0;var s=Gr.pull("Vector2d",Math.floor(r/this.tilewidth),Math.floor(o/this.tileheight));this.staggerX?(s.x=2*s.x,this.staggerEven&&++s.x):(s.y=2*s.y,this.staggerEven&&++s.y);var a=Gr.pull("Vector2d",r-s.x*this.tilewidth,o-s.y*this.tileheight),u=a.x*(this.tileheight/this.tilewidth);return this.sideoffsety-u>a.y&&(s=this.topLeft(s.x,s.y,s)),-this.sideoffsety+u>a.y&&(s=this.topRight(s.x,s.y,s)),this.sideoffsety+u<a.y&&(s=this.bottomLeft(s.x,s.y,s)),3*this.sideoffsety-u<a.y&&(s=this.bottomRight(s.x,s.y,s)),(i=this.tileToPixelCoords(s.x,s.y,i)).set(t-i.x,e-i.y),i.set(i.x-this.tilewidth/2,i.y*(this.tilewidth/this.tileheight)),i.div(this.tilewidth/Math.sqrt(2)).rotate(Pr(-45)).add(s),Gr.push(s),Gr.push(a),i}}]),n}(Sh),Ph=function(){function t(e){c(this,t);var n=0;if(this.TileProperties=[],this.imageCollection=[],this.firstgid=this.lastgid=+e.firstgid,void 0!==e.source){var i=e.source,r=Fr(i);if(("tsx"===r||"json"===r)&&!(e=$h.getTMX(Dr(i))))throw new Error(i+" external TSX/JSON tileset not found")}this.name=e.name,this.tilewidth=+e.tilewidth,this.tileheight=+e.tileheight,this.spacing=+e.spacing||0,this.margin=+e.margin||0,this.tileoffset=new Hr,this.isAnimated=!1,this.isCollection=!1,this.animations=new Map,this._lastUpdate=0;var o=e.tiles;for(n in o)if(o.hasOwnProperty(n)){if("animation"in o[n]&&(this.isAnimated=!0,this.animations.set(o[+n].animation[0].tileid,{dt:0,idx:0,frames:o[+n].animation,cur:o[+n].animation[0]})),"properties"in o[n])if(Array.isArray(o[n].properties)){var s={};for(var a in o[n].properties)s[o[n].properties[a].name]=o[n].properties[a].value;this.setTileProperty(+o[n].id+this.firstgid,s)}else this.setTileProperty(+n+this.firstgid,o[n].properties);if("image"in o[n]){var u=$h.getImage(o[n].image);if(!u)throw new Error("melonJS: '"+o[n].image+"' file for tile '"+(+n+this.firstgid)+"' not found!");this.imageCollection[+n+this.firstgid]=u}}this.isCollection=this.imageCollection.length>0;var l=e.tileoffset;l&&(this.tileoffset.x=+l.x,this.tileoffset.y=+l.y);var h=e.tileproperties;if(h)for(n in h)h.hasOwnProperty(n)&&this.setTileProperty(+n+this.firstgid,h[n]);if(!1===this.isCollection){if(this.image=$h.getImage(e.image),!this.image)throw new Error("melonJS: '"+e.image+"' file for tileset '"+this.name+"' not found!");this.texture=Pc.cache.get(this.image,{framewidth:this.tilewidth,frameheight:this.tileheight,margin:this.margin,spacing:this.spacing}),this.atlas=this.texture.getAtlas();var f=+e.columns||Math.round(this.image.width/(this.tilewidth+this.spacing)),d=Math.round(this.image.height/(this.tileheight+this.spacing));e.tilecount%f>0&&++d,this.lastgid=this.firstgid+(f*d-1||0),e.tilecount&&this.lastgid-this.firstgid+1!=+e.tilecount&&console.warn("Computed tilecount ("+(this.lastgid-this.firstgid+1)+") does not match expected tilecount ("+e.tilecount+")")}}return d(t,[{key:"getTileImage",value:function(t){return this.imageCollection[t]}},{key:"setTileProperty",value:function(t,e){this.TileProperties[t]=e}},{key:"contains",value:function(t){return t>=this.firstgid&&t<=this.lastgid}},{key:"getViewTileId",value:function(t){var e=t-this.firstgid;return this.animations.has(e)?this.animations.get(e).cur.tileid:e}},{key:"getTileProperties",value:function(t){return this.TileProperties[t]}},{key:"update",value:function(t){var e=0,n=Fc.getTime(),i=!1;return this._lastUpdate!==n&&(this._lastUpdate=n,this.animations.forEach((function(n){for(n.dt+=t,e=n.cur.duration;n.dt>=e;)n.dt-=e,n.idx=(n.idx+1)%n.frames.length,n.cur=n.frames[n.idx],e=n.cur.duration,i=!0}))),i}},{key:"drawTile",value:function(t,e,n,i){if(i.flipped&&(t.save(),t.translate(e,n),t.transform(i.currentTransform),e=n=0),!0===this.isCollection)t.drawImage(this.imageCollection[i.tileId],0,0,i.width,i.height,e,n,i.width,i.height);else{var r=this.atlas[this.getViewTileId(i.tileId)].offset;t.drawImage(this.image,r.x,r.y,this.tilewidth,this.tileheight,e,n,this.tilewidth+t.uvOffset,this.tileheight+t.uvOffset)}i.flipped&&t.restore()}}]),t}(),Oh=function(){function t(){c(this,t),this.tilesets=[],this.length=0}return d(t,[{key:"add",value:function(t){this.tilesets.push(t),this.length++}},{key:"getTilesetByIndex",value:function(t){return this.tilesets[t]}},{key:"getTilesetByGid",value:function(t){var e=-1;t&=536870911;for(var n=0,i=this.tilesets.length;n<i;n++){if(this.tilesets[n].contains(t))return this.tilesets[n];this.tilesets[n].firstgid===this.tilesets[n].lastgid&&t>=this.tilesets[n].firstgid&&(e=n)}if(-1!==e)return this.tilesets[e];throw new Error("no matching tileset found for gid "+t)}}]),t}(),Ch=function(){function t(e,n,i){c(this,t),this.points=void 0,this.name=n.name,this.x=+n.x,this.y=+n.y,this.z=+i,this.width=+n.width||0,this.height=+n.height||0,this.gid=+n.gid||null,this.tintcolor=n.tintcolor,this.type=n.type,this.type=n.type,this.rotation=Pr(+n.rotation||0),this.id=+n.id||void 0,this.orientation=e.orientation,this.shapes=void 0,this.isEllipse=!1,this.isPolygon=!1,this.isPolyLine=!1,"number"==typeof this.gid?this.setTile(e.tilesets):void 0!==n.ellipse?this.isEllipse=!0:void 0!==n.polygon?(this.points=n.polygon,this.isPolygon=!0):void 0!==n.polyline&&(this.points=n.polyline,this.isPolyLine=!0),void 0!==n.text?(this.text=n.text,this.text.font=n.text.fontfamily||"sans-serif",this.text.size=n.text.pixelsize||16,this.text.fillStyle=n.text.color||"#000000",this.text.textAlign=n.text.halign||"left",this.text.textBaseline=n.text.valign||"top",this.text.width=this.width,this.text.height=this.height,yh(this.text,n)):(yh(this,n),this.shapes||(this.shapes=this.parseTMXShapes())),e.isEditor||e.getRenderer().adjustPosition(this)}return d(t,[{key:"setTile",value:function(t){var e=t.getTilesetByGid(this.gid);!1===e.isCollection&&(this.width=this.framewidth=e.tilewidth,this.height=this.frameheight=e.tileheight),this.tile=new mh(this.x,this.y,this.gid,e)}},{key:"parseTMXShapes",value:function(){var t=0,e=[];if(!0===this.isEllipse)e.push(Gr.pull("Ellipse",this.width/2,this.height/2,this.width,this.height).rotate(this.rotation));else if(!0===this.isPolygon){var n=Gr.pull("Polygon",0,0,this.points);if(!1===n.isConvex())throw new Error("collision polygones in Tiled should be defined as Convex");e.push(n.rotate(this.rotation))}else if(!0===this.isPolyLine){var i,r,o=this.points,s=o.length-1;for(t=0;t<s;t++)i=Gr.pull("Vector2d",o[t].x,o[t].y),r=Gr.pull("Vector2d",o[t+1].x,o[t+1].y),0!==this.rotation&&(i=i.rotate(this.rotation),r=r.rotate(this.rotation)),e.push(Gr.pull("Line",0,0,[i,r]))}else e.push(Gr.pull("Polygon",0,0,[Gr.pull("Vector2d"),Gr.pull("Vector2d",this.width,0),Gr.pull("Vector2d",this.width,this.height),Gr.pull("Vector2d",0,this.height)]).rotate(this.rotation));if("isometric"===this.orientation)for(t=0;t<e.length;t++)e[t].toIso();return e}},{key:"getObjectPropertyByName",value:function(t){return this[t]}}]),t}(),Mh=function(){function t(e,n,i){var r=this;c(this,t),this.name=n.name,this.width=n.width||0,this.height=n.height||0,this.tintcolor=n.tintcolor,this.z=i,this.objects=[];var o=void 0===n.visible||n.visible;this.opacity=!0===o?Or(+n.opacity||1,0,1):0,yh(this,n),n.objects&&n.objects.forEach((function(t){t.tintcolor=r.tintcolor,r.objects.push(new Ch(e,t,i))})),n.layers&&n.layers.forEach((function(t){var n=new xh(e,t,e.tilewidth,e.tileheight,e.orientation,e.tilesets,i++);n.setRenderer(e.getRenderer()),r.width=Math.max(r.width,n.width),r.height=Math.max(r.height,n.height),r.objects.push(n)}))}return d(t,[{key:"destroy",value:function(){this.objects=null}},{key:"getObjectCount",value:function(){return this.objects.length}},{key:"getObjectByIndex",value:function(t){return this.objects[t]}}]),t}();var Rh=function(){function t(e,n){if(c(this,t),this.data=n,this.name=e,this.cols=+n.width,this.rows=+n.height,this.tilewidth=+n.tilewidth,this.tileheight=+n.tileheight,this.infinite=+n.infinite,this.orientation=n.orientation,this.renderorder=n.renderorder||"right-down",this.version=n.version,this.tiledversion=n.tiledversion,this.tilesets=null,void 0===this.layers&&(this.layers=[]),void 0===this.objectGroups&&(this.objectGroups=[]),this.isEditor="melon-editor"===n.editor,this.nextobjectid=+n.nextobjectid||void 0,this.hexsidelength=+n.hexsidelength,this.staggeraxis=n.staggeraxis,this.staggerindex=n.staggerindex,this.bounds=this.getRenderer().getBounds().clone(),this.width=this.bounds.width,this.height=this.bounds.height,this.backgroundcolor=n.backgroundcolor,yh(this,n),this.initialized=!1,1===this.infinite)throw new Error("Tiled Infinite Map not supported!")}return d(t,[{key:"getRenderer",value:function(){return void 0!==this.renderer&&this.renderer.canRender(this)||(this.renderer=function(t){switch(t.orientation){case"orthogonal":return new _h(t);case"isometric":return new kh(t);case"hexagonal":return new Sh(t);case"staggered":return new Ah(t);default:throw new Error(t.orientation+" type TMX Tile Map not supported!")}}(this)),this.renderer}},{key:"getBounds",value:function(){return this.bounds}},{key:"readMapObjects",value:function(t){var e=this;if(!0!==this.initialized){var n=0;this.tilesets||(this.tilesets=new Oh),void 0!==t.tilesets&&t.tilesets.forEach((function(t){e.tilesets.add(function(t){return new Ph(t)}(t))})),this.background_image&&this.layers.push(Gr.pull("ImageLayer",0,0,{name:"background_image",image:this.background_image,z:n++})),t.layers.forEach((function(t){switch(t.type){case"imagelayer":e.layers.push(function(t,e,n){yh(e.properties,e);var i=Gr.pull("ImageLayer",+e.offsetx||+e.x||0,+e.offsety||+e.y||0,Object.assign({name:e.name,image:e.image,ratio:Gr.pull("Vector2d",+e.parallaxx||1,+e.parallaxy||1),tint:void 0!==e.tintcolor?Gr.pull("Color").parseHex(e.tintcolor,!0):void 0,z:n},e.properties)),r=void 0===e.visible||e.visible;return i.setOpacity(r?+e.opacity:0),i}(0,t,n++));break;case"tilelayer":e.layers.push(function(t,e,n){return new xh(t,e,t.tilewidth,t.tileheight,t.orientation,t.tilesets,n)}(e,t,n++));break;case"objectgroup":case"group":e.objectGroups.push(function(t,e,n){return new Mh(t,e,n)}(e,t,n++))}})),this.initialized=!0}}},{key:"addTo",value:function(t,e,n){var i=t.autoSort,r=t.autoDepth,o=this.getBounds();function s(e,n){Ul.viewport.setBounds(0,0,Math.max(o.width,e),Math.max(o.height,n)),t.pos.set(Math.max(0,~~((e-o.width)/2)),Math.max(0,~~((n-o.height)/2)),t.pos.z)}t.autoSort=!1,t.autoDepth=!1,this.backgroundcolor&&t.backgroundColor.parseCSS(this.backgroundcolor),this.getLayers().forEach((function(e){t.addChild(e)})),this.getObjects(e).forEach((function(e){t.addChild(e)})),t.resize(this.bounds.width,this.bounds.height),t.sort(!0),!0===n&&(zo(Mo,s),s(Ul.viewport.width,Ul.viewport.height),Fo(Mo,s,this)),t.autoSort=i,t.autoDepth=r}},{key:"getObjects",value:function(t){var e,n=[],i=!1;this.readMapObjects(this.data);for(var r=0;r<this.objectGroups.length;r++){var o=this.objectGroups[r];i=o.name.toLowerCase().includes("collision"),!1===t&&((e=new jl(0,0,this.width,this.height)).anchorPoint.set(0,0),e.name=o.name,e.pos.z=o.z,e.setOpacity(o.opacity),e.autoSort=!1,e.autoDepth=!1);for(var s=0;s<o.objects.length;s++){var a,u,l=o.objects[s];void 0===l.anchorPoint&&(l.anchorPoint={x:0,y:0}),void 0!==l.tintcolor&&(l.tint=Gr.pull("Color"),l.tint.parseHex(l.tintcolor,!0)),l instanceof xh?a=l:"object"===p(l.text)?(void 0===l.text.anchorPoint&&(l.text.anchorPoint=l.anchorPoint),(a=!0===l.text.bitmap?Gr.pull("BitmapText",l.x,l.y,l.text):Gr.pull("Text",l.x,l.y,l.text)).pos.z=l.z):"object"===p(l.tile)?(void 0===(u=l.shapes)&&(u=Gr.pull("Polygon",0,0,[Gr.pull("Vector2d",0,0),Gr.pull("Vector2d",this.width,0),Gr.pull("Vector2d",this.width,this.height)])),(a=l.tile.getRenderable(l)).body=new Rl(a,u),a.body.setStatic(!0),a.pos.setMuted(l.x,l.y,l.z)):(void 0!==l.name&&""!==l.name?a=Gr.pull(l.name,l.x,l.y,l):(a=Gr.pull("Renderable",l.x,l.y,l.width,l.height),void 0===(u=l.shapes)&&(u=Gr.pull("Polygon",0,0,[Gr.pull("Vector2d",0,0),Gr.pull("Vector2d",this.width,0),Gr.pull("Vector2d",this.width,this.height)])),a.anchorPoint.set(0,0),a.name=l.name,a.type=l.type,a.id=l.id,a.body=new Rl(a,u),a.body.setStatic(!0),a.resize(a.body.getBounds().width,a.body.getBounds().height)),a.pos.z=l.z),i&&!l.name&&a.body&&(a.body.collisionType=Ml.types.WORLD_SHAPE,a.body.isStatic=!0),!1!==t?(!0===a.isRenderable&&(a.setOpacity(a.getOpacity()*o.opacity),a.renderable instanceof gl&&a.renderable.setOpacity(a.renderable.getOpacity()*o.opacity)),n.push(a)):e.addChild(a)}!1===t&&e.children.length>0&&(e.autoSort=!0,e.autoDepth=!0,n.push(e))}return n}},{key:"getLayers",value:function(){return this.readMapObjects(this.data),this.layers}},{key:"destroy",value:function(){this.tilesets=void 0,this.layers.length=0,this.objectGroups.length=0,this.initialized=!1}}]),t}(),Ih={},Lh=[],jh=0;function Bh(t,e,n){e.container.reset(),Ul.reset(),Ih[Dh.getCurrentLevelId()]&&Ih[Dh.getCurrentLevelId()].destroy(),jh=Lh.indexOf(t),function(t,e,n,i){var r=Ih[t];Bc.resetGUID(t,r.nextobjectid),e.anchorPoint.set(0,0),r.addTo(e,n,i)}(t,e.container,e.flatten,e.setViewportBounds),Do(bo,t),e.onLoaded(t),n&&ch.restart()}var Dh={add:function(t,e,n){if("tmx"===t)return null==Ih[e]&&(Ih[e]=new Rh(e,$h.getTMX(e)),Lh.push(e),n&&n(),!0);throw new Error("no level loader defined for format "+t)},load:function(t,e){if(e=Object.assign({container:Ul.world,onLoaded:Ul.onLevelLoaded,flatten:Ul.mergeGroup,setViewportBounds:!0},e||{}),void 0===Ih[t])throw new Error("level "+t+" not found");if(!(Ih[t]instanceof Rh))throw new Error("no level loader defined");return ch.isRunning()?(ch.stop(),Bc.function.defer(Bh,this,t,e,!0)):Bh(t,e),!0},getCurrentLevelId:function(){return Lh[jh]},getCurrentLevel:function(){return Ih[this.getCurrentLevelId()]},reload:function(t){return this.load(this.getCurrentLevelId(),t)},next:function(t){return jh+1<Lh.length&&this.load(Lh[jh+1],t)},previous:function(t){return jh-1>=0&&this.load(Lh[jh-1],t)},levelCount:function(){return Lh.length}},Fh={},Nh={},zh={},Uh={},Vh={},Gh=0,Hh=0,Yh=0;function Wh(t){if(Hh===Gh){if("function"!=typeof t&&!$h.onload)throw new Error("no load callback defined");clearTimeout(Yh);var e=t||$h.onload;setTimeout((function(){e(),Do(xo)}),300)}else Yh=setTimeout((function(){Wh(t)}),100)}function Xh(t,e,n){Fh[t.name]=new Image,"function"==typeof e&&(Fh[t.name].onload=e),"function"==typeof n&&(Fh[t.name].onerror=n),"string"==typeof $h.crossOrigin&&(Fh[t.name].crossOrigin=$h.crossOrigin),Fh[t.name].src=t.src+$h.nocache}function Kh(t,e,n){!0===gr(t.src)&&(t.src.startsWith("url(")||(t.src="url("+t.src+")"));var i=new FontFace(t.name,t.src);i.load().then((function(){document.fonts.add(i),document.body.style.fontFamily=t.name,"function"==typeof e&&e()}),(function(){"function"==typeof n&&n(t.name)}))}function qh(t,e,n){function i(e){Nh[t.name]=e,"tmx"===t.type&&Dh.add(t.type,t.name)}if(t.data)return i(t.data),void("function"==typeof e&&e());var r=new XMLHttpRequest,o=Fr(t.src);r.overrideMimeType&&("json"===o?r.overrideMimeType("application/json"):r.overrideMimeType("text/xml")),r.open("GET",t.src+$h.nocache,!0),r.withCredentials=$h.withCredentials,r.ontimeout=n,r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status||0===r.status&&r.responseText){var s=null;switch(o){case"xml":case"tmx":case"tsx":if(qo.match(/msie/i)||!r.responseXML){if(!globalThis.DOMParser)throw new Error("XML file format loading not supported, use the JSON file format instead");s=(new DOMParser).parseFromString(r.responseText,"text/xml")}else s=r.responseXML;var a=vh(s);switch(o){case"tmx":s=a.map;break;case"tsx":s=a.tilesets[0]}break;case"json":s=JSON.parse(r.responseText);break;default:throw new Error("TMX file format "+o+"not supported !")}i(s),"function"==typeof e&&e()}else"function"==typeof n&&n(t.name)},r.send()}function Zh(t,e,n){var i=new XMLHttpRequest;i.overrideMimeType&&i.overrideMimeType("application/json"),i.open("GET",t.src+$h.nocache,!0),i.withCredentials=$h.withCredentials,i.ontimeout=n,i.onreadystatechange=function(){4===i.readyState&&(200===i.status||0===i.status&&i.responseText?(Uh[t.name]=JSON.parse(i.responseText),"function"==typeof e&&e()):"function"==typeof n&&n(t.name))},i.send()}function Jh(t,e,n){var i=new XMLHttpRequest;i.open("GET",t.src+$h.nocache,!0),i.withCredentials=$h.withCredentials,i.responseType="arraybuffer",i.onerror=n,i.onload=function(){var n=i.response;if(n){for(var r=new Uint8Array(n),o=[],s=0;s<r.byteLength;s++)o[s]=String.fromCharCode(r[s]);zh[t.name]=o.join(""),"function"==typeof e&&e()}},i.send()}function Qh(t,e,n){var i=document.createElement("script");i.src=t.src,i.type="text/javascript","string"==typeof $h.crossOrigin&&(i.crossOrigin=$h.crossOrigin),i.defer=!0,"function"==typeof e&&(i.onload=function(){e()}),"function"==typeof n&&(i.onerror=function(){n(t.name)}),document.getElementsByTagName("body")[0].appendChild(i)}var $h={nocache:"",onload:void 0,onProgress:void 0,crossOrigin:void 0,withCredentials:!1,onResourceLoaded:function(t){var e=++Hh/Gh;this.onProgress&&this.onProgress(e,t),Do(wo,e,t)},onLoadingError:function(t){throw new Error("Failed loading resource "+t.src)},setNocache:function(t){this.nocache=t?"?"+~~(1e7*Math.random()):""},setBaseURL:function(t,e){"*"!==t?Vh[t]=e:(Vh.audio=e,Vh.binary=e,Vh.image=e,Vh.json=e,Vh.js=e,Vh.tmx=e,Vh.tsx=e)},preload:function(t,e){for(var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=0;i<t.length;i++)Gh+=this.load(t[i],this.onResourceLoaded.bind(this,t[i]),this.onLoadingError.bind(this,t[i]));void 0!==e&&(this.onload=e),!0===n&&ch.change(ch.LOADING),Wh(e)},load:function(t,e,n){switch(void 0!==Vh[t.type]&&(t.src=Vh[t.type]+t.src),t.type){case"binary":return Jh.call(this,t,e,n),1;case"image":return Xh.call(this,t,e,n),1;case"json":return Zh.call(this,t,e,n),1;case"js":return Qh.call(this,t,e,n),1;case"tmx":case"tsx":return qh.call(this,t,e,n),1;case"audio":return Za(t,!!t.stream,e,n),1;case"fontface":return Kh.call(this,t,e,n),1;default:throw new Error("load : unknown or invalid resource type : "+t.type)}},unload:function(t){switch(t.type){case"binary":return t.name in zh&&(delete zh[t.name],!0);case"image":return t.name in Fh&&(delete Fh[t.name],!0);case"json":return t.name in Uh&&(delete Uh[t.name],!0);case"js":case"fontface":return!0;case"tmx":case"tsx":return t.name in Nh&&(delete Nh[t.name],!0);case"audio":return iu(t.name);default:throw new Error("unload : unknown or invalid resource type : "+t.type)}},unloadAll:function(){var t;for(t in zh)zh.hasOwnProperty(t)&&this.unload({name:t,type:"binary"});for(t in Fh)Fh.hasOwnProperty(t)&&this.unload({name:t,type:"image"});for(t in Nh)Nh.hasOwnProperty(t)&&this.unload({name:t,type:"tmx"});for(t in Uh)Uh.hasOwnProperty(t)&&this.unload({name:t,type:"json"});ru()},getTMX:function(t){return(t=""+t)in Nh?Nh[t]:null},getBinary:function(t){return(t=""+t)in zh?zh[t]:null},getImage:function(t){return(t=Dr(""+t))in Fh?Fh[t]:null},getJSON:function(t){return(t=""+t)in Uh?Uh[t]:null}},tc=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;if(c(this,n),(o=e.call(this,t,i,0,0)).animationpause=!1,o.animationspeed=100,o.offset=Gr.pull("Vector2d",0,0),o.source=null,o.anim={},o.resetAnim=void 0,o.current={name:"default",length:0,offset:Gr.pull("Vector2d"),width:0,height:0,angle:0,idx:0},o.dt=0,o._flicker={isFlickering:!1,duration:0,callback:null,state:!1},r.image instanceof nc){if(o.source=r.image,o.image=o.source.getTexture(),o.textureAtlas=r.image,void 0!==r.region){var s=o.source.getRegion(r.region);if(!s)throw new Error("Texture - region for "+r.region+" not found");o.setRegion(s),o.current.width=r.framewidth||s.width,o.current.height=r.frameheight||s.height}}else{if(o.image="object"===p(r.image)?r.image:$h.getImage(r.image),!o.image)throw new Error("me.Sprite: '"+r.image+"' image/texture not found!");o.current.width=r.framewidth=r.framewidth||o.image.width,o.current.height=r.frameheight=r.frameheight||o.image.height,o.source=Pc.cache.get(o.image,r),o.textureAtlas=o.source.getAtlas()}return void 0!==r.atlas&&(o.textureAtlas=r.atlas,o.atlasIndices=r.atlasIndices),o.width=o.current.width,o.height=o.current.height,void 0!==r.flipX&&o.flipX(!!r.flipX),void 0!==r.flipY&&o.flipY(!!r.flipY),void 0!==r.rotation&&o.rotate(r.rotation),r.anchorPoint&&o.anchorPoint.set(r.anchorPoint.x,r.anchorPoint.y),void 0!==r.tint&&o.tint.setColor(r.tint),"string"==typeof r.name&&(o.name=r.name),void 0!==r.z&&(o.pos.z=r.z),0!==o.addAnimation("default",null)&&o.setCurrentAnimation("default"),o.autoTransform=!0,o}return d(n,[{key:"isFlickering",value:function(){return this._flicker.isFlickering}},{key:"flicker",value:function(t,e){return this._flicker.duration=t,this._flicker.duration<=0?(this._flicker.isFlickering=!1,this._flicker.callback=null):this._flicker.isFlickering||(this._flicker.callback=e,this._flicker.isFlickering=!0),this}},{key:"addAnimation",value:function(t,e,n){this.anim[t]={name:t,frames:[],idx:0,length:0};var i=0;if("object"!==p(this.textureAtlas))return 0;null==e&&(e=[],Object.keys(this.textureAtlas).forEach((function(t,n){e[n]=n})));for(var r=0,o=e.length;r<o;r++){var s,a=e[r],u=(s="number"==typeof a||"string"==typeof a?{name:a,delay:n||this.animationspeed}:a).name;if("number"==typeof u)void 0!==this.textureAtlas[u]&&(this.anim[t].frames[r]=Object.assign({},this.textureAtlas[u],s),i++);else{if(this.source.getFormat().includes("Spritesheet"))throw new Error("string parameters for addAnimation are not allowed for standard spritesheet based Texture");this.anim[t].frames[r]=Object.assign({},this.textureAtlas[this.atlasIndices[u]],s),i++}}return this.anim[t].length=i,i}},{key:"setCurrentAnimation",value:function(t,e,n){if(!this.anim[t])throw new Error("animation id '"+t+"' not defined");return this.current.name=t,this.current.length=this.anim[this.current.name].length,this.resetAnim="string"==typeof e?this.setCurrentAnimation.bind(this,e,null,!0):"function"==typeof e?e:void 0,this.setAnimationFrame(this.current.idx),n||(this.dt=0),this.isDirty=!0,this}},{key:"reverseAnimation",value:function(t){return void 0!==t&&void 0!==this.anim[t]?this.anim[t].frames.reverse():this.anim[this.current.name].frames.reverse(),this.isDirty=!0,this}},{key:"isCurrentAnimation",value:function(t){return this.current.name===t}},{key:"setRegion",value:function(t){return this.image=this.source.getTexture(t),this.current.offset.setV(t.offset),this.current.angle=t.angle,this.width=this.current.width=t.width,this.height=this.current.height=t.height,t.anchorPoint&&this.anchorPoint.set(this._flip.x&&!0===t.trimmed?1-t.anchorPoint.x:t.anchorPoint.x,this._flip.y&&!0===t.trimmed?1-t.anchorPoint.y:t.anchorPoint.y),this.isDirty=!0,this}},{key:"setAnimationFrame",value:function(t){return this.current.idx=(t||0)%this.current.length,this.setRegion(this.getAnimationFrameObjectByIndex(this.current.idx))}},{key:"getCurrentAnimationFrame",value:function(){return this.current.idx}},{key:"getAnimationFrameObjectByIndex",value:function(t){return this.anim[this.current.name].frames[t]}},{key:"update",value:function(t){if(!this.animationpause&&this.current&&this.current.length>0){var e=this.getAnimationFrameObjectByIndex(this.current.idx).delay;for(this.dt+=t;this.dt>=e;){this.isDirty=!0,this.dt-=e;var r=this.current.length>1?this.current.idx+1:this.current.idx;if(this.setAnimationFrame(r),0===this.current.idx&&"function"==typeof this.resetAnim&&!1===this.resetAnim()){this.setAnimationFrame(this.current.length-1),this.dt%=e;break}e=this.getAnimationFrameObjectByIndex(this.current.idx).delay}}return this._flicker.isFlickering&&(this._flicker.duration-=t,this._flicker.duration<0&&("function"==typeof this._flicker.callback&&this._flicker.callback(),this.flicker(-1)),this.isDirty=!0),i(h(n.prototype),"update",this).call(this,t)}},{key:"destroy",value:function(){Gr.push(this.offset),this.offset=void 0,i(h(n.prototype),"destroy",this).call(this)}},{key:"draw",value:function(t,e){if(!this._flicker.isFlickering||(this._flicker.state=!this._flicker.state,this._flicker.state)){var n=this.current,i=this.pos.x,r=this.pos.y,o=n.width,s=n.height,a=n.offset,u=this.offset;0!==n.angle&&(t.translate(-i,-r),t.rotate(n.angle),i-=s,o=n.height,s=n.width),t.drawImage(this.image,u.x+a.x,u.y+a.y,o,s,i,r,o,s)}}}]),n}(gl);function ec(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"no-repeat";return{meta:{app:"melonJS",size:{w:t,h:e},repeat:i,image:"default"},frames:[{filename:n,frame:{x:0,y:0,w:t,h:e}}]}}var nc=function(){function t(e,n,i){var r=this;if(c(this,t),this.format=null,this.sources=new Map,this.atlases=new Map,void 0!==e)for(var o in e=Array.isArray(e)?e:[e]){var s=e[o];if(void 0!==s.meta){if(s.meta.app.includes("texturepacker")||s.meta.app.includes("free-tex-packer")){if(this.format="texturepacker",void 0===n){var a=$h.getImage(s.meta.image);if(!a)throw new Error("Atlas texture '"+a+"' not found");this.sources.set(s.meta.image,a)}else this.sources.set(s.meta.image||"default","string"==typeof n?$h.getImage(n):n);this.repeat="no-repeat"}else if(s.meta.app.includes("ShoeBox")){if(!s.meta.exporter||!s.meta.exporter.includes("melonJS"))throw new Error("ShoeBox requires the JSON exporter : https://github.com/melonjs/melonJS/tree/master/media/shoebox_JSON_export.sbx");this.format="ShoeBox",this.repeat="no-repeat",this.sources.set("default","string"==typeof n?$h.getImage(n):n)}else s.meta.app.includes("melonJS")&&(this.format="melonJS",this.repeat=s.meta.repeat||"no-repeat",this.sources.set("default","string"==typeof n?$h.getImage(n):n));this.atlases.set(s.meta.image||"default",this.parse(s))}else void 0!==s.framewidth&&void 0!==s.frameheight&&(this.format="Spritesheet (fixed cell size)",this.repeat="no-repeat",void 0!==n&&(s.image="string"==typeof n?$h.getImage(n):n),this.atlases.set("default",this.parseFromSpriteSheet(s)),this.sources.set("default",s.image))}if(0===this.atlases.length)throw new Error("texture atlas format not supported");!1!==i&&this.sources.forEach((function(t){i instanceof bc?i.set(t,r):Pc.cache.set(t,r)}))}return d(t,[{key:"parse",value:function(t){var e=this,n={};return t.frames.forEach((function(i){if(i.hasOwnProperty("filename")){var r,o,s=i.frame,a=i.spriteSourceSize&&i.sourceSize&&i.pivot;a&&(r=i.sourceSize.w*i.pivot.x-(i.trimmed?i.spriteSourceSize.x:0),o=i.sourceSize.h*i.pivot.y-(i.trimmed?i.spriteSourceSize.y:0)),n[i.filename]={name:i.filename,texture:t.meta.image||"default",offset:new Hr(s.x,s.y),anchorPoint:a?new Hr(r/s.w,o/s.h):null,trimmed:!!i.trimmed,width:s.w,height:s.h,angle:!0===i.rotated?-Er:0},e.addUVs(n,i.filename,t.meta.size.w,t.meta.size.h)}})),n}},{key:"parseFromSpriteSheet",value:function(t){var e={},n=t.image,i=t.spacing||0,r=t.margin||0,o=n.width,s=n.height,a=Gr.pull("Vector2d",~~((o-r+i)/(t.framewidth+i)),~~((s-r+i)/(t.frameheight+i)));if(o%(t.framewidth+i)!=0||s%(t.frameheight+i)!=0){var u=a.x*(t.framewidth+i),l=a.y*(t.frameheight+i);u-o!==i&&l-s!==i&&(o=u,s=l,console.warn("Spritesheet Texture for image: "+n.src+" is not divisible by "+(t.framewidth+i)+"x"+(t.frameheight+i)+", truncating effective size to "+o+"x"+s))}for(var h=0,c=a.x*a.y;h<c;h++){var f=""+h;e[f]={name:f,texture:"default",offset:new Hr(r+(i+t.framewidth)*(h%a.x),r+(i+t.frameheight)*~~(h/a.x)),anchorPoint:t.anchorPoint||null,trimmed:!1,width:t.framewidth,height:t.frameheight,angle:0},this.addUVs(e,f,o,s)}return Gr.push(a),e}},{key:"getAtlas",value:function(t){return"string"==typeof t?this.atlases.get(t):this.atlases.values().next().value}},{key:"getFormat",value:function(){return this.format}},{key:"getTexture",value:function(t){return"object"===p(t)&&"string"==typeof t.texture?this.sources.get(t.texture):this.sources.values().next().value}},{key:"addRegion",value:function(t,e,n,i,r){!0===Pc.settings.verbose&&console.warn("Adding texture region",t,"for texture",this);var o=this.getTexture(),s=this.getAtlas(),a=o.width,u=o.height;return s[t]={name:t,offset:new Hr(e,n),width:i,height:r,angle:0},this.addUVs(s,t,a,u),s[t]}},{key:"getRegion",value:function(t,e){var n;return"string"==typeof e?n=this.getAtlas(e)[t]:this.atlases.forEach((function(e){void 0!==e[t]&&(n=e[t])})),n}},{key:"getUVs",value:function(t){var e=this.getRegion(t);if(void 0===e){var n=t.split(","),i=+n[0],r=+n[1],o=+n[2],s=+n[3];e=this.addRegion(t,i,r,o,s)}return e.uvs}},{key:"addUVs",value:function(t,e,n,i){if(Pc instanceof xc){var r=t[e].offset,o=t[e].width,s=t[e].height;t[e].uvs=new Float32Array([r.x/n,r.y/i,(r.x+o)/n,(r.y+s)/i]),t[r.x+","+r.y+","+n+","+i]=t[e]}return t[e].uvs}},{key:"createSpriteFromName",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Gr.pull(!0===n?"me.NineSliceSprite":"me.Sprite",0,0,Object.assign({image:this,region:t},e||{}))}},{key:"createAnimationFromName",value:function(t,e){for(var n,i=[],r={},o=0,s=0,a=0;a<t.length;++a){if(null==(n=this.getRegion(t[a])))throw new Error("Texture - region for "+t[a]+" not found");i[a]=n,r[t[a]]=a,o=Math.max(n.width,o),s=Math.max(n.height,s)}return new tc(0,0,Object.assign({image:this,framewidth:o,frameheight:s,margin:0,spacing:0,atlas:i,atlasIndices:r},e||{}))}}]),t}(),ic={},rc={},oc={},sc=v&&v.__generator||function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},ac=v&&v.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},uc=v&&v.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s};Object.defineProperty(oc,"__esModule",{value:!0}),oc.Multimap=void 0;var lc=function(){function t(t,e){var n,i;if(this.size_=0,this.map=new Map,this.operator=t,e)try{for(var r=ac(e),o=r.next();!o.done;o=r.next()){var s=uc(o.value,2),a=s[0],u=s[1];this.put(a,u)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return this}return Object.defineProperty(t.prototype,"size",{get:function(){return this.size_},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=this.map.get(t);return e?this.operator.clone(e):this.operator.create()},t.prototype.put=function(t,e){var n=this.map.get(t);return n||(n=this.operator.create()),!!this.operator.add(e,n)&&(this.map.set(t,n),this.size_++,!0)},t.prototype.putAll=function(e,n){var i,r,o,s,a=0;if(n){var u=e,l=n;try{for(var h=ac(l),c=h.next();!c.done;c=h.next()){var f=c.value;this.put(u,f),a++}}catch(t){i={error:t}}finally{try{c&&!c.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}}else{if(!(e instanceof t))throw new TypeError("unexpected arguments");try{for(var d=ac(e.entries()),p=d.next();!p.done;p=d.next()){var v=uc(p.value,2);u=v[0],f=v[1],this.put(u,f),a++}}catch(t){o={error:t}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}}return a>0},t.prototype.has=function(t){return this.map.has(t)},t.prototype.hasEntry=function(t,e){return this.operator.has(e,this.get(t))},t.prototype.delete=function(t){return this.size_-=this.operator.size(this.get(t)),this.map.delete(t)},t.prototype.deleteEntry=function(t,e){var n=this.get(t);return!!this.operator.delete(e,n)&&(this.map.set(t,n),this.size_--,!0)},t.prototype.clear=function(){this.map.clear(),this.size_=0},t.prototype.keys=function(){return this.map.keys()},t.prototype.entries=function(){var t=this;return function(){var e,n,i,r,o,s,a,u,l,h,c,f,d,p;return sc(this,(function(v){switch(v.label){case 0:v.trys.push([0,11,12,13]),e=ac(t.map.entries()),n=e.next(),v.label=1;case 1:if(n.done)return[3,10];i=uc(n.value,2),r=i[0],o=i[1],v.label=2;case 2:v.trys.push([2,7,8,9]),d=void 0,s=ac(o),a=s.next(),v.label=3;case 3:return a.done?[3,6]:(u=a.value,[4,[r,u]]);case 4:v.sent(),v.label=5;case 5:return a=s.next(),[3,3];case 6:return[3,9];case 7:return l=v.sent(),d={error:l},[3,9];case 8:try{a&&!a.done&&(p=s.return)&&p.call(s)}finally{if(d)throw d.error}return[7];case 9:return n=e.next(),[3,1];case 10:return[3,13];case 11:return h=v.sent(),c={error:h},[3,13];case 12:try{n&&!n.done&&(f=e.return)&&f.call(e)}finally{if(c)throw c.error}return[7];case 13:return[2]}}))}()},t.prototype.values=function(){var t=this;return function(){var e,n,i,r,o;return sc(this,(function(s){switch(s.label){case 0:s.trys.push([0,5,6,7]),e=ac(t.entries()),n=e.next(),s.label=1;case 1:return n.done?[3,4]:[4,uc(n.value,2)[1]];case 2:s.sent(),s.label=3;case 3:return n=e.next(),[3,1];case 4:return[3,7];case 5:return i=s.sent(),r={error:i},[3,7];case 6:try{n&&!n.done&&(o=e.return)&&o.call(e)}finally{if(r)throw r.error}return[7];case 7:return[2]}}))}()},t.prototype.forEach=function(t,e){var n,i;try{for(var r=ac(this.entries()),o=r.next();!o.done;o=r.next()){var s=uc(o.value,2),a=s[0],u=s[1];t.call(void 0===e?this:e,u,a,this)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}},t.prototype[Symbol.iterator]=function(){return this.entries()},t.prototype.asMap=function(){var t,e,n=new Map;try{for(var i=ac(this.keys()),r=i.next();!r.done;r=i.next()){var o=r.value;n.set(o,this.operator.clone(this.get(o)))}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return n},t}();oc.Multimap=lc;var hc,cc=v&&v.__extends||(hc=function(t,e){return hc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},hc(t,e)},function(t,e){function n(){this.constructor=t}hc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(rc,"__esModule",{value:!0}),rc.ArrayMultimap=void 0;var fc=function(t){function e(e){return t.call(this,new pc,e)||this}return cc(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"ArrayMultimap"},enumerable:!1,configurable:!0}),e}(oc.Multimap);rc.ArrayMultimap=fc;var dc,pc=function(){function t(){}return t.prototype.create=function(){return[]},t.prototype.clone=function(t){return t.slice()},t.prototype.add=function(t,e){return e.push(t),!0},t.prototype.size=function(t){return t.length},t.prototype.delete=function(t,e){var n=e.indexOf(t);return n>-1&&(e.splice(n,1),!0)},t.prototype.has=function(t,e){return e.includes(t)},t}(),vc={},yc=v&&v.__extends||(dc=function(t,e){return dc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},dc(t,e)},function(t,e){function n(){this.constructor=t}dc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(vc,"__esModule",{value:!0}),vc.SetMultimap=void 0;var gc=function(t){function e(e){return t.call(this,new mc,e)||this}return yc(e,t),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"SetMultimap"},enumerable:!1,configurable:!0}),e}(oc.Multimap);vc.SetMultimap=gc;var mc=function(){function t(){}return t.prototype.create=function(){return new Set},t.prototype.clone=function(t){return new Set(t)},t.prototype.add=function(t,e){var n=e.size;return e.add(t),n!==e.size},t.prototype.size=function(t){return t.size},t.prototype.delete=function(t,e){return e.delete(t)},t.prototype.has=function(t,e){return e.has(t)},t}();!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SetMultimap=t.ArrayMultimap=void 0;var e=rc;Object.defineProperty(t,"ArrayMultimap",{enumerable:!0,get:function(){return e.ArrayMultimap}});var n=vc;Object.defineProperty(t,"SetMultimap",{enumerable:!0,get:function(){return n.SetMultimap}})}(ic);var bc=function(){function t(e){c(this,t),this.cache=new ic.ArrayMultimap,this.tinted=new Map,this.units=new Map,this.max_size=e||1/0,this.clear()}return d(t,[{key:"clear",value:function(){this.cache.clear(),this.tinted.clear(),this.units.clear(),this.length=0}},{key:"validate",value:function(){if(this.length>=this.max_size)throw new Error("Texture cache overflow: "+this.max_size+" texture units available for this GPU.")}},{key:"get",value:function(t,e){var n;return void 0===e?n=this.cache.get(t)[0]:this.cache.forEach((function(i,r){var o=i.getAtlas();r===t&&o[0].width===e.framewidth&&o[0].height===e.frameheight&&(n=i)})),void 0===n&&(e||(e=ec(t.width,t.height,t.src?Dr(t.src):void 0)),n=new nc(e,t,!1),this.set(t,n)),n}},{key:"delete",value:function(t){this.cache.has(t)||this.cache.delete(t)}},{key:"tint",value:function(t,e){var n=this.tinted.get(t);return void 0===n&&(n=this.tinted.set(t,new Map)),n.has(e)||n.set(e,Pc.tint(t,e,"multiply")),n.get(e)}},{key:"set",value:function(t,e){var n=t.width,i=t.height;if(!(1!==Pc.WebGLVersion||Sr(n)&&Sr(i))){var r=void 0!==t.src?t.src:t;console.warn("[Texture] "+r+" is not a POT texture ("+n+"x"+i+")")}return this.cache.put(t,e)}},{key:"getUnit",value:function(t){return this.units.has(t)||(this.validate(),this.units.set(t,this.length++)),this.units.get(t)}}]),t}(),xc=function(t){o(n,t);var e=a(n);function n(t){var i;c(this,n),(i=e.call(this,t)).WebGLVersion=1,i.GPUVendor=null,i.GPURenderer=null,i.context=i.gl=i.getContextGL(i.getScreenCanvas(),t.transparent),i.maxTextures=i.gl.getParameter(i.gl.MAX_TEXTURE_IMAGE_UNITS),i._colorStack=[],i._matrixStack=[],i._scissorStack=[],i._blendStack=[],i.currentTransform=new to,i.currentCompositor=null,i.compositors=new Map;var r=new(i.settings.compositor||sa)(l(i));i.compositors.set("default",r),i.setCompositor(r),i.gl.disable(i.gl.DEPTH_TEST),i.gl.disable(i.gl.SCISSOR_TEST),i.gl.enable(i.gl.BLEND),i.setBlendMode(i.settings.blendMode);var o=i.gl.getExtension("WEBGL_debug_renderer_info");return null!==o&&(i.GPUVendor=i.gl.getParameter(o.UNMASKED_VENDOR_WEBGL),i.GPURenderer=i.gl.getParameter(o.UNMASKED_RENDERER_WEBGL)),i.cache=new bc(i.maxTextures),i.getScreenCanvas().addEventListener("webglcontextlost",(function(t){t.preventDefault(),i.isContextValid=!1,Do(jo,l(i))}),!1),i.getScreenCanvas().addEventListener("webglcontextrestored",(function(){i.reset(),i.isContextValid=!0,Do(Bo,l(i))}),!1),i}return d(n,[{key:"reset",value:function(){var t=this;i(h(n.prototype),"reset",this).call(this),this.compositors.forEach((function(e){!1===t.isContextValid?e.init(t):e.reset()})),this.gl.disable(this.gl.SCISSOR_TEST),void 0!==this.fontContext2D&&this.createFontTexture(this.cache)}},{key:"setCompositor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";if("string"==typeof t&&(t=this.compositors.get(t)),void 0===t)throw new Error("Invalid WebGL Compositor");this.currentCompositor!==t&&(null!==this.currentCompositor&&this.currentCompositor.flush(),this.currentCompositor=t)}},{key:"resetTransform",value:function(){this.currentTransform.identity()}},{key:"createFontTexture",value:function(t){if(void 0===this.fontTexture){var e=this.backBufferCanvas,n=e.width,i=e.height;1===this.WebGLVersion&&(Sr(n)||(n=Ar(e.width)),Sr(i)||(i=Ar(e.height)));var r=Oc(n,i,!0);this.fontContext2D=this.getContext2d(r),this.fontTexture=new nc(ec(e.width,e.height,"fontTexture"),r,t),this.currentCompositor.uploadTexture(this.fontTexture,0,0,0)}else t.set(this.fontContext2D.canvas,this.fontTexture)}},{key:"createPattern",value:function(t,e){if(!(1!==Pc.WebGLVersion||Sr(t.width)&&Sr(t.height))){var n=void 0!==t.src?t.src:t;throw new Error("[WebGL Renderer] "+n+" is not a POT texture ("+t.width+"x"+t.height+")")}var i=new nc(ec(t.width,t.height,"pattern",e),t);return this.currentCompositor.uploadTexture(i),i}},{key:"flush",value:function(){this.currentCompositor.flush()}},{key:"setProjection",value:function(t){i(h(n.prototype),"setProjection",this).call(this,t),this.currentCompositor.setProjection(t)}},{key:"clearColor",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#000000",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e instanceof Qr)t=e.toArray();else{var i=Gr.pull("me.Color");t=i.parseCSS(e).toArray(),Gr.push(i)}this.currentCompositor.clearColor(t[0],t[1],t[2],!0===n?1:t[3]),this.currentCompositor.clear(),this.currentCompositor.clearColor(0,0,0,0)}},{key:"clearRect",value:function(t,e,n,i){this.save(),this.clipRect(t,e,n,i),this.clearColor(),this.restore()}},{key:"drawFont",value:function(t){var e=this.getFontContext();this.currentCompositor.uploadTexture(this.fontTexture,0,0,0,!0);var n=this.fontTexture.getUVs(t.left+","+t.top+","+t.width+","+t.height);this.currentCompositor.addQuad(this.fontTexture,t.left,t.top,t.width,t.height,n[0],n[1],n[2],n[3],this.currentTint.toUint32()),e.clearRect(t.left,t.top,t.width,t.height)}},{key:"drawImage",value:function(t,e,n,i,r,o,s,a,u){void 0===i?(i=a=t.width,r=u=t.height,o=e,s=n,e=0,n=0):void 0===o&&(o=e,s=n,a=i,u=r,i=t.width,r=t.height,e=0,n=0),!1===this.settings.subPixel&&(o|=0,s|=0);var l=this.cache.get(t),h=l.getUVs(e+","+n+","+i+","+r);this.currentCompositor.addQuad(l,o,s,a,u,h[0],h[1],h[2],h[3],this.currentTint.toUint32())}},{key:"drawPattern",value:function(t,e,n,i,r){var o=t.getUVs("0,0,"+i+","+r);this.currentCompositor.addQuad(t,e,n,i,r,o[0],o[1],o[2],o[3],this.currentTint.toUint32())}},{key:"getScreenContext",value:function(){return this.gl}},{key:"getContextGL",value:function(t,e){if(null==t)throw new Error("You must pass a canvas element in order to create a GL context");"boolean"!=typeof e&&(e=!0);var n,i={alpha:e,antialias:this.settings.antiAlias,depth:!1,stencil:!0,preserveDrawingBuffer:!1,premultipliedAlpha:e,powerPreference:this.settings.powerPreference,failIfMajorPerformanceCaveat:this.settings.failIfMajorPerformanceCaveat};if(!1===this.settings.preferWebGL1&&(n=t.getContext("webgl2",i))&&(this.WebGLVersion=2),n||(this.WebGLVersion=1,n=t.getContext("webgl",i)||t.getContext("experimental-webgl",i)),!n)throw new Error("A WebGL context could not be created.");return n}},{key:"getContext",value:function(){return this.gl}},{key:"setBlendMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.gl;if(this.currentBlendMode!==t)switch(this.flush(),e.enable(e.BLEND),this.currentBlendMode=t,t){case"screen":e.blendFunc(e.ONE,e.ONE_MINUS_SRC_COLOR);break;case"lighter":case"additive":e.blendFunc(e.ONE,e.ONE);break;case"multiply":e.blendFunc(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA);break;default:e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this.currentBlendMode="normal"}}},{key:"getFontContext",value:function(){return void 0===this.fontContext2D&&(console.warn("[WebGL Renderer] WARNING : Using Standard me.Text with WebGL will severly impact performances !"),this.createFontTexture(this.cache)),this.fontContext2D}},{key:"restore",value:function(){if(0!==this._matrixStack.length){var t=this._colorStack.pop(),e=this._matrixStack.pop();this.currentColor.copy(t),this.currentTransform.copy(e),this.setBlendMode(this._blendStack.pop()),Gr.push(t),Gr.push(e)}0!==this._scissorStack.length?this.currentScissor.set(this._scissorStack.pop()):(this.gl.disable(this.gl.SCISSOR_TEST),this.currentScissor[0]=0,this.currentScissor[1]=0,this.currentScissor[2]=this.backBufferCanvas.width,this.currentScissor[3]=this.backBufferCanvas.height)}},{key:"save",value:function(){this._colorStack.push(this.currentColor.clone()),this._matrixStack.push(this.currentTransform.clone()),this.gl.isEnabled(this.gl.SCISSOR_TEST)&&this._scissorStack.push(this.currentScissor.slice()),this._blendStack.push(this.getBlendMode())}},{key:"rotate",value:function(t){this.currentTransform.rotate(t)}},{key:"scale",value:function(t,e){this.currentTransform.scale(t,e)}},{key:"setAntiAlias",value:function(t,e){i(h(n.prototype),"setAntiAlias",this).call(this,t,e)}},{key:"setGlobalAlpha",value:function(t){this.currentColor.alpha=t}},{key:"getGlobalAlpha",value:function(){return this.currentColor.alpha}},{key:"setColor",value:function(t){var e=this.currentColor.alpha;this.currentColor.copy(t),this.currentColor.alpha*=e}},{key:"setLineWidth",value:function(t){this.getScreenContext().lineWidth(t)}},{key:"strokeArc",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.arc(t,e,n,i,r,o),!1===s?this.currentCompositor.drawVertices(this.gl.LINE_STRIP,this.path2D.points):(this.path2D.closePath(),this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath())))}},{key:"fillArc",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.strokeArc(t,e,n,i,r,o,!0)}},{key:"strokeEllipse",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.ellipse(t,e,n,i,0,0,360),this.path2D.closePath(),!1===r?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath()))}},{key:"fillEllipse",value:function(t,e,n,i){this.strokeEllipse(t,e,n,i,!1)}},{key:"strokeLine",value:function(t,e,n,i){this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.moveTo(t,e),this.path2D.lineTo(n,i),this.currentCompositor.drawVertices(this.gl.LINE_STRIP,this.path2D.points))}},{key:"fillLine",value:function(t,e,n,i){this.strokeLine(t,e,n,i)}},{key:"strokePolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(this.getGlobalAlpha()<1/255)){var n;this.translate(t.pos.x,t.pos.y),this.path2D.beginPath(),this.path2D.moveTo(t.points[0].x,t.points[0].y);for(var i=1;i<t.points.length;i++)n=t.points[i],this.path2D.lineTo(n.x,n.y);this.path2D.lineTo(t.points[0].x,t.points[0].y),this.path2D.closePath(),!1===e?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath()),this.translate(-t.pos.x,-t.pos.y)}}},{key:"fillPolygon",value:function(t){this.strokePolygon(t,!0)}},{key:"strokeRect",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.rect(t,e,n,i),!1===r?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath()))}},{key:"fillRect",value:function(t,e,n,i){this.strokeRect(t,e,n,i,!0)}},{key:"strokeRoundRect",value:function(t,e,n,i,r){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.getGlobalAlpha()<1/255||(this.path2D.beginPath(),this.path2D.roundRect(t,e,n,i,r),!1===o?this.currentCompositor.drawVertices(this.gl.LINE_LOOP,this.path2D.points):(this.path2D.closePath(),this.currentCompositor.drawVertices(this.gl.TRIANGLES,this.path2D.triangulatePath())))}},{key:"fillRoundRect",value:function(t,e,n,i,r){this.strokeRoundRect(t,e,n,i,r,!0)}},{key:"setTransform",value:function(t){this.resetTransform(),this.transform(t)}},{key:"transform",value:function(t){var e=this.currentTransform;if(e.multiply(t),!1===this.settings.subPixel){var n=e.toArray();n[6]|=0,n[7]|=0}}},{key:"translate",value:function(t,e){var n=this.currentTransform;if(n.translate(t,e),!1===this.settings.subPixel){var i=n.toArray();i[6]|=0,i[7]|=0}}},{key:"clipRect",value:function(t,e,n,i){var r=this.backBufferCanvas,o=this.gl;if(0!==t||0!==e||n!==r.width||i!==r.height){var s=this.currentScissor;if(o.isEnabled(o.SCISSOR_TEST)&&s[0]===t&&s[1]===e&&s[2]===n&&s[3]===i)return;this.flush(),o.enable(this.gl.SCISSOR_TEST),o.scissor(t+this.currentTransform.tx,r.height-i-e-this.currentTransform.ty,n,i),s[0]=t,s[1]=e,s[2]=n,s[3]=i}else o.disable(o.SCISSOR_TEST)}},{key:"setMask",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.gl;this.flush(),0===this.maskLevel&&(n.enable(n.STENCIL_TEST),n.clear(n.STENCIL_BUFFER_BIT)),this.maskLevel++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,this.maskLevel,1),n.stencilOp(n.REPLACE,n.REPLACE,n.REPLACE),this.fill(t),this.flush(),n.colorMask(!0,!0,!0,!0),!0===e?n.stencilFunc(n.EQUAL,this.maskLevel+1,1):n.stencilFunc(n.NOTEQUAL,this.maskLevel+1,1),n.stencilOp(n.KEEP,n.KEEP,n.KEEP)}},{key:"clearMask",value:function(){this.maskLevel>0&&(this.flush(),this.maskLevel=0,this.gl.disable(this.gl.STENCIL_TEST))}}]),n}(Va),wc=1,_c=0,kc=0,Tc={parent:void 0,renderer:2,doubleBuffering:!1,autoScale:!1,scale:1,scaleMethod:"fit",transparent:!1,blendMode:"normal",antiAlias:!1,failIfMajorPerformanceCaveat:!0,subPixel:!1,preferWebGL1:!1,powerPreference:"default",verbose:!1,consoleHeader:!0};function Ec(){var t=Pc.settings,e=1,n=1;if(t.autoScale){var i=1/0,r=1/0;if(globalThis.getComputedStyle){var o=globalThis.getComputedStyle(Pc.getScreenCanvas(),null);i=parseInt(o.maxWidth,10)||1/0,r=parseInt(o.maxHeight,10)||1/0}var s=Ks(Cc()),a=Math.min(i,s.width),u=Math.min(r,s.height),l=a/u;if("fill-min"===t.scaleMethod&&l>wc||"fill-max"===t.scaleMethod&&l<wc||"flex-width"===t.scaleMethod){var h=Math.min(i,kc*l);e=n=a/h,Pc.resize(Math.floor(h),kc)}else if("fill-min"===t.scaleMethod&&l<wc||"fill-max"===t.scaleMethod&&l>wc||"flex-height"===t.scaleMethod){var c=Math.min(r,_c*(u/a));e=n=u/c,Pc.resize(_c,Math.floor(c))}else"flex"===t.scaleMethod?Pc.resize(Math.floor(a),Math.floor(u)):"stretch"===t.scaleMethod?(e=a/_c,n=u/kc):e=n=l<wc?a/_c:u/kc;Mc(e,n)}}var Sc=null,Ac=new Hr(1,1),Pc=null;function Oc(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t||0===e)throw new Error("width or height was zero, Canvas could not be initialized !");return!0===Cs&&!0===i?void 0===(n=new globalThis.OffscreenCanvas(0,0)).style&&(n.style={}):n=document.createElement("canvas"),n.width=t,n.height=e,n}function Cc(){return Sc}function Mc(t,e){var n=Pc.getScreenCanvas(),i=Pc.getScreenContext(),r=Pc.settings,o=Is,s=r.zoomX=n.width*t*o,a=r.zoomY=n.height*e*o;Ac.set(t*o,e*o),n.style.width=s/o+"px",n.style.height=a/o+"px",Pc.setAntiAlias(i,r.antiAlias),Pc.setBlendMode(r.blendMode,i),Ul.repaint()}var Rc,Ic=Object.freeze({__proto__:null,CANVAS:0,WEBGL:1,AUTO:2,get parent(){return Sc},scaleRatio:Ac,get renderer(){return Pc},init:function(t,e,n){if(!xf)throw new Error("me.video.init() called before engine initialization.");(Tc=Object.assign(Tc,n||{})).width=t,Tc.height=e,Tc.doubleBuffering=!!Tc.doubleBuffering,Tc.transparent=!!Tc.transparent,Tc.antiAlias=!!Tc.antiAlias,Tc.failIfMajorPerformanceCaveat=!!Tc.failIfMajorPerformanceCaveat,Tc.subPixel=!!Tc.subPixel,Tc.verbose=!!Tc.verbose,-1!==Tc.scaleMethod.search(/^(fill-(min|max)|fit|flex(-(width|height))?|stretch)$/)?Tc.autoScale="auto"===Tc.scale||!0:(Tc.scaleMethod="fit",Tc.autoScale="auto"===Tc.scale||!1),!1!==Tc.consoleHeader&&console.log("melonJS 2 (v"+bf+") | http://melonjs.org");var i=Bc.getUriFragment();!0!==i.webgl&&!0!==i.webgl1&&!0!==i.webgl2||(Tc.renderer=1,!0===i.webgl1&&(Tc.preferWebGL1=!0)),Tc.scale=Tc.autoScale?1:+Tc.scale||1,Ac.set(Tc.scale,Tc.scale),(Tc.autoScale||1!==Tc.scale)&&(Tc.doubleBuffering=!0),wc=t/e,_c=t,kc=e,Tc.zoomX=t*Ac.x,Tc.zoomY=e*Ac.y,globalThis.addEventListener("resize",Bc.function.throttle((function(t){Do(Oo,t)}),100),!1),globalThis.addEventListener("orientationchange",(function(t){Do(Ro,t)}),!1),globalThis.addEventListener("onmozorientationchange",(function(t){Do(Ro,t)}),!1),!0===ks&&(globalThis.screen.orientation.onchange=function(t){Do(Ro,t)}),globalThis.addEventListener("scroll",Bc.function.throttle((function(t){Do(Io,t)}),100),!1),Fo(Oo,Ec,this),Fo(Ro,Ec,this);try{switch(Tc.renderer){case 2:case 1:Pc=function(t){try{if(qs(t))return new xc(t)}catch(t){console.log("Error creating WebGL renderer :"+t.message)}return new bh(t)}(Tc);break;default:Pc=new bh(Tc)}}catch(t){return console(t.message),!1}if((Sc=Ws(void 0!==Tc.parent?Tc.parent:document.body)).appendChild(Pc.getScreenCanvas()),vs.isMobile&&Vs(!1),Ec(),"MutationObserver"in globalThis&&new MutationObserver(Ec.bind(this)).observe(Sc,{attributes:!1,childList:!0,subtree:!0}),!1!==Tc.consoleHeader){var r=Pc instanceof bh?"CANVAS":"WebGL"+Pc.WebGLVersion,o=Ss?"Web Audio":"HTML5 Audio",s="string"==typeof Pc.GPURenderer?" ("+Pc.GPURenderer+")":"";console.log(r+" renderer"+s+" | "+o+" | pixel ratio "+Is+" | "+(vs.nodeJS?"node.js":vs.isMobile?"mobile":"desktop")+" | "+Hs()+" | "+Rs),console.log("resolution: requested "+t+"x"+e+", got "+Pc.getWidth()+"x"+Pc.getHeight())}return Do(ho),!0},createCanvas:Oc,getParent:Cc,scale:Mc}),Lc="",jc=0,Bc={agent:_r,array:Lr,file:Nr,string:mr,function:Vr,getPixels:function(t){if(t instanceof HTMLImageElement){var e=bh.getContext2d(Oc(t.width,t.height));return e.drawImage(t,0,0),e.getImageData(0,0,t.width,t.height)}return t.getContext("2d").getImageData(0,0,t.width,t.height)},checkVersion:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bf,n=t.split("."),i=e.split("."),r=Math.min(n.length,i.length),o=0,s=0;s<r&&!(o=+n[s]-+i[s]);s++);return o||n.length-i.length},getUriFragment:function(t){var e={};if(void 0===t){if(void 0===globalThis.document)return e;var n=globalThis.document.location;if(!n||!n.hash)return e;t=n.hash}else{var i=t.indexOf("#");if(-1===i)return e;t=t.slice(i,t.length)}return t.slice(1).split("&").filter((function(t){return""!==t})).forEach((function(t){var n=t.split("="),i=n.shift(),r=n.join("=");e[i]=r||!0})),e},resetGUID:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Lc=yr(t.toString().toUpperCase()),jc=e},createGUID:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return jc+=t,Lc+"-"+(t||jc)}},Dc=function(){function t(){var e=this;c(this,t),this.tick=1,this.fps=0,this.maxfps=60,this.interpolation=!1,this.framecount=0,this.framedelta=0,this.last=0,this.now=0,this.delta=0,this.step=0,this.minstep=0,this.timers=[],this.timerId=0,Fo(ro,(function(){e.reset(),e.now=e.last=0,Fo(po,e.update.bind(e))})),Fo(so,(function(){e.reset()})),Fo(uo,(function(){e.reset()})),Fo(lo,(function(){e.reset()}))}return d(t,[{key:"reset",value:function(){this.last=this.now=globalThis.performance.now(),this.delta=0,this.framedelta=0,this.framecount=0,this.step=Math.ceil(1e3/this.maxfps),this.minstep=1e3/this.maxfps*1.25}},{key:"setTimeout",value:function(t,e,n){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];return this.timers.push({fn:t,delay:e,elapsed:0,repeat:!1,timerId:++this.timerId,pauseable:!0===n||!0,args:r}),this.timerId}},{key:"setInterval",value:function(t,e,n){for(var i=arguments.length,r=new Array(i>3?i-3:0),o=3;o<i;o++)r[o-3]=arguments[o];return this.timers.push({fn:t,delay:e,elapsed:0,repeat:!0,timerId:++this.timerId,pauseable:!0===n||!0,args:r}),this.timerId}},{key:"clearTimeout",value:function(t){Bc.function.defer(this.clearTimer.bind(this),this,t)}},{key:"clearInterval",value:function(t){Bc.function.defer(this.clearTimer.bind(this),this,t)}},{key:"getTime",value:function(){return this.now}},{key:"getDelta",value:function(){return this.delta}},{key:"countFPS",value:function(){this.framecount++,this.framedelta+=this.delta,this.framecount%10==0&&(this.fps=Or(Math.round(1e3*this.framecount/this.framedelta),0,this.maxfps),this.framedelta=0,this.framecount=0)}},{key:"update",value:function(t){this.last=this.now,this.now=t,this.delta=this.now-this.last,this.delta<0&&(this.delta=0),this.tick=this.delta>this.minstep&&this.interpolation?this.delta/this.step:1,this.updateTimers()}},{key:"clearTimer",value:function(t){for(var e=0,n=this.timers.length;e<n;e++)if(this.timers[e].timerId===t){this.timers.splice(e,1);break}}},{key:"updateTimers",value:function(){for(var t=0,e=this.timers.length;t<e;t++){var n=this.timers[t];n.pauseable&&ch.isPaused()||(n.elapsed+=this.delta),n.elapsed>=n.delay&&(n.fn.apply(null,n.args),!0===n.repeat?n.elapsed-=n.delay:this.clearTimeout(n.timerId))}}}]),t}(),Fc=new Dc,Nc=0,zc=["ms","moz","webkit","o"],Uc=globalThis.requestAnimationFrame,Vc=globalThis.cancelAnimationFrame;for(Rc=0;Rc<zc.length&&!Uc;++Rc)Uc=globalThis[zc[Rc]+"RequestAnimationFrame"];for(Rc=0;Rc<zc.length&&!Vc;++Rc)Vc=globalThis[zc[Rc]+"CancelAnimationFrame"]||globalThis[zc[Rc]+"CancelRequestAnimationFrame"];Uc&&Vc||(Uc=function(t){var e=globalThis.performance.now(),n=Math.max(0,1e3/Fc.maxfps-(e-Nc)),i=globalThis.setTimeout((function(){t(e+n)}),n);return Nc=e+n,i},Vc=function(t){globalThis.clearTimeout(t)},globalThis.requestAnimationFrame=Uc,globalThis.cancelAnimationFrame=Vc),function(){function n(n,i,r,o,s){if([n,i,r,o].every((function(t){return Number.isFinite(t)}))){var a,u,l,h;if(4===(d=s,y=p(d),s="undefined"===y||null===d?[0]:"function"===y?[NaN]:"object"===y?"function"==typeof d[Symbol.iterator]?(v=d,function(t){if(Array.isArray(t))return e(t)}(v)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(v)||t(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(t){var e=p(t);return"undefined"===e||null===t?0:"function"===e?NaN:"object"===e?g(t):m(t)})):[g(d)]:[m(d)]).length)a=b(s[0]),u=b(s[1]),l=b(s[2]),h=b(s[3]);else if(3===s.length)a=b(s[0]),u=b(s[1]),h=b(s[1]),l=b(s[2]);else if(2===s.length)a=b(s[0]),l=b(s[0]),u=b(s[1]),h=b(s[1]);else{if(1!==s.length)throw new Error(s.length+" is not a valid size for radii sequence.");a=b(s[0]),u=b(s[0]),l=b(s[0]),h=b(s[0])}var c=[a,u,l,h],f=c.find((function(t){var e=t.x,n=t.y;return e<0||n<0}));if(!c.some((function(t){var e=t.x,n=t.y;return!Number.isFinite(e)||!Number.isFinite(n)}))){if(f)throw new Error("Radius value "+f+" is negative.");!function(e){var n=function(e,n){return function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,4),i=n[0],s=n[1],a=n[2],u=n[3],l=[Math.abs(r)/(i.x+s.x),Math.abs(o)/(s.y+a.y),Math.abs(r)/(a.x+u.x),Math.abs(o)/(i.y+u.y)],h=Math.min.apply(Math,l);h<=1&&e.forEach((function(t){t.x*=h,t.y*=h}))}(c),r<0&&o<0?(this.moveTo(n-a.x,i),this.ellipse(n+r+u.x,i-u.y,u.x,u.y,0,1.5*-Math.PI,-Math.PI),this.ellipse(n+r+l.x,i+o+l.y,l.x,l.y,0,-Math.PI,-Math.PI/2),this.ellipse(n-h.x,i+o+h.y,h.x,h.y,0,-Math.PI/2,0),this.ellipse(n-a.x,i-a.y,a.x,a.y,0,0,-Math.PI/2)):r<0?(this.moveTo(n-a.x,i),this.ellipse(n+r+u.x,i+u.y,u.x,u.y,0,-Math.PI/2,-Math.PI,1),this.ellipse(n+r+l.x,i+o-l.y,l.x,l.y,0,-Math.PI,1.5*-Math.PI,1),this.ellipse(n-h.x,i+o-h.y,h.x,h.y,0,Math.PI/2,0,1),this.ellipse(n-a.x,i+a.y,a.x,a.y,0,0,-Math.PI/2,1)):o<0?(this.moveTo(n+a.x,i),this.ellipse(n+r-u.x,i-u.y,u.x,u.y,0,Math.PI/2,0,1),this.ellipse(n+r-l.x,i+o+l.y,l.x,l.y,0,0,-Math.PI/2,1),this.ellipse(n+h.x,i+o+h.y,h.x,h.y,0,-Math.PI/2,-Math.PI,1),this.ellipse(n+a.x,i-a.y,a.x,a.y,0,-Math.PI,1.5*-Math.PI,1)):(this.moveTo(n+a.x,i),this.ellipse(n+r-u.x,i+u.y,u.x,u.y,0,-Math.PI/2,0),this.ellipse(n+r-l.x,i+o-l.y,l.x,l.y,0,0,Math.PI/2),this.ellipse(n+h.x,i+o-h.y,h.x,h.y,0,Math.PI/2,Math.PI),this.ellipse(n+a.x,i+a.y,a.x,a.y,0,Math.PI,1.5*Math.PI)),this.closePath(),this.moveTo(n,i)}}var d,v,y;function g(t){return{x:t.x,y:t.y,z:t.z,w:t.w}}function m(t){return+t}function b(t){var e=m(t);return Number.isFinite(e)?{x:e,y:e}:Object(t)===t?{x:m(t.x||0),y:m(t.y||0)}:{x:NaN,y:NaN}}}globalThis.CanvasRenderingContext2D&&void 0===globalThis.Path2D.prototype.roundRect&&(globalThis.Path2D.prototype.roundRect=n),globalThis.CanvasRenderingContext2D&&void 0===globalThis.CanvasRenderingContext2D.prototype.roundRect&&(globalThis.CanvasRenderingContext2D.prototype.roundRect=n),globalThis.OffscreenCanvasRenderingContext2D&&void 0===globalThis.OffscreenCanvasRenderingContext2D.prototype.roundRect&&(globalThis.OffscreenCanvasRenderingContext2D.prototype.roundRect=n)}();var Gc={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-Gc.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Gc.Bounce.In(2*t):.5*Gc.Bounce.Out(2*t-1)+.5}}},Hc={Linear:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=Hc.Utils.Linear;return e<0?o(t[0],t[1],i):e>1?o(t[n],t[n-1],n-i):o(t[r],t[r+1>n?n:r+1],i-r)},Bezier:function(t,e){var n,i=0,r=t.length-1,o=Math.pow,s=Hc.Utils.Bernstein;for(n=0;n<=r;n++)i+=o(1-e,r-n)*o(e,n)*t[n]*s(r,n);return i},CatmullRom:function(t,e){var n=t.length-1,i=n*e,r=Math.floor(i),o=Hc.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(i=n*(1+e))),o(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],i-r)):e<0?t[0]-(o(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(o(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):o(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],i-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=Hc.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n,i=1;if(t[e])return t[e];for(n=e;n>1;n--)i*=n;return t[e]=i,i}}(),CatmullRom:function(t,e,n,i,r){var o=.5*(n-t),s=.5*(i-e),a=r*r;return(2*e-2*n+o+s)*(r*a)+(-3*e+3*n-2*o-s)*a+o*r+e}}},Yc=function(){function t(e){c(this,t),this.setProperties(e)}return d(t,[{key:"onResetEvent",value:function(t){this.setProperties(t)}},{key:"setProperties",value:function(t){for(var e in this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._yoyo=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=Gc.Linear.None,this._interpolationFunction=Hc.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._tweenTimeTracker=Ul.lastUpdate,this.isPersistent=!1,this.updateWhenPaused=!1,this.isRenderable=!1,t)"object"!==p(t)&&(this._valuesStart[e]=parseFloat(t[e]))}},{key:"_resumeCallback",value:function(t){this._startTime&&(this._startTime+=t)}},{key:"onActivateEvent",value:function(){Fo(so,this._resumeCallback,this)}},{key:"onDeactivateEvent",value:function(){zo(so,this._resumeCallback)}},{key:"to",value:function(t,e){return this._valuesEnd=t,void 0!==e&&("number"==typeof e?this._duration=e:"object"===p(e)&&(e.duration&&(this._duration=e.duration),e.yoyo&&this.yoyo(e.yoyo),e.easing&&this.easing(e.easing),e.repeat&&this.repeat(e.repeat),e.delay&&this.delay(e.delay),e.interpolation&&this.interpolation(e.interpolation),e.autoStart&&this.start())),this}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fc.getTime();for(var e in this._onStartCallbackFired=!1,Ul.world.addChild(this),this._startTime=t+this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==0&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0}return this}},{key:"stop",value:function(){return Ul.world.removeChildNow(this),this}},{key:"delay",value:function(t){return this._delayTime=t,this}},{key:"repeat",value:function(t){return this._repeat=t,this}},{key:"yoyo",value:function(t){return this._yoyo=t,this}},{key:"easing",value:function(t){if("function"!=typeof t)throw new Error("invalid easing function for me.Tween.easing()");return this._easingFunction=t,this}},{key:"interpolation",value:function(t){return this._interpolationFunction=t,this}},{key:"chain",value:function(){return this._chainedTweens=arguments,this}},{key:"onStart",value:function(t){return this._onStartCallback=t,this}},{key:"onUpdate",value:function(t){return this._onUpdateCallback=t,this}},{key:"onComplete",value:function(t){return this._onCompleteCallback=t,this}},{key:"update",value:function(t){this._tweenTimeTracker=Ul.lastUpdate>this._tweenTimeTracker?Ul.lastUpdate:this._tweenTimeTracker+t;var e,n=this._tweenTimeTracker;if(n<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback.call(this._object),this._onStartCallbackFired=!0);var i=(n-this._startTime)/this._duration;i=i>1?1:i;var r=this._easingFunction(i);for(e in this._valuesEnd){var o=this._valuesStart[e]||0,s=this._valuesEnd[e];s instanceof Array?this._object[e]=this._interpolationFunction(s,r):("string"==typeof s&&(s=o+parseFloat(s)),"number"==typeof s&&(this._object[e]=o+(s-o)*r))}if(null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._object,r),1===i){if(this._repeat>0){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var a=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=a}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),this._startTime=n+this._delayTime,!0}Ul.world.removeChildNow(this),null!==this._onCompleteCallback&&this._onCompleteCallback.call(this._object);for(var u=0,l=this._chainedTweens.length;u<l;u++)this._chainedTweens[u].start(n);return!1}return!0}}],[{key:"Easing",get:function(){return Gc}},{key:"Interpolation",get:function(){return Hc}}]),t}(),Wc={offscreenCanvas:!1,willReadFrequently:!1,antiAlias:!1},Xc=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wc;c(this,t),i=Object.assign(Wc,i||{}),this.canvas=Oc(e,n,i.offscreenCanvas),this.context=this.canvas.getContext("2d",{willReadFrequently:i.willReadFrequently}),this.setAntiAlias(i.antiAlias)}return d(t,[{key:"onResetEvent",value:function(t,e){this.clear(),this.resize(t,e)}},{key:"clear",value:function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"setAntiAlias",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.canvas;wr("imageSmoothingEnabled",t,this.context),void 0!==e.style&&(!0!==t?(e.style["image-rendering"]="optimizeSpeed",e.style["image-rendering"]="-moz-crisp-edges",e.style["image-rendering"]="-o-crisp-edges",e.style["image-rendering"]="-webkit-optimize-contrast",e.style["image-rendering"]="optimize-contrast",e.style["image-rendering"]="crisp-edges",e.style["image-rendering"]="pixelated",e.style.msInterpolationMode="nearest-neighbor"):e.style["image-rendering"]="auto")}},{key:"resize",value:function(t,e){this.canvas.width=Math.round(t),this.canvas.height=Math.round(e)}},{key:"destroy",value:function(){this.context=void 0,this.canvas=void 0}},{key:"width",get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)}},{key:"height",get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)}}]),t}();function Kc(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.font=e.font,t.fillStyle=e.fillStyle.toRGBA(),!0===n&&(t.strokeStyle=e.strokeStyle.toRGBA(),t.lineWidth=e.lineWidth),t.textAlign=e.textAlign,t.textBaseline=e.textBaseline}var qc=function(t){o(n,t);var e=a(n);function n(t){var i;return c(this,n),(i=e.call(this)).ancestor=t,i.setMinMax(0,0,0,0),i}return d(n,[{key:"lineHeight",value:function(){return this.ancestor instanceof $c?this.ancestor.fontSize*this.ancestor.lineHeight:this.ancestor.fontData.capHeight*this.ancestor.lineHeight*this.ancestor.fontScale.y}},{key:"lineWidth",value:function(t,e){if(this.ancestor instanceof $c)return e.measureText(t).width;for(var n=t.split(""),i=0,r=null,o=0;o<n.length;o++){var s=n[o].charCodeAt(0),a=this.ancestor.fontData.glyphs[s],u=r&&r.kerning?r.getKerning(s):0;i+=(a.xadvance+u)*this.ancestor.fontScale.x,r=a}return i}},{key:"measureText",value:function(t,e){var n;n=Array.isArray(t)?t:(""+t).split("\n"),void 0!==e&&(e.save(),Kc(e,this.ancestor)),this.width=this.height=0;for(var i=0;i<n.length;i++)this.width=Math.max(this.lineWidth(n[i].trimRight(),e),this.width),this.height+=this.lineHeight();return this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this.x=Math.floor("right"===this.ancestor.textAlign?this.ancestor.pos.x-this.width:"center"===this.ancestor.textAlign?this.ancestor.pos.x-this.width/2:this.ancestor.pos.x),this.y=Math.floor(0===this.ancestor.textBaseline.search(/^(top|hanging)$/)?this.ancestor.pos.y:"middle"===this.ancestor.textBaseline?this.ancestor.pos.y-this.lineHeight()/2:this.ancestor.pos.y-this.lineHeight()),void 0!==e&&e.restore(),this}},{key:"wordWrap",value:function(t,e,n){var i,r="",o=[];Array.isArray(t)&&(t=t.join(" ")),i=t.replace(/[\r\n]+/g," ").split(" "),void 0!==n&&(n.save(),Kc(n,this.ancestor));for(var s=0;s<i.length;s++){var a=i[s];this.lineWidth(r+a+" ",n)<e?r+=a+" ":(o.push(r+"\n"),r=a+" ")}return o.push(r),void 0!==n&&n.restore(),o}}]),n}(za),Zc=["ex","em","pt","px"],Jc=[12,24,.75,1],Qc=function(t,e){return!0===e.offScreenCanvas?e.canvasTexture.context:(void 0===t&&(t=Pc),t.getFontContext())},$c=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;return c(this,n),(o=e.call(this,t,i,r.width||0,r.height||0)).onResetEvent(t,i,r),o}return d(n,[{key:"onResetEvent",value:function(t,e,n){void 0!==n.fillStyle?n.fillStyle instanceof Qr?this.fillStyle=n.fillStyle:this.fillStyle=Gr.pull("Color").parseCSS(n.fillStyle):this.fillStyle=Gr.pull("Color",0,0,0),void 0!==n.strokeStyle?n.strokeStyle instanceof Qr?this.strokeStyle=n.strokeStyle:this.strokeStyle=Gr.pull("Color").parseCSS(n.strokeStyle):this.strokeStyle=Gr.pull("Color",0,0,0),this.lineWidth=n.lineWidth||1,this.textAlign=n.textAlign||"left",this.textBaseline=n.textBaseline||"top",this.lineHeight=n.lineHeight||1,this.offScreenCanvas=!1,this.wordWrapWidth=n.wordWrapWidth||-1,this._text=[],this.fontSize=10,void 0!==n.anchorPoint?this.anchorPoint.setV(n.anchorPoint):this.anchorPoint.set(0,0),void 0!==n.floating&&(this.floating=!!n.floating),this.setFont(n.font,n.size),!0===n.bold&&this.bold(),!0===n.italic&&this.italic(),!0===n.offScreenCanvas&&(this.offScreenCanvas=!0,this.canvasTexture=Gr.pull("CanvasTexture",2,2,{offscreenCanvas:!0})),this.metrics=new qc(this),this.setText(n.text)}},{key:"bold",value:function(){return this.font="bold "+this.font,this.isDirty=!0,this}},{key:"italic",value:function(){return this.font="italic "+this.font,this.isDirty=!0,this}},{key:"setFont",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=t.split(",").map((function(t){return t=t.trim(),/(^".*"$)|(^'.*'$)/.test(t)?t:'"'+t+'"'}));if("number"==typeof e)this.fontSize=e,e+="px";else{var i=e.match(/([-+]?[\d.]*)(.*)/);this.fontSize=parseFloat(i[1]),i[2]?this.fontSize*=Jc[Zc.indexOf(i[2])]:e+="px"}return this.height=this.fontSize,this.font=e+" "+n.join(","),this.isDirty=!0,this}},{key:"setText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=this.getBounds();if(this._text.toString()!==t.toString()&&(Array.isArray(t)?this._text=t:this._text=(""+t).split("\n")),this._text.length>0&&this.wordWrapWidth>0&&(this._text=this.metrics.wordWrap(this._text,this.wordWrapWidth,Qc(Pc,this))),e.addBounds(this.metrics.measureText(this._text,Qc(Pc,this)),!0),!0===this.offScreenCanvas){var n=Math.ceil(this.metrics.width),i=Math.ceil(this.metrics.height);Pc instanceof xc&&(this.glTextureUnit=Pc.cache.getUnit(Pc.cache.get(this.canvasTexture.canvas)),Pc.currentCompositor.unbindTexture2D(null,this.glTextureUnit),1===Pc.WebGLVersion&&(n=Ar(this.metrics.width),i=Ar(this.metrics.height))),(this.canvasTexture.width<n||this.canvasTexture.height<i)&&this.canvasTexture.resize(n,i),this.canvasTexture.clear(),this._drawFont(this.canvasTexture.context,this._text,this.pos.x-this.metrics.x,this.pos.y-this.metrics.y,!1)}return this.isDirty=!0,this}},{key:"measureText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._text;return this.metrics.measureText(e,Qc(t,this))}},{key:"draw",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pos.x,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.pos.y,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];void 0===this.ancestor?(this.pos.x===n&&this.pos.y===i||(this.pos.x=n,this.pos.y=i,this.isDirty=!0),this.setText(e),n=this.metrics.x,i=this.metrics.y,t.save(),t.setGlobalAlpha(t.globalAlpha()*this.getOpacity())):(n=this.pos.x,i=this.pos.y),!1===t.settings.subPixel&&(n=~~n,i=~~i),!0===this.offScreenCanvas?t.drawImage(this.canvasTexture.canvas,n,i):t.drawFont(this._drawFont(t.getFontContext(),this._text,n,i,r)),void 0===this.ancestor&&t.restore()}},{key:"drawStroke",value:function(t,e,n,i){this.draw(t,e,n,i,!0)}},{key:"_drawFont",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Kc(t,this,r);for(var o=0;o<e.length;o++){var s=e[o].trimRight();t[r?"strokeText":"fillText"](s,n,i),i+=this.metrics.lineHeight()}return this.metrics}},{key:"destroy",value:function(){!0===this.offScreenCanvas&&(Pc instanceof xc&&(Pc.currentCompositor.deleteTexture2D(Pc.currentCompositor.getTexture2D(this.glTextureUnit)),this.glTextureUnit=void 0),Pc.cache.delete(this.canvasTexture.canvas),Gr.push(this.canvasTexture),this.canvasTexture=void 0),Gr.push(this.fillStyle),Gr.push(this.strokeStyle),this.fillStyle=this.strokeStyle=void 0,this.metrics=void 0,this._text.length=0,i(h(n.prototype),"destroy",this).call(this)}}]),n}(gl),tf=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;return c(this,n),(o=e.call(this,t,i,r.width||0,r.height||0)).textAlign=r.textAlign||"left",o.textBaseline=r.textBaseline||"top",o.lineHeight=r.lineHeight||1,o.wordWrapWidth=r.wordWrapWidth||-1,o._text=[],o.fontScale=Gr.pull("Vector2d",1,1),o.fontImage="object"===p(r.font)?r.font:$h.getImage(r.font),"string"!=typeof r.fontData?o.fontData=Gr.pull("BitmapTextData",$h.getBinary(r.font)):o.fontData=Gr.pull("BitmapTextData",r.fontData.includes("info face")?r.fontData:$h.getBinary(r.fontData)),void 0!==r.floating&&(o.floating=!!r.floating),void 0!==r.fillStyle&&(r.fillStyle instanceof Qr?o.fillStyle.setColor(r.fillStyle):o.fillStyle.parseCSS(r.fillStyle)),void 0!==r.anchorPoint?o.anchorPoint.set(r.anchorPoint.x,r.anchorPoint.y):o.anchorPoint.set(0,0),o.metrics=new qc(l(o)),"number"==typeof r.size&&1!==r.size&&o.resize(r.size),o.setText(r.text),o}return d(n,[{key:"set",value:function(t,e){return this.textAlign=t,e&&this.resize(e),this.isDirty=!0,this}},{key:"setText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._text.toString()!==t.toString()&&(Array.isArray(t)?this._text=t:this._text=(""+t).split("\n"),this.isDirty=!0),this._text.length>0&&this.wordWrapWidth>0&&(this._text=this.metrics.wordWrap(this._text,this.wordWrapWidth)),this.getBounds().addBounds(this.metrics.measureText(this._text),!0),this}},{key:"fillStyle",get:function(){return this.tint},set:function(t){this.tint=t}},{key:"resize",value:function(t){return this.fontScale.set(t,t),this.getBounds().addBounds(this.metrics.measureText(this._text),!0),this.isDirty=!0,this}},{key:"measureText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._text;return this.metrics.measureText(t)}},{key:"draw",value:function(t,e,n,i){var r=t.globalAlpha();void 0===this.ancestor?(this.setText(e),t.setGlobalAlpha(r*this.getOpacity())):(n=this.pos.x,i=this.pos.y);for(var o=n,s=this.metrics.lineHeight(),a=0,u=0;u<this._text.length;u++){n=o;var l=this._text[u].trimRight(),h=this.metrics.lineWidth(l);switch(this.textAlign){case"right":n-=h;break;case"center":n-=.5*h}switch(this.textBaseline){case"middle":i-=.5*s;break;case"ideographic":case"alphabetic":case"bottom":i-=s}!0===this.isDirty&&void 0===this.ancestor&&(0===u&&(this.pos.y=i),a<h&&(a=h,this.pos.x=n));for(var c=null,f=0,d=l.length;f<d;f++){var p=l.charCodeAt(f),v=this.fontData.glyphs[p],y=v.width,g=v.height,m=c&&c.kerning?c.getKerning(p):0;0!==y&&0!==g&&t.drawImage(this.fontImage,v.x,v.y,y,g,n+v.xoffset,i+v.yoffset*this.fontScale.y,y*this.fontScale.x,g*this.fontScale.y),n+=(v.xadvance+m)*this.fontScale.x,c=v}i+=s}void 0===this.ancestor&&t.setGlobalAlpha(r),this.isDirty=!1}},{key:"destroy",value:function(){Gr.push(this.fontScale),this.fontScale=void 0,Gr.push(this.fontData),this.fontData=void 0,this._text.length=0,this.metrics=void 0,i(h(n.prototype),"destroy",this).call(this)}}]),n}(gl),ef=function(){function t(){c(this,t),this.id=0,this.x=0,this.y=0,this.width=0,this.height=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.xoffset=0,this.yoffset=0,this.xadvance=0,this.fixedWidth=!1}return d(t,[{key:"getKerning",value:function(t){if(this.kerning){var e=this.kerning[t>>>9];if(e)return e[511&t]||0}return 0}},{key:"setKerning",value:function(t,e){this.kerning||(this.kerning={});var n=this.kerning[t>>>9];void 0===n&&(this.kerning[t>>>9]={},n=this.kerning[t>>>9]),n[511&t]=e}}]),t}(),nf=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function rf(t,e){var n=t.match(e);if(!n)throw new Error("Could not find pattern "+e+" in string: "+t);return n[0].split("=")[1]}var of=function(){function t(e){c(this,t),this.onResetEvent(e)}return d(t,[{key:"onResetEvent",value:function(t){this.padTop=0,this.padRight=0,this.padBottom=0,this.padLeft=0,this.lineHeight=0,this.capHeight=1,this.descent=0,this.glyphs={},this.parse(t)}},{key:"parse",value:function(t){if(!t)throw new Error("File containing font data was empty, cannot load the bitmap font.");var e=t.split(/\r\n|\n/),n=t.match(/padding\=\d+,\d+,\d+,\d+/g);if(!n)throw new Error("Padding not found in first line");var i=n[0].split("=")[1].split(",");this.padTop=parseFloat(i[0]),this.padLeft=parseFloat(i[1]),this.padBottom=parseFloat(i[2]),this.padRight=parseFloat(i[3]),this.lineHeight=parseFloat(rf(e[1],/lineHeight\=\d+/g));var r,o=parseFloat(rf(e[1],/base\=\d+/g)),s=this.padTop+this.padBottom,a=null;for(r=4;r<e.length;r++){var u=e[r],l=u.split(/=|\s+/);if(u&&!/^kernings/.test(u))if(/^kerning\s/.test(u)){var h=parseFloat(l[2]),c=parseFloat(l[4]),f=parseFloat(l[6]);null!=(a=this.glyphs[h])&&a.setKerning(c,f)}else{a=new ef;var d=parseFloat(l[2]);a.id=d,a.x=parseFloat(l[4]),a.y=parseFloat(l[6]),a.width=parseFloat(l[8]),a.height=parseFloat(l[10]),a.xoffset=parseFloat(l[12]),a.yoffset=parseFloat(l[14]),a.xadvance=parseFloat(l[16]),a.width>0&&a.height>0&&(this.descent=Math.min(o+a.yoffset,this.descent)),this.glyphs[d]=a}}this.descent+=this.padBottom,function(t){var e=" ".charCodeAt(0),n=t[e];n||((n=new ef).id=e,n.xadvance=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)if(e[n]>32)return t[e[n]];return null}(t).xadvance,t[e]=n)}(this.glyphs);var p=null;for(r=0;r<nf.length;r++){var v=nf[r];if(p=this.glyphs[v.charCodeAt(0)])break}if(p)this.capHeight=p.height;else for(var y in this.glyphs)if(this.glyphs.hasOwnProperty(y)){if(0===(a=this.glyphs[y]).height||0===a.width)continue;this.capHeight=Math.max(this.capHeight,a.height)}this.capHeight-=s}}]),t}(),sf=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;return c(this,n),(o=e.call(this,0,0,1/0,1/0)).color=Gr.pull("Color").parseCSS(i),o.onResetEvent(t,i,r),o}return d(n,[{key:"onResetEvent",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.name=t,this.pos.z=n,this.floating=!0,this.color.parseCSS(e)}},{key:"draw",value:function(t,e){t.save(),t.clipRect(0,0,e.width,e.height),t.clearColor(this.color),t.restore()}},{key:"destroy",value:function(){Gr.push(this.color),this.color=void 0,i(h(n.prototype),"destroy",this).call(this)}}]),n}(gl),af=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;return c(this,n),(o=e.call(this,t,i,r)).floating=!0,o.offset.set(t,i),o.ratio=Gr.pull("Vector2d",1,1),void 0!==r.ratio&&(pr(r.ratio)?o.ratio.set(r.ratio,+r.ratio):o.ratio.setV(r.ratio)),void 0===r.anchorPoint?o.anchorPoint.set(0,0):"number"==typeof r.anchorPoint?o.anchorPoint.set(r.anchorPoint,r.anchorPoint):o.anchorPoint.setV(r.anchorPoint),o.repeat=r.repeat||"repeat",Fo(Bo,o.createPattern,l(o)),o}return d(n,[{key:"repeat",get:function(){return this._repeat},set:function(t){switch(this._repeat=t,this._repeat){case"no-repeat":this.repeatX=!1,this.repeatY=!1;break;case"repeat-x":this.repeatX=!0,this.repeatY=!1;break;case"repeat-y":this.repeatX=!1,this.repeatY=!0;break;default:this.repeatX=!0,this.repeatY=!0}this.resize(Ul.viewport.width,Ul.viewport.height),this.createPattern()}},{key:"onActivateEvent",value:function(){var t=this;Fo(Lo,this.updateLayer,this),Fo(Mo,this.resize,this),No(bo,(function(){t.updateLayer(Ul.viewport.pos)})),!0!==this.ancestor.root&&this.updateLayer(Ul.viewport.pos)}},{key:"resize",value:function(t,e){return i(h(n.prototype),"resize",this).call(this,this.repeatX?1/0:t,this.repeatY?1/0:e)}},{key:"createPattern",value:function(){this._pattern=Pc.createPattern(this.image,this._repeat)}},{key:"updateLayer",value:function(t){var e=this.ratio.x,n=this.ratio.y;if(0!==e||0!==n){var i=this.width,r=this.height,o=Ul.viewport.bounds.width,s=Ul.viewport.bounds.height,a=this.anchorPoint.x,u=this.anchorPoint.y,l=a*(e-1)*(o-Ul.viewport.width)+this.offset.x-e*t.x,h=u*(n-1)*(s-Ul.viewport.height)+this.offset.y-n*t.y;this.repeatX?this.pos.x=l%i:this.pos.x=l,this.repeatY?this.pos.y=h%r:this.pos.y=h,this.isDirty=!0}}},{key:"preDraw",value:function(t){t.save(),t.setGlobalAlpha(t.globalAlpha()*this.getOpacity()),t.setTint(this.tint)}},{key:"draw",value:function(t,e){var n=this.width,i=this.height,r=e.bounds.width,o=e.bounds.height,s=this.anchorPoint.x,a=this.anchorPoint.y,u=this.pos.x,l=this.pos.y;0===this.ratio.x&&0===this.ratio.y&&(u+=s*(r-n),l+=a*(o-i)),t.translate(u,l),t.drawPattern(this._pattern,0,0,2*e.width,2*e.height)}},{key:"onDeactivateEvent",value:function(){zo(Lo,this.updateLayer),zo(Mo,this.resize)}},{key:"destroy",value:function(){Gr.push(this.ratio),this.ratio=void 0,zo(Bo,this.createPattern),i(h(n.prototype),"destroy",this).call(this)}}]),n}(tc),uf=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;if(c(this,n),o=e.call(this,t,i,r),"number"!=typeof r.width||"number"!=typeof r.height)throw new Error("height and width properties are mandatory");return o.width=Math.floor(r.width),o.height=Math.floor(r.height),o.nss_width=o.width,o.nss_height=o.height,o.insetx=r.insetx,o.insety=r.insety,o}return d(n,[{key:"draw",value:function(t){var e=this.current,n=this.pos.x,i=this.pos.y,r=e.width,o=e.height,s=e.offset,a=this.offset;0!==e.angle&&(t.translate(-n,-i),t.rotate(e.angle),n-=o,r=e.height,o=e.width);var u=a.x+s.x,l=a.y+s.y,h=this.insetx||r/4,c=this.insety||o/4;t.drawImage(this.image,u,l,h,c,n,i,h,c),t.drawImage(this.image,u+r-h,l,h,c,n+this.nss_width-h,i,h,c),t.drawImage(this.image,u,l+o-c,h,c,n,i+this.nss_height-c,h,c),t.drawImage(this.image,u+r-h,l+o-c,h,c,n+this.nss_width-h,i+this.nss_height-c,h,c);var f=r-(h<<1),d=o-(c<<1),p=this.nss_width-(h<<1),v=this.nss_height-(c<<1);t.drawImage(this.image,u+h,l,f,c,n+h,i,p,c),t.drawImage(this.image,u+h,l+o-c,f,c,n+h,i+this.nss_height-c,p,c),t.drawImage(this.image,u,l+c,h,d,n,i+c,h,v),t.drawImage(this.image,u+r-h,l+c,h,d,n+this.nss_width-h,i+c,h,v),t.drawImage(this.image,u+h,l+c,f,d,n+h,i+c,p,v)}}]),n}(tc),lf=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;return c(this,n),(o=e.call(this,t,i,r)).isClickable=!0,o.holdThreshold=250,o.isHoldable=!1,o.hover=!1,o.holdTimeout=null,o.released=!0,o.floating=!0,o.isKinematic=!1,o}return d(n,[{key:"clicked",value:function(t){if(0===t.button&&this.isClickable)return this.dirty=!0,this.released=!1,this.isHoldable&&(null!==this.holdTimeout&&Fc.clearTimeout(this.holdTimeout),this.holdTimeout=Fc.setTimeout(this.hold.bind(this),this.holdThreshold,!1),this.released=!1),this.onClick(t)}},{key:"onClick",value:function(t){return!1}},{key:"enter",value:function(t){return this.hover=!0,this.dirty=!0,this.onOver(t)}},{key:"onOver",value:function(t){}},{key:"leave",value:function(t){return this.hover=!1,this.dirty=!0,this.release(t),this.onOut(t)}},{key:"onOut",value:function(t){}},{key:"release",value:function(t){if(!1===this.released)return this.released=!0,this.dirty=!0,Fc.clearTimeout(this.holdTimeout),this.onRelease(t)}},{key:"onRelease",value:function(){return!1}},{key:"hold",value:function(){Fc.clearTimeout(this.holdTimeout),this.dirty=!0,this.released||this.onHold()}},{key:"onHold",value:function(){}},{key:"onActivateEvent",value:function(){nl("pointerdown",this,this.clicked.bind(this)),nl("pointerup",this,this.release.bind(this)),nl("pointercancel",this,this.release.bind(this)),nl("pointerenter",this,this.enter.bind(this)),nl("pointerleave",this,this.leave.bind(this))}},{key:"onDeactivateEvent",value:function(){il("pointerdown",this),il("pointerup",this),il("pointercancel",this),il("pointerenter",this),il("pointerleave",this),Fc.clearTimeout(this.holdTimeout)}}]),n}(tc),hf=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;c(this,n),(o=e.call(this,t,i,r)).name=r.name,o.type=r.type,o.id=r.id;var s=r.shapes;return void 0===s&&(s=Gr.pull("Polygon",0,0,[Gr.pull("Vector2d",0,0),Gr.pull("Vector2d",o.width,0),Gr.pull("Vector2d",o.width,o.height)])),o.body=new Rl(l(o),s),o.body.collisionType=Ml.types.COLLECTABLE_OBJECT,o.body.setCollisionMask(Ml.types.PLAYER_OBJECT),o.body.setStatic(!0),r.anchorPoint?o.anchorPoint.set(r.anchorPoint.x,r.anchorPoint.y):o.anchorPoint.set(0,0),o}return d(n)}(tc),cf=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;c(this,n),(o=e.call(this,t,i,r.width||0,r.height||0)).anchorPoint.set(0,0),o.fade=r.fade,o.duration=r.duration,o.fading=!1,o.name="Trigger",o.type=r.type,o.id=r.id,o.gotolevel=r.to,o.triggerSettings={event:"level"},["type","container","onLoaded","flatten","setViewportBounds","to"].forEach(function(t){void 0!==r[t]&&(this.triggerSettings[t]=r[t])}.bind(l(o)));var s=r.shapes;return void 0===s&&(s=Gr.pull("Polygon",0,0,[Gr.pull("Vector2d",0,0),Gr.pull("Vector2d",o.width,0),Gr.pull("Vector2d",o.width,o.height)])),o.body=new Rl(l(o),s),o.body.collisionType=Ml.types.ACTION_OBJECT,o.body.setCollisionMask(Ml.types.PLAYER_OBJECT),o.body.setStatic(!0),o.resize(o.body.getBounds().width,o.body.getBounds().height),o}return d(n,[{key:"getTriggerSettings",value:function(){return"string"==typeof this.triggerSettings.container&&(this.triggerSettings.container=Ul.world.getChildByName(this.triggerSettings.container)[0]),this.triggerSettings}},{key:"onFadeComplete",value:function(){Dh.load(this.gotolevel,this.getTriggerSettings()),Ul.viewport.fadeOut(this.fade,this.duration)}},{key:"triggerEvent",value:function(){var t=this.getTriggerSettings();if("level"!==t.event)throw new Error("Trigger invalid type");this.gotolevel=t.to,this.fade&&this.duration?this.fading||(this.fading=!0,Ul.viewport.fadeIn(this.fade,this.duration,this.onFadeComplete.bind(this))):Dh.load(this.gotolevel,t)}},{key:"onCollision",value:function(t,e){return"Trigger"===this.name&&this.triggerEvent.apply(this),!1}}]),n}(gl);function ff(t){var e,n,i,r,o,s=t.texture.context,a=t.texture.width/2,u=t.texture.height/2,l=t.radiusX,h=t.radiusY;t.texture.clear(),l>=h?(e=1,i=1,n=h/l,r=l/h,o=s.createRadialGradient(a,u*r,0,a,h*r,l)):(n=1,r=1,e=l/h,i=h/l,o=s.createRadialGradient(a*i,u,0,a*i,u,h)),o.addColorStop(0,t.color.toRGBA(t.intensity)),o.addColorStop(1,t.color.toRGBA(0)),s.fillStyle=o,s.setTransform(e,0,0,n,0,0),s.fillRect(0,0,t.texture.width*i,t.texture.height*r)}var df=function(t){o(n,t);var e=a(n);function n(t,i,r){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#FFF",u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.7;return c(this,n),(o=e.call(this,t,i,2*r,2*s)).color=Gr.pull("Color").parseCSS(a),o.radiusX=r,o.radiusY=s,o.intensity=u,o.blendMode="lighter",o.visibleArea=Gr.pull("Ellipse",o.centerX,o.centerY,o.width,o.height),o.texture=Gr.pull("CanvasTexture",o.width,o.height,{offscreenCanvas:!1}),o.anchorPoint.set(0,0),ff(l(o)),o}return d(n,[{key:"getVisibleArea",value:function(){return this.visibleArea.setShape(this.getBounds().centerX,this.getBounds().centerY,this.width,this.height)}},{key:"draw",value:function(t,e){t.drawImage(this.texture.canvas,this.getBounds().x,this.getBounds().y)}},{key:"destroy",value:function(){Gr.push(this.color),this.color=void 0,Gr.push(this.texture),this.texture=void 0,Gr.push(this.visibleArea),this.visibleArea=void 0,i(h(n.prototype),"destroy",this).call(this)}}]),n}(gl),pf={width:1,height:1,image:void 0,textureSize:8,tint:"#fff",totalParticles:50,angle:Math.PI/2,angleVariation:0,minLife:1e3,maxLife:3e3,speed:2,speedVariation:1,minRotation:0,maxRotation:0,minStartScale:1,maxStartScale:1,minEndScale:0,maxEndScale:0,gravity:0,wind:0,followTrajectory:!1,textureAdditive:!1,blendMode:"normal",onlyInViewport:!0,floating:!1,maxParticles:10,frequency:100,duration:1/0,framesToSkip:0};function vf(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Gr.pull("CanvasTexture",t,e,{offscreenCanvas:!0});return n.context.fillStyle="#fff",n.context.fillRect(0,0,t,e),n}var yf=function(t){o(n,t);var e=a(n);function n(t,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c(this,n),(r=e.call(this,t,i,1|o.width,1|o.height)).settings={},r.centerOn(t,i),r._stream=!1,r._frequencyTimer=0,r._durationTimer=0,r._enabled=!1,r.alwaysUpdate=!0,r.autoSort=!1,r._updateCount=0,r._dt=0,r.reset(o),r}return d(n,[{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.settings,pf,t),void 0===this.settings.image&&(this._defaultParticle=vf(t.textureSize,t.textureSize),this.settings.image=this._defaultParticle.canvas),this.floating=this.settings.floating,this.isDirty=!0}},{key:"getRandomPointX",value:function(){return Mr(0,this.getBounds().width)}},{key:"getRandomPointY",value:function(){return Mr(0,this.getBounds().height)}},{key:"addParticles",value:function(t){for(var e=0;e<t;e++)this.addChild(Gr.pull("Particle",this),this.pos.z);this.isDirty=!0}},{key:"isRunning",value:function(){return this._enabled&&this._stream}},{key:"streamParticles",value:function(t){this._enabled=!0,this._stream=!0,this.settings.frequency=Math.max(1,this.settings.frequency),this._durationTimer="number"==typeof t?t:this.settings.duration}},{key:"stopStream",value:function(){this._enabled=!1}},{key:"burstParticles",value:function(t){this._enabled=!0,this._stream=!1,this.addParticles("number"==typeof t?t:this.settings.totalParticles),this._enabled=!1}},{key:"update",value:function(t){if(++this._updateCount>this.settings.framesToSkip&&(this._updateCount=0),this._updateCount>0)return this._dt+=t,this.isDirty;if(t+=this._dt,this._dt=0,this.isDirty|=i(h(n.prototype),"update",this).call(this,t),this._enabled&&this._stream){if(this._durationTimer!==1/0&&(this._durationTimer-=t,this._durationTimer<=0))return this.stopStream(),this.isDirty;this._frequencyTimer+=t;var e=this.children.length;e<this.settings.totalParticles&&this._frequencyTimer>=this.settings.frequency&&(e+this.settings.maxParticles<=this.settings.totalParticles?this.addParticles(this.settings.maxParticles):this.addParticles(this.settings.totalParticles-e),this._frequencyTimer=0,this.isDirty=!0)}return this.isDirty}},{key:"destroy",value:function(){i(h(n.prototype),"destroy",this).call(this,arguments),void 0!==this._defaultParticle&&(Gr.push(this._defaultParticle),this._defaultParticle=void 0),this.settings.image=void 0,this.settings=void 0}}]),n}(jl),gf=function(t){o(n,t);var e=a(n);function n(t){var i;return c(this,n),(i=e.call(this,t.getRandomPointX(),t.getRandomPointY(),t.settings.image.width,t.settings.image.height)).onResetEvent(t,!0),i}return d(n,[{key:"onResetEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!1===e?(this.pos.set(t.getRandomPointX(),t.getRandomPointY()),this.resize(t.settings.image.width,t.settings.image.height),this.currentTransform.identity()):this.vel=Gr.pull("Vector2d"),this.image=t.settings.image,this.alwaysUpdate=!0,"string"==typeof t.settings.tint&&this.tint.parseCSS(t.settings.tint),!0===t.settings.textureAdditive&&(this.blendMode="additive"),"normal"!==t.settings.blendMode&&(this.blendMode=t.settings.blendMode);var n=t.settings.angle+(t.settings.angleVariation>0?(Mr(0,2)-1)*t.settings.angleVariation:0),i=t.settings.speed+(t.settings.speedVariation>0?(Mr(0,2)-1)*t.settings.speedVariation:0);this.vel.set(i*Math.cos(n),-i*Math.sin(n)),this.life=Mr(t.settings.minLife,t.settings.maxLife),this.startLife=this.life,this.startScale=Or(Mr(t.settings.minStartScale,t.settings.maxStartScale),t.settings.minStartScale,t.settings.maxStartScale),this.endScale=Or(Mr(t.settings.minEndScale,t.settings.maxEndScale),t.settings.minEndScale,t.settings.maxEndScale),this.gravity=t.settings.gravity,this.wind=t.settings.wind,this.followTrajectory=t.settings.followTrajectory,this.onlyInViewport=t.settings.onlyInViewport,this._deltaInv=Fc.maxfps/1e3,t.settings.followTrajectory||(this.angle=Mr(t.settings.minRotation,t.settings.maxRotation))}},{key:"update",value:function(t){var e=t*this._deltaInv;if(this.life=this.life>t?this.life-t:0,this.life<=0)return this.ancestor.removeChild(this),!1;var r=this.life/this.startLife,o=this.startScale;this.startScale>this.endScale?o=(o*=r)<this.endScale?this.endScale:o:this.startScale<this.endScale&&(o=(o/=r)>this.endScale?this.endScale:o),this.alpha=r,this.vel.x+=this.wind*e,this.vel.y+=this.gravity*e;var s=this.followTrajectory?Math.atan2(this.vel.y,this.vel.x):this.angle;return this.pos.x+=this.vel.x*e,this.pos.y+=this.vel.y*e,this.currentTransform.setTransform(o,0,0,0,o,0,this.pos.x,this.pos.y,1).rotate(s),this.isDirty=this.inViewport||!this.onlyInViewport,i(h(n.prototype),"update",this).call(this,t)}},{key:"draw",value:function(t){var e=this.width,n=this.height;t.drawImage(this.image,0,0,e,n,-e/2,-n/2,e,n)}}]),n}(gl),mf=function(t){o(n,t);var e=a(n);function n(t,i,r){var o;if(c(this,n),"number"!=typeof r.width||"number"!=typeof r.height)throw new Error("height and width properties are mandatory when passing settings parameters to an object entity");return(o=e.call(this,t,i,r.width,r.height)).children=[],r.image&&(r.framewidth=r.framewidth||r.width,r.frameheight=r.frameheight||r.height,o.renderable=new tc(0,0,r)),r.anchorPoint?o.anchorPoint.set(r.anchorPoint.x,r.anchorPoint.y):o.anchorPoint.set(0,0),"string"==typeof r.name&&(o.name=r.name),o.type=r.type||"",o.id=r.id||"",o.alive=!0,void 0===r.shapes&&(r.shapes=Gr.pull("Polygon",0,0,[Gr.pull("Vector2d",0,0),Gr.pull("Vector2d",o.width,0),Gr.pull("Vector2d",o.width,o.height),Gr.pull("Vector2d",0,o.height)])),o.body=new Rl(l(o),r.shapes,o.onBodyUpdate.bind(l(o))),0===o.width&&0===o.height&&o.resize(o.body.getBounds().width,o.body.getBounds().height),o.body.setCollisionMask(r.collisionMask),o.body.setCollisionType(r.collisionType),o.autoTransform=!1,o}return d(n,[{key:"renderable",get:function(){return this.children[0]},set:function(t){if(!(t instanceof gl))throw new Error(t+"should extend me.Renderable");this.children[0]=t,this.children[0].ancestor=this}},{key:"update",value:function(t){return this.renderable&&(this.isDirty|=this.renderable.update(t)),i(h(n.prototype),"update",this).call(this,t)}},{key:"onBodyUpdate",value:function(t){this.getBounds().addBounds(t.getBounds(),!0),this.updateBoundsPos(this.pos.x,this.pos.y)}},{key:"preDraw",value:function(t){t.save(),t.translate(this.pos.x+this.body.getBounds().x,this.pos.y+this.body.getBounds().y),this.renderable instanceof gl&&t.translate(this.anchorPoint.x*this.body.getBounds().width,this.anchorPoint.y*this.body.getBounds().height)}},{key:"draw",value:function(t,e){var n=this.renderable;n instanceof gl&&(n.preDraw(t),n.draw(t,e),n.postDraw(t))}},{key:"destroy",value:function(){this.renderable&&(this.renderable.destroy.apply(this.renderable,arguments),this.children.splice(0,1)),i(h(n.prototype),"destroy",this).call(this,arguments)}},{key:"onDeactivateEvent",value:function(){this.renderable&&this.renderable.onDeactivateEvent&&this.renderable.onDeactivateEvent()}}]),n}(gl);Object.defineProperty(Va.prototype,"Texture",{get:function(){return function(t,e,n){var i="melonJS: %s is deprecated since version %s, please use %s",r=(new Error).stack;console.groupCollapsed?console.groupCollapsed("%c"+i,"font-weight:normal;color:yellow;",t,n,e):console.warn(i,t,n,e),void 0!==r&&console.warn(r),console.groupCollapsed&&console.groupEnd()}("me.video.renderer.Texture","me.TextureAtlas","10.4.0"),nc}});var bf="13.0.0",xf=!1;Us((function(){!0!==xf&&(Gr.register("me.Entity",mf),Gr.register("me.Collectable",hf),Gr.register("me.Trigger",cf),Gr.register("me.Light2d",df),Gr.register("me.Tween",Yc,!0),Gr.register("me.Color",Qr,!0),Gr.register("me.Particle",gf,!0),Gr.register("me.Sprite",tc),Gr.register("me.NineSliceSprite",uf),Gr.register("me.Renderable",gl),Gr.register("me.Text",$c,!0),Gr.register("me.BitmapText",tf),Gr.register("me.BitmapTextData",of,!0),Gr.register("me.ImageLayer",af),Gr.register("me.ColorLayer",sf,!0),Gr.register("me.Vector2d",Hr,!0),Gr.register("me.Vector3d",au,!0),Gr.register("me.ObservableVector2d",su,!0),Gr.register("me.ObservableVector3d",uu,!0),Gr.register("me.Matrix2d",to,!0),Gr.register("me.Matrix3d",$r,!0),Gr.register("me.Rect",Ba,!0),Gr.register("me.RoundRect",Da,!0),Gr.register("me.Polygon",ja,!0),Gr.register("me.Line",Na,!0),Gr.register("me.Ellipse",Fa,!0),Gr.register("me.Bounds",za,!0),Gr.register("Entity",mf),Gr.register("Collectable",hf),Gr.register("Trigger",cf),Gr.register("Light2d",df),Gr.register("Tween",Yc,!0),Gr.register("Color",Qr,!0),Gr.register("Particle",gf,!0),Gr.register("Sprite",tc),Gr.register("NineSliceSprite",uf),Gr.register("Renderable",gl),Gr.register("Text",$c,!0),Gr.register("BitmapText",tf),Gr.register("BitmapTextData",of,!0),Gr.register("ImageLayer",af),Gr.register("ColorLayer",sf,!0),Gr.register("Vector2d",Hr,!0),Gr.register("Vector3d",au,!0),Gr.register("ObservableVector2d",su,!0),Gr.register("ObservableVector3d",uu,!0),Gr.register("Matrix2d",to,!0),Gr.register("Matrix3d",$r,!0),Gr.register("Rect",Ba,!0),Gr.register("RoundRect",Da,!0),Gr.register("Polygon",ja,!0),Gr.register("Line",Na,!0),Gr.register("Ellipse",Fa,!0),Gr.register("Bounds",za,!0),Gr.register("CanvasTexture",Xc,!0),Do(ro),$h.setNocache(Bc.getUriFragment().nocache||!1),mu(),xf=!0)}));var wf=n(3379),_f=n.n(wf),kf=n(3380),Tf=n.n(kf),Ef=n(569),Sf=n.n(Ef),Af=n(3565),Pf=n.n(Af),Of=n(609),Cf=n.n(Of),Mf=n(4589),Rf=n.n(Mf),If=n(1424),Lf={};Lf.styleTagTransform=Rf(),Lf.setAttributes=Pf(),Lf.insert=Sf().bind(null,"head"),Lf.domAPI=Tf(),Lf.insertStyleElement=Cf(),_f()(If.Z,Lf),If.Z&&If.Z.locals&&If.Z.locals;const jf={environment:"dev",appName:"{{applicationName}}",appVersion:"{{applicationVersion}}",baseURL:"",readHighscoreURL:null,createGameURL:null,writeScoreURL:null,writePlayerMovementURL:null,readPlayerMovementsURL:null,fakeNameURL:null,local:{baseURL:"http://localhost:8080/"},dev:{baseURL:"http://grumpycat-cat-dev.apps.demo5.ocp.lan/"},test:{baseURL:"http://grumpycat-cat-stage.apps.demo5.ocp.lan/"},prod:{baseURL:"{{baseURL}}"}};function Bf(t){return Bf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bf(t)}function Df(){Df=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function a(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=e&&e.prototype instanceof c?e:c,o=Object.create(r.prototype),s=new k(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=x(s,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var h={};function c(){}function f(){}function d(){}var p={};a(p,r,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(T([])));y&&y!==e&&n.call(y,r)&&(p=y);var g=d.prototype=c.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,s,a){var u=l(t[r],t,o);if("throw"!==u.type){var h=u.arg,c=h.value;return c&&"object"==Bf(c)&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(c).then((function(t){h.value=t,s(h)}),(function(t){return i("throw",t,s,a)}))}a(u.arg)}var r;this._invoke=function(t,n){function o(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(o,o):o()}}function x(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=l(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function T(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,a(g,"constructor",d),a(d,"constructor",f),f.displayName=a(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(b.prototype),a(b.prototype,o,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new b(u(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},m(g),a(g,s,"Generator"),a(g,r,(function(){return this})),a(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=T,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;_(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Ff(t,e,n,i,r,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function Nf(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Vf(t,e,n){return e&&Uf(t.prototype,e),n&&Uf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var Gf=function(){function t(e,n,i,r){zf(this,t),this.info=e,this.id=e.id,this.name=n,this.longName=i,this.data=r,this.description=r.description}return Vf(t,[{key:"loadIntoMelon",value:function(){$h.load({name:this.id,src:this.info.path,type:"tmx",format:"json",data:this.data},this.paul)}},{key:"paul",value:function(){}}]),t}(),Hf=null,Yf=[{id:"level1",path:"maps/0.json",loaded:!1,error:!1},{id:"level2",path:"maps/1.json",loaded:!1,error:!1},{id:"level3",path:"maps/2.json",loaded:!1,error:!1},{id:"level4",path:"maps/3.json",loaded:!1,error:!1},{id:"level5",path:"maps/4.json",loaded:!1,error:!1}],Wf=function(){function t(){zf(this,t),Nf(this,"allLevels",[]),Nf(this,"currentLevel",0)}var e,n;return Vf(t,[{key:"_constructor",value:function(){}},{key:"_loadLevelData",value:(e=Df().mark((function t(e){var n,i,r,o,s;return Df().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=jf.baseURL+e.path,i=this,console.log("  LevelManager: Loading level '"+e.id+"'"),t.next=5,fetch(n);case 5:return r=t.sent,t.next=8,r.json();case 8:return o=t.sent,s=new Gf(e,o.name,o.longName,o),console.log("  Loaded: "+e.id),i.allLevels.push(s),s.loadIntoMelon(),t.abrupt("return",o);case 14:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(t){Ff(o,i,r,s,a,"next",t)}function a(t){Ff(o,i,r,s,a,"throw",t)}s(void 0)}))},function(t){return n.apply(this,arguments)})},{key:"initialize",value:function(t){for(var e=[],n=0;n<Yf.length;n++)e.push(this._loadLevelData(Yf[n]));Promise.all(e).then((function(e){console.log("  All Levels loaded: "+e),t()})).catch((function(t){console.log("  LevelManager: Failed loading level "+t)}))}},{key:"getCurrentLevel",value:function(){return this.allLevels[this.currentLevel]}},{key:"getCurrentLevelId",value:function(){return this.allLevels[this.currentLevel].id}},{key:"getCurrentLevelIndex",value:function(){return this.currentLevel}},{key:"reset",value:function(){this.currentLevel=0}},{key:"next",value:function(){return this.currentLevel++,this.currentLevel>this.allLevels.length&&this.reset(),this.getCurrentLevel()}},{key:"prev",value:function(){return this.currentLevel--,this.currentLevel<0&&this.reset(),this.getCurrentLevel()}},{key:"hasNextLevel",value:function(){return this.currentLevel<this.allLevels.length}},{key:"prepareCurrentLevel",value:function(){Dh.load(this.getCurrentLevel().id)}}],[{key:"getInstance",value:function(){return null==Hf&&(console.log("Creating LevelManager instance"),Hf=new t),Hf}}]),t}();const Xf={globalServerGame:null,globalServerVersion:null,screenControlsTexture:null,enemyStunnedTime:5e3,playerInvincibleTime:3e3,scoreForPills:10,scoreForBombs:50,scoreForMeat:25,scoreForCheese:15,scoreForStunningCat:50,scoreForKillingSpider:100,energyForMeat:10,energyForCheese:5,bombsForBombBonus:5,energyLostBySpider:15,energyLostByCat:10,energyOnBegin:100,energy:100,score:0,bombs:0,invincible:!1,isGameOver:!1,placedBarriers:0,usedBombs:0,bittenBySpiders:0,catchedByCats:0,killedSpiders:0,stunnedCats:0,reset:function(){this.energy=this.energyOnBegin,Wf.getInstance().reset(),this.score=0,this.bombs=0,this.invincible=!1,this.isGameOver=!1,this.placedBarriers=0,this.usedBombs=0,this.bittenBySpiders=0,this.catchedByCats=0,this.killedSpiders=0,this.stunnedCats=0}};function Kf(t){return Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kf(t)}function qf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Jf(t,e,n){return e&&Zf(t.prototype,e),n&&Zf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qf(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$f(t,e)}function $f(t,e){return $f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$f(t,e)}function td(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=id(t);if(e){var r=id(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return ed(this,n)}}function ed(t,e){if(e&&("object"===Kf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return nd(t)}function nd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function id(t){return id=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},id(t)}var rd=function(t){Qf(n,t);var e=td(n);function n(t){var i;return qf(this,n),(i=e.call(this,0,Ul.viewport.height-40,{font:"ArialFancy",textAlign:"left",fillStyle:"white",size:1.5,text:t})).textWidth=i.measureText().width,i.scrollingText=t,i.scrollerpos=Ul.viewport.width,i.scrollertween=new Yc(nd(i)).to({scrollerpos:-i.textWidth},2e4).repeat(1/0).start(),i}return Jf(n,[{key:"onDestroyEvent",value:function(){this.scrollertween.stop()}},{key:"repeatScrolling",value:function(){this.scrollerpos=Ul.viewport.width,this.scrollertween.to({scrollerpos:-this.textWidth},0).onComplete(this.repeatScrolling.bind(this)).start()}},{key:"update",value:function(t){return this.pos.x=Math.round(this.scrollerpos),!0}}]),n}(tf),od=function(t){Qf(n,t);var e=td(n);function n(){var t;return qf(this,n),(t=e.call(this)).isPersistent=!0,t.floating=!0,t.z=10,t.setOpacity(1),t.name="TitleBack",t.backgroundImage=new tc(Ul.viewport.width/2,Ul.viewport.height/2,{image:$h.getImage("sensa_grass")}),t.backgroundImage.scale(Ul.viewport.width/t.backgroundImage.width,Ul.viewport.height/t.backgroundImage.height),t.backgroundImage.setOpacity(.3),t.catLeftImage=new tc(5,Ul.viewport.height-300,{image:$h.getImage("grumpy_cat_right"),anchorPoint:new Hr(0,0)}),t.catRightImage=new tc(Ul.viewport.width-180,Ul.viewport.height-300,{image:$h.getImage("grumpy_cat_left"),anchorPoint:new Hr(0,0)}),t.titleText=new tc(86,0,{image:$h.getImage("title"),anchorPoint:new Hr(0,0)}),t.subTitleText=new tf(126,170,{font:"12Outline",size:"1",fillStyle:"white",textAlign:"left",text:"A JavaScript / melonJS client. Written by Wanja Pernath",offScreenCanvas:!1}),t.subVersionText=new tf(126,186,{font:"12Outline",size:"1",fillStyle:"white",textAlign:"left",text:"Server API: "+Xf.globalServerVersion.appName+"@"+Xf.globalServerVersion.appVersion+" at "+jf.baseURL,offScreenCanvas:!1}),t.addChild(t.backgroundImage,0),t.addChild(t.catLeftImage,5),t.addChild(t.catRightImage,5),t.addChild(t.titleText,2),t.addChild(t.subTitleText,5),t.addChild(t.subVersionText,5),t.addChild(new rd("QUARKUS GRUMPYCAT. A GAME WRITTEN BY WANJA PERNATH, INSPIRED BY FAT CAT AND PAC MAN. THIS GAME IS USING A QUARKUS BACKEND TO LOAD AND STORE DATA FROM/TO A SERVER................................")),t}return Jf(n)}(jl);function sd(t){return sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sd(t)}function ad(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ud(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ld(t,e,n){return e&&ud(t.prototype,e),n&&ud(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hd(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cd(t,e)}function cd(t,e){return cd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cd(t,e)}function fd(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=gd(t);if(e){var r=gd(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return dd(this,n)}}function dd(t,e){if(e&&("object"===sd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return pd(t)}function pd(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vd(){return vd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=yd(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},vd.apply(this,arguments)}function yd(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gd(t)););return t}function gd(t){return gd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},gd(t)}var md=function(t){hd(n,t);var e=fd(n);function n(t,i,r){var o,s;ad(this,n),s=e.call(this,t,i),r.font=r.font||"24Outline",r.size=r.size||1,r.text=r.text||"<Click Me>",r.bindKey=r.bindKey||-1,r.backgroundColor=r.backgroundColor||"#00aa00",r.hoverColor=r.hoverColor||"#00ff00",r.borderStrokeColor=r.borderStrokeColor||"#000000",r.offScreenCanvas=r.offScreenCanvas||!1,r.fillStyle=r.fillStyle||"#ffffff",r.lineWidth=r.lineWidth||1,r.anchorPoint=r.anchorPoint||new Hr(0,0);var a=new tf(t,i,r),u=a.measureText();r.borderWidth=r.borderWidth||u.width+16,r.borderHeight=r.borderHeight||u.height+16;var l=new Da(t,i,r.borderWidth,r.borderHeight);return vd((o=pd(s),gd(n.prototype)),"setShape",o).call(o,t,i,l.getBounds().width,l.getBounds().height),s.font=a,s.dimensions=u,s.border=l,s.settings=r,s.font.pos.set(Math.round((l.width-u.width)/2)+s.font.pos.x,Math.round((l.height-u.height)/2)+s.font.pos.y),s.isClickable=!0,s.holdThreshold=250,s.isHoldable=!1,s.hover=!1,s.holdTimeout=null,s.released=!0,s.floating=!0,s.isKinematic=!1,s}return ld(n,[{key:"draw",value:function(t){t.setGlobalAlpha(.5),this.hover?t.setColor(this.settings.hoverColor):t.setColor(this.settings.backgroundColor),t.fill(this.border),t.setGlobalAlpha(1),t.setColor(this.settings.borderStrokeColor),t.stroke(this.border),this.font.draw(t,this.settings.text,this.font.pos.x,this.font.pos.y)}},{key:"clicked",value:function(t){if(0===t.button&&this.isClickable)return this.dirty=!0,this.released=!1,this.isHoldable&&(null!==this.holdTimeout&&Fc.clearTimeout(this.holdTimeout),this.holdTimeout=Fc.setTimeout(this.hold.bind(this),this.holdThreshold,!1),this.released=!1),this.onClick(t)}},{key:"onClick",value:function(t){return!1}},{key:"enter",value:function(t){return this.hover=!0,this.dirty=!0,this.onOver(t)}},{key:"onOver",value:function(t){}},{key:"leave",value:function(t){return this.hover=!1,this.dirty=!0,this.release(t),this.onOut(t)}},{key:"onOut",value:function(t){}},{key:"release",value:function(t){if(!1===this.released)return this.released=!0,this.dirty=!0,Fc.clearTimeout(this.holdTimeout),this.onRelease(t)}},{key:"onRelease",value:function(){return!1}},{key:"hold",value:function(){Fc.clearTimeout(this.holdTimeout),this.dirty=!0,this.released||this.onHold()}},{key:"onHold",value:function(){}},{key:"onActivateEvent",value:function(){yl.registerPointerEvent("pointerdown",this,this.clicked.bind(this)),yl.registerPointerEvent("pointerup",this,this.release.bind(this)),yl.registerPointerEvent("pointercancel",this,this.release.bind(this)),yl.registerPointerEvent("pointerenter",this,this.enter.bind(this)),yl.registerPointerEvent("pointerleave",this,this.leave.bind(this))}},{key:"onDeactivateEvent",value:function(){yl.releasePointerEvent("pointerdown",this.hitbox),yl.releasePointerEvent("pointerup",this),yl.releasePointerEvent("pointercancel",this),yl.releasePointerEvent("pointerenter",this),yl.releasePointerEvent("pointerleave",this),Fc.clearTimeout(this.holdTimeout)}}]),n}(jl),bd=function(t){hd(n,t);var e=fd(n);function n(t,i){return ad(this,n),e.call(this,t,i,{text:"Play",borderWidth:250})}return ld(n,[{key:"onClick",value:function(t){ch.change(ch.READY)}}]),n}(md),xd=function(t){hd(n,t);var e=fd(n);function n(t,i){return ad(this,n),e.call(this,t,i,{text:"Replay",borderWidth:250})}return ld(n,[{key:"onClick",value:function(t){ch.change(ch.READY)}}]),n}(md),wd=function(t){hd(n,t);var e=fd(n);function n(t,i){return ad(this,n),e.call(this,t,i,{text:"Highscores",borderWidth:250})}return ld(n,[{key:"onClick",value:function(t){ch.change(ch.SCORE)}}]),n}(md),_d=function(t){hd(n,t);var e=fd(n);function n(){var t;ad(this,n),(t=e.call(this,0,0)).isPersistent=!0,t.floating=!0,t.z=100,t.setOpacity(1),t.name="TitleMenu";var i=Math.round((Ul.viewport.width-250)/2);return t.addChild(new bd(i,300)),t.addChild(new xd(i,360)),t.addChild(new wd(i,420)),t}return ld(n)}(jl);function kd(t){return kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kd(t)}function Td(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ed(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Sd(t,e){return Sd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sd(t,e)}function Ad(t,e){if(e&&("object"===kd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Pd(t){return Pd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pd(t)}var Od=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sd(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pd(i);if(r){var n=Pd(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Ad(this,t)});function s(){return Td(this,s),o.apply(this,arguments)}return e=s,(n=[{key:"onResetEvent",value:function(){console.log("Title.OnEnter()"),Xf.reset(),Wf.getInstance().reset(),this.background=new od,this.menu=new _d,Ul.world.addChild(this.background),Ul.world.addChild(this.menu),this.handler=Uo.on(Uo.KEYDOWN,(function(t,e,n){ch.isCurrent(ch.MENU)&&("pause"===t&&(ch.isPaused()?ch.resume():ch.pause()),"bomb"===t&&ch.change(ch.READY),"fullscreen"===t&&(Qs.isFullscreen?Qs.exitFullscreen():Qs.requestFullscreen()))}))}},{key:"onDestroyEvent",value:function(){console.log("Title.OnExit()"),Ul.world.removeChild(this.background),Ul.world.removeChild(this.menu),Uo.off(Uo.KEYDOWN,this.handler)}}])&&Ed(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(Kl);function Cd(t){return Cd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cd(t)}function Md(t,e){return Md=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Md(t,e)}function Rd(t,e){if(e&&("object"===Cd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Id(t)}function Id(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ld(t){return Ld=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ld(t)}function jd(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Dd(t,e,n){return e&&Bd(t.prototype,e),n&&Bd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Nd=Dd((function t(e,n){Fd(this,t),this.dx=e,this.dy=n})),zd=Dd((function t(e,n,i){Fd(this,t),this.x=e,this.y=n,this.initialDir=i})),Ud=function(){function t(){Fd(this,t),this.elements={},this.head=0,this.tail=0}return Dd(t,[{key:"enqueue",value:function(t){this.elements[this.tail]=t,this.tail++}},{key:"dequeue",value:function(){var t=this.elements[this.head];return delete this.elements[this.head],this.head++,t}},{key:"peek",value:function(){return this.elements[this.head]}},{key:"length",get:function(){return this.tail-this.head}},{key:"isEmpty",get:function(){return 0===this.length}},{key:"clear",value:function(){this.elements={},this.head=0,this.tail=0}}]),t}(),Vd=[new Nd(-1,0),new Nd(0,-1),new Nd(0,1),new Nd(1,0)],Gd=[new Nd(-1,0),new Nd(0,-1),new Nd(0,1),new Nd(1,0),new Nd(-1,-1),new Nd(1,1),new Nd(1,-1),new Nd(-1,1)],Hd="CAT",Yd="SPIDER",Wd=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Md(t,e)}(r,t);var e,n,i=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=Ld(e);if(n){var r=Ld(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return Rd(this,t)});function r(t,e,n,o,s){var a;Fd(this,r),jd(Id(a=i.call(this,32*t-n/2,32*e-o/2,{width:n,height:o,image:s,framewidth:n,frameheight:o})),"borderLayer",void 0),jd(Id(a),"discoveredPlaces",[]),jd(Id(a),"nextPositionFound",!1),jd(Id(a),"player",void 0),jd(Id(a),"mapWidth",void 0),jd(Id(a),"mapHeight",void 0),jd(Id(a),"isDead",!1),jd(Id(a),"isStunned",!1),jd(Id(a),"enemyType",Hd),jd(Id(a),"enemyCanWalkDiagonally",!0),jd(Id(a),"nextPosition",{x:-1,y:-1,dx:0,dy:0,last:{dx:0,dy:0},toString:function(){return"["+this.x+", "+this.y+", "+this.dx+", "+this.dy+"]"}});var u=Dh.getCurrentLevel().getLayers();a.mapWidth=Dh.getCurrentLevel().cols,a.mapHeight=Dh.getCurrentLevel().rows,u.forEach((function(t){"Frame"===t.name&&(a.borderLayer=t)})),a.discoveredPlaces=new Array(a.mapHeight);for(var l=0;l<a.mapHeight;l++){a.discoveredPlaces[l]=new Array(a.mapWidth);for(var h=0;h<a.mapWidth;h++)a.discoveredPlaces[l][h]=!1}return a.alwaysUpdate=!0,a.body=new Rl(Id(a)),a.body.addShape(new Ba(0,0,a.width,a.height)),a.body.ignoreGravity=!0,a.body.collisionType=Ml.types.ENEMY_OBJECT,a.body.setCollisionMask(Ml.types.PLAYER_OBJECT|Ml.types.PROJECTILE_OBJECT),a}return Dd(r,[{key:"calculateNextPosition",value:function(){var t,e=this.transformPosition(this.player.pos.x,this.player.pos.y),n=e.x,i=e.y,r=this.transformPosition(this.pos.x,this.pos.y),o=r.x,s=r.y,a=new Ud,u=this.discoveredPlaces;t=this.enemyCanWalkDiagonally?Gd:Vd;for(var l=0;l<this.mapHeight;l++)for(var h=0;h<this.mapWidth;h++)u[l][h]=!1;for(u[s][o]=!0,a.enqueue(new zd(o,s,null));!a.isEmpty;)for(var c=a.dequeue(),f=0;f<t.length;f++){var d=t[f],p=c.x+d.dx,v=c.y+d.dy,y=null==c.initialDir?d:c.initialDir;if(p==n&&v==i){o+=y.dx,s+=y.dy,this.catX=o,this.catY=s,a.clear(),this.nextPosition.last.dx=this.nextPosition.dx,this.nextPosition.last.dy=this.nextPosition.dy,this.nextPositionFound=!0,this.nextPosition.x=this.catX,this.nextPosition.y=this.catY,this.nextPosition.dx=y.dx*this.SPEED,this.nextPosition.dy=y.dy*this.SPEED;break}this.isWalkable(p,v)&&!u[v][p]&&(u[v][p]=!0,a.enqueue(new zd(p,v,y)))}this.nextPositionFound}},{key:"setPlayer",value:function(t){this.player=t}},{key:"isWalkable",value:function(t,e){return!(t<0||t>=this.mapWidth||e<0||e>=this.mapHeight)&&null===this.borderLayer.cellAt(t,e)}},{key:"transformPosition",value:function(t,e){return{x:Math.floor(t/32),y:Math.floor(e/32)}}}]),r}(tc);function Xd(t){return Xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xd(t)}function Kd(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function qd(){return qd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Zd(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},qd.apply(this,arguments)}function Zd(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tp(t)););return t}function Jd(t,e){return Jd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Jd(t,e)}function Qd(t,e){if(e&&("object"===Xd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $d(t)}function $d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tp(t){return tp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tp(t)}function ep(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var np=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jd(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=tp(i);if(r){var n=tp(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Qd(this,t)});function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),ep($d(n=o.call(this,t,e,32,32,"cat_left")),"SPEED",2),ep($d(n),"updateTime",0),n.enemyType=Hd,n}return e=s,n=[{key:"update",value:function(t){if(this.updateTime+=t,this.updateTime<32)return qd(tp(s.prototype),"update",this).call(this,t),!1;if(this.updateTime=0,!this.isStunned&&(this.nextPositionFound||this.calculateNextPosition(),this.nextPositionFound)){this.pos.x+=this.nextPosition.dx,this.pos.y+=this.nextPosition.dy,this.nextPosition.dx<0?this.flipX(!1):this.nextPosition.dx>0&&this.flipX(!0);var e=Math.floor(this.pos.x/32),n=Math.floor(this.pos.y/32);e==this.nextPosition.x&&n==this.nextPosition.y&&(this.nextPositionFound=!1)}return qd(tp(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){var n=this;return e.body.collisionType===Ml.types.PROJECTILE_OBJECT&&e.isExploding&&!this.isStunned&&(this.isStunned=!0,Xf.score+=Xf.scoreForStunningCat,this.flicker(Xf.enemyStunnedTime,(function(){n.isStunned=!1}))),!1}}],n&&Kd(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(Wd);const ip=np;function rp(t){return rp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rp(t)}function op(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function sp(){return sp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=ap(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},sp.apply(this,arguments)}function ap(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=cp(t)););return t}function up(t,e){return up=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},up(t,e)}function lp(t,e){if(e&&("object"===rp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return hp(t)}function hp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cp(t){return cp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cp(t)}var fp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&up(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=cp(i);if(r){var n=cp(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return lp(this,t)});function s(t,e){var n,i,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),1,(r="SPEED")in(i=hp(n=o.call(this,t,e,64,64,"spider-red")))?Object.defineProperty(i,r,{value:1,enumerable:!0,configurable:!0,writable:!0}):i[r]=1,n.enemyType=Yd,n.addAnimation("stand-up",[0]),n.addAnimation("walk-up",[4,5,6,7,8,9],32),n.addAnimation("attack-up",[0,1,2,3],32),n.addAnimation("stand-left",[10]),n.addAnimation("walk-left",[14,15,16,17,18,19],32),n.addAnimation("attack-left",[10,11,12,13],32),n.addAnimation("stand-down",[20]),n.addAnimation("walk-down",[24,25,26,27,28,29],32),n.addAnimation("attack-down",[20,21,22,23],32),n.addAnimation("stand-right",[30]),n.addAnimation("walk-right",[34,35,36,37,38,39],32),n.addAnimation("attack-right",[30,31,32,33],32),n.addAnimation("die",[40,41,42,43],100),n.addAnimation("dead",[43]),n.setCurrentAnimation("stand-left"),n.enemyCanWalkDiagonally=!1,n}return e=s,n=[{key:"update",value:function(t){if(!this.isStunned&&!this.isDead)if(this.nextPositionFound||this.calculateNextPosition(),this.nextPositionFound){this.pos.x+=this.nextPosition.dx,this.pos.y+=this.nextPosition.dy,this.nextPosition.last.dx==this.nextPosition.dx&&this.nextPosition.last.dy==this.nextPosition.dy||(this.nextPosition.dx<0?this.setCurrentAnimation("walk-left","walk-left"):this.nextPosition.dx>0&&this.setCurrentAnimation("walk-right","walk-right"),this.nextPosition.dy<0?this.setCurrentAnimation("walk-up","walk-up"):this.nextPosition.dy>0&&this.setCurrentAnimation("walk-down","walk-down"));var e=Math.floor(this.pos.x/32),n=Math.floor(this.pos.y/32);e==this.nextPosition.x&&n==this.nextPosition.y&&(this.nextPositionFound=!1)}else this.nextPosition.dx<0?this.setCurrentAnimation("stand-left"):this.nextPosition.dx>0&&this.setCurrentAnimation("stand-right"),this.nextPosition.dy<0?this.setCurrentAnimation("stand-up"):this.nextPosition.dy>0&&this.setCurrentAnimation("stand-down");return sp(cp(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){var n=this;return e.body.collisionType===Ml.types.PROJECTILE_OBJECT?e.isExploding&&(this.isStunned=!0,this.setCurrentAnimation("die",(function(){n.isDead=!0,Xf.killedSpiders++,Xf.score+=Xf.scoreForKillingSpider,n.setCurrentAnimation("dead")}))):e.body.collisionType!==Ml.types.PLAYER_OBJECT||this.isDead||this.isStunned||Xf.invincible||(this.nextPosition.dx<0?this.setCurrentAnimation("attack-left"):this.nextPosition.dx>0&&this.setCurrentAnimation("attack-right"),this.nextPosition.dy<0?this.setCurrentAnimation("attack-up"):this.nextPosition.dy>0&&this.setCurrentAnimation("attack-down")),!1}}],n&&op(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(Wd);function dp(t){return dp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dp(t)}function pp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function vp(){return vp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=yp(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},vp.apply(this,arguments)}function yp(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=xp(t)););return t}function gp(t,e){return gp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gp(t,e)}function mp(t,e){if(e&&("object"===dp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return bp(t)}function bp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xp(t){return xp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xp(t)}function wp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gp(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=xp(i);if(r){var n=xp(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return mp(this,t)});function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),wp(bp(n=o.call(this,t,e,{width:32,height:64,image:"BombExploding",framewidth:32,frameheight:64})),"borderLayer",void 0),wp(bp(n),"isExploding",!1),Dh.getCurrentLevel().getLayers().forEach((function(t){"Frame"===t.name&&(n.borderLayer=t)})),n.body=new Rl(bp(n)),n.body.addShape(new Ba(0,0,n.width,n.height)),n.body.ignoreGravity=!0,n.body.collisionType=Ml.types.PROJECTILE_OBJECT,n.body.setCollisionMask(Ml.types.ENEMY_OBJECT),n.alwaysUpdate=!0,n.addAnimation("bzzz",[0,1,2,3,4,5,6]),n.addAnimation("boom",[7,8,9,10,11,12,13]),n.setCurrentAnimation("bzzz",(function(){Ul.viewport.shake(50,400),this.isExploding=!0,this.setCurrentAnimation("boom",(function(){var t=this;return this.isExploding=!1,Ul.world.removeChild(this),[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}].forEach((function(e){var n=Math.floor((t.pos.x+32*e.x)/32),i=Math.floor((t.pos.y+32*e.y)/32);t.borderLayer.clearTile(n,i)})),!1}))})),n}return e=s,(n=[{key:"update",value:function(t){return vp(xp(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&pp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(tc);const kp=_p;function Tp(t){return Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tp(t)}function Ep(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Sp(){return Sp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Ap(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},Sp.apply(this,arguments)}function Ap(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mp(t)););return t}function Pp(t,e){return Pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pp(t,e)}function Op(t,e){if(e&&("object"===Tp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Cp(t)}function Cp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mp(t){return Mp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mp(t)}function Rp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ip=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pp(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Mp(i);if(r){var n=Mp(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Op(this,t)});function s(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),Rp(Cp(n=o.call(this,t,e,{width:96,height:96,image:"explosion",framewidth:256,frameheight:256})),"borderLayer",void 0),Rp(Cp(n),"isExploding",!1),Dh.getCurrentLevel().getLayers().forEach((function(t){"Frame"===t.name&&(n.borderLayer=t)})),n.body=new Rl(Cp(n)),n.body.addShape(new Ba(0,0,96,96)),n.body.ignoreGravity=!0,n.body.collisionType=Ml.types.PROJECTILE_OBJECT,n.body.setCollisionMask(Ml.types.ENEMY_OBJECT),n.alwaysUpdate=!0,n.addAnimation("boom",[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],16),n.isExploding=!0,n.setCurrentAnimation("boom",(function(){var t=this;Ul.world.removeChild(this),[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}].forEach((function(e){var n=Math.floor((t.pos.x+32*e.x)/32),i=Math.floor((t.pos.y+32*e.y)/32);t.borderLayer.clearTile(n,i)}))})),Ul.viewport.shake(50,992),n}return e=s,(n=[{key:"update",value:function(t){return Sp(Mp(s.prototype),"update",this).call(this,t),!0}},{key:"onCollision",value:function(t,e){return!1}}])&&Ep(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(tc);const Lp=Ip;function jp(t){return jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(t)}function Bp(){Bp=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function a(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=e&&e.prototype instanceof c?e:c,o=Object.create(r.prototype),s=new k(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=x(s,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var h={};function c(){}function f(){}function d(){}var p={};a(p,r,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(T([])));y&&y!==e&&n.call(y,r)&&(p=y);var g=d.prototype=c.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,s,a){var u=l(t[r],t,o);if("throw"!==u.type){var h=u.arg,c=h.value;return c&&"object"==jp(c)&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(c).then((function(t){h.value=t,s(h)}),(function(t){return i("throw",t,s,a)}))}a(u.arg)}var r;this._invoke=function(t,n){function o(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(o,o):o()}}function x(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=l(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function T(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,a(g,"constructor",d),a(d,"constructor",f),f.displayName=a(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(b.prototype),a(b.prototype,o,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new b(u(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},m(g),a(g,s,"Generator"),a(g,r,(function(){return this})),a(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=T,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;_(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Dp(t,e,n,i,r,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function Fp(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function s(t){Dp(o,i,r,s,a,"next",t)}function a(t){Dp(o,i,r,s,a,"throw",t)}s(void 0)}))}}function Np(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function zp(){return zp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Up(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},zp.apply(this,arguments)}function Up(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yp(t)););return t}function Vp(t,e){return Vp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Vp(t,e)}function Gp(t,e){if(e&&("object"===jp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Hp(t)}function Hp(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yp(t){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yp(t)}function Wp(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Xp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vp(t,e)}(u,t);var e,n,i,r,o,s,a=(o=u,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yp(o);if(s){var n=Yp(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Gp(this,t)});function u(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),Wp(Hp(n=a.call(this,32*t+16,32*e+16,{width:32,height:32,framewidth:32,frameheight:32,image:"player"})),"SPEED",4),Wp(Hp(n),"borderLayer",void 0),Wp(Hp(n),"bonusLayer",void 0),Wp(Hp(n),"groundLayer",void 0),Wp(Hp(n),"xInMap",void 0),Wp(Hp(n),"yInMap",void 0),Wp(Hp(n),"mapWidth",void 0),Wp(Hp(n),"mapHeight",void 0),Wp(Hp(n),"collectedBonusTiles",0),Wp(Hp(n),"numberOfBonusTiles",0),n.xInMap=t,n.yInMap=e,n.body=new Rl(Hp(n)),n.body.ignoreGravity=!0,n.body.addShape(new Ba(0,0,n.width,n.height)),n.body.collisionType=Ml.types.PLAYER_OBJECT,n.body.setCollisionMask(Ml.types.ENEMY_OBJECT),Ul.viewport.follow(n.pos,Ul.viewport.AXIS.BOTH,.1),n.alwaysUpdate=!0,n.mapHeight=Dh.getCurrentLevel().rows,n.mapWidth=Dh.getCurrentLevel().cols,Dh.getCurrentLevel().getLayers().forEach((function(t){"Bonus"===t.name?n.bonusLayer=t:"Frame"===t.name?n.borderLayer=t:"Ground"===t.name&&(n.groundLayer=t)}));for(var i=0;i<n.mapWidth;i++)for(var r=0;r<n.mapHeight;r++)null!==n.bonusLayer.cellAt(i,r)&&n.numberOfBonusTiles++;return n}return e=u,n=[{key:"isWalkable",value:function(t,e){var n=Math.floor(t/32),i=Math.floor(e/32),r=this.borderLayer.cellAt(n,i);return null===r||null==r}},{key:"collectBonusTile",value:function(t,e){var n=Math.floor(t/32),i=Math.floor(e/32),r=this.bonusLayer.cellAt(n,i);return null!==r&&null!=r?(this.bonusLayer.clearTile(n,i),r.tileId):0}},{key:"writeHighscore",value:(r=Fp(Bp().mark((function t(){var e;return Bp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e={playerId:Xf.globalServerGame.player.id,gameId:Xf.globalServerGame.id,score:Xf.score,level:Wf.getInstance().getCurrentLevelIndex()+1,name:Xf.globalServerGame.player.name},fetch(jf.writeScoreURL,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 2:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"writePlayerAction",value:(i=Fp(Bp().mark((function t(e){return Bp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:fetch(jf.writePlayerMovementURL,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});case 1:case"end":return t.stop()}}),t)}))),function(t){return i.apply(this,arguments)})},{key:"update",value:function(t){var e=Math.floor(this.pos.x/32),n=Math.floor(this.pos.y/32),i=0,r=0,o={playerId:Xf.globalServerGame.player.id,gameId:Xf.globalServerGame.id,dx:0,dy:0,x:e,y:n,bombPlaced:!1,gutterThrown:!1,gameOver:!1,gameWon:!1,score:Xf.score,time:performance.now()};if(yl.isKeyPressed("barrier")){if(yl.isKeyPressed("left")?i=-1:yl.isKeyPressed("right")&&(i=1),yl.isKeyPressed("up")?r=-1:yl.isKeyPressed("down")&&(r=1),0!=i||0!=r){var s=e+i,a=n+r;if(null==this.borderLayer.cellAt(s,a)){var l=this.groundLayer.cellAt(s,a);null!==l&&l.tileId;var h=this.borderLayer.getTileById(184,s,a);this.borderLayer.setTile(h,s,a),Xf.placedBarriers++,o.dx=i,o.dy=r,o.gutterThrown=!0}}}else if(yl.isKeyPressed("bomb")&&Xf.bombs>0&&(Ul.world.addChild(new kp(this.pos.x,this.pos.y)),Xf.usedBombs++,Xf.bombs--,o.bombPlaced=!0),yl.isKeyPressed("explode")&&Ul.world.addChild(new Lp(this.pos.x,this.pos.y)),yl.isKeyPressed("left")&&(this.flipX(!0),i=-this.SPEED),yl.isKeyPressed("right")&&(this.flipX(!1),i=+this.SPEED),yl.isKeyPressed("up")&&(r=-this.SPEED),yl.isKeyPressed("down")&&(r=+this.SPEED),(0!=i||0!=r)&&this.isWalkable(this.pos.x+i,this.pos.y+r)){this.pos.x+=i,this.pos.y+=r,o.dx=i,o.dy=r;var c=this.collectBonusTile(this.pos.x,this.pos.y);0!==c&&(this.collectedBonusTiles++,961===c?(Xf.bombs+=Xf.bombsForBombBonus,Xf.score+=Xf.scoreForBombs):963===c?Xf.score+=Xf.scoreForPills:966===c?(Xf.energy+=Xf.energyForMeat,Xf.score+=Xf.scoreForMeat):967===c&&(Xf.energy+=Xf.energyForCheese,Xf.score+=Xf.scoreForCheese),this.collectedBonusTiles>=this.numberOfBonusTiles&&(o.gameWon=!0,this.writeHighscore().then((function(){Wf.getInstance().next(),ch.change(ch.READY)})))),this.pos.x<0&&(this.pos.x-=i),this.pos.x>32*this.mapWidth&&(this.pos.x=32*this.mapWidth),this.pos.y<0&&(this.pos.y-=r),this.pos.y>32*this.mapHeight&&(this.pos.y=32*this.mapHeight)}return zp(Yp(u.prototype),"update",this).call(this,t)}},{key:"onCollision",value:function(t,e){return Xf.invincible||e.body.collisionType!==Ml.types.ENEMY_OBJECT||e.isStunned||e.isDead||Xf.isGameOver||(e.enemyType===Hd?(Xf.catchedByCats++,Xf.energy-=Xf.energyLostByCat):e.enemyType===Yd&&(Xf.bittenBySpiders++,Xf.energy-=Xf.energyLostBySpider),console.log("  energy: "+Xf.energy+"/100"),Xf.energy<=0?(console.log("GAME OVER!"),Xf.isGameOver=!0,this.writeHighscore().then((function(){ch.change(ch.GAMEOVER)}))):(Xf.invincible=!0,this.flicker(Xf.playerInvincibleTime,(function(){Xf.invincible=!1})))),!1}}],n&&Np(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(tc);const Kp=Xp;function qp(t){return qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qp(t)}function Zp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qp(t,e,n){return e&&Jp(t.prototype,e),n&&Jp(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $p(){return $p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=tv(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},$p.apply(this,arguments)}function tv(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sv(t)););return t}function ev(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nv(t,e)}function nv(t,e){return nv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nv(t,e)}function iv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=sv(t);if(e){var r=sv(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return rv(this,n)}}function rv(t,e){if(e&&("object"===qp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ov(t)}function ov(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sv(t){return sv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sv(t)}var av=function(t){ev(n,t);var e=iv(n);function n(t,i){var r;return Zp(this,n),(r=e.call(this,Ul.viewport.width+t,i,{font:"Shadow",size:1,fillStyle:"white",strokeStyle:"black",textAlign:"left",lineWidth:2,textBaseline:"top",text:"Score: 999999",offScreenCanvas:!1})).relative=new Hr(t,i),r.score=-1,r.width=-1,Uo.on(Uo.CANVAS_ONRESIZE,function(t,e){this.pos.set(t,e,0).add(this.relative)}.bind(ov(r))),r}return Qp(n,[{key:"draw",value:function(t){-1===this.width&&(console.log("draw(renderer) called"),this.width=this.measureText(t).width,this.pos.x=Ul.viewport.width-this.width+this.relative.x),$p(sv(n.prototype),"draw",this).call(this,t)}},{key:"update",value:function(t){return this.score!=Xf.score&&(this.score=Xf.score,this.isDirty=!0,this.setText("Score: "+this.score.toString().padStart(6,"0")),!0)}}]),n}(tf),uv=function(t){ev(n,t);var e=iv(n);function n(t,i){var r;return Zp(this,n),(r=e.call(this,t,i,{font:"Shadow",size:1,fillStyle:"white",strokeStyle:"black",textAlign:"left",lineWidth:2,textBaseline:"top",text:"Energy: 999",offScreenCanvas:!1})).relative=new Hr(t,i),r.energy=-1,Uo.on(Uo.CANVAS_ONRESIZE,function(t,e){this.pos.set(t,e,0).add(this.relative)}.bind(ov(r))),r}return Qp(n,[{key:"update",value:function(t){return this.energy!=Xf.energy&&(this.energy=Xf.energy,this.isDirty=!0,this.setText("Energy: "+this.energy),!0)}}]),n}(tf),lv=function(t){ev(n,t);var e=iv(n);function n(t,i){var r;return Zp(this,n),(r=e.call(this,Ul.viewport.width/2+t,i,{font:"Shadow",size:1,fillStyle:"white",strokeStyle:"black",textAlign:"left",lineWidth:2,textBaseline:"top",text:"Bombs: 999",offScreenCanvas:!1})).relative=new Hr(t,i),r.bombs=-1,r.width=-1,Uo.on(Uo.CANVAS_ONRESIZE,function(t,e){this.pos.set(t,e,0).add(this.relative)}.bind(ov(r))),r}return Qp(n,[{key:"draw",value:function(t){-1===this.width&&(this.width=this.measureText(t).width,this.pos.x=(Ul.viewport.width-this.width)/2+this.relative.x),$p(sv(n.prototype),"draw",this).call(this,t)}},{key:"update",value:function(t){return this.bombs!=Xf.bombs&&(this.bombs=Xf.bombs,this.isDirty=!0,this.setText("Bombs: "+this.bombs.toString().padStart(3,"0")),!0)}}]),n}(tf),hv=function(t){ev(n,t);var e=iv(n);function n(){var t;return Zp(this,n),(t=e.call(this)).isPersistent=!0,t.floating=!0,t.z=100,t.setOpacity(.8),t.name="HUD",t.addChild(new av(-5,5)),t.addChild(new uv(5,5)),t.addChild(new lv(0,5)),t}return Qp(n)}(jl);function cv(t){return cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cv(t)}function fv(){return fv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=dv(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},fv.apply(this,arguments)}function dv(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_v(t)););return t}function pv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vv(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function yv(t,e,n){return e&&vv(t.prototype,e),n&&vv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function gv(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mv(t,e)}function mv(t,e){return mv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mv(t,e)}function bv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=_v(t);if(e){var r=_v(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return xv(this,n)}}function xv(t,e){if(e&&("object"===cv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return wv(t)}function wv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _v(t){return _v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_v(t)}var kv=function(t){gv(n,t);var e=bv(n);function n(t,i){var r;return pv(this,n),(r=e.call(this,t,i,{image:Xf.screenControlsTexture,region:"shadedDark38"})).setOpacity(.25),r.anchorPoint.set(0,0),r}return yv(n,[{key:"onClick",value:function(t){return this.setOpacity(.5),yl.triggerKeyEvent(yl.KEY.SPACE,!0),!1}},{key:"onRelease",value:function(t){return this.setOpacity(.25),yl.triggerKeyEvent(yl.KEY.SPACE,!1),!1}}]),n}(lf),Tv=function(t){gv(n,t);var e=bv(n);function n(t,i){var r;return pv(this,n),(r=e.call(this,t,i,{image:Xf.screenControlsTexture,region:"shadedDark30"})).setOpacity(.25),r.anchorPoint.set(0,0),r}return yv(n,[{key:"onClick",value:function(t){return this.setOpacity(.5),yl.triggerKeyEvent(yl.KEY.F,!0),yl.triggerKeyEvent(yl.KEY.F,!1),!1}},{key:"onRelease",value:function(t){return this.setOpacity(.25),yl.triggerKeyEvent(yl.KEY.F,!1),!1}}]),n}(lf),Ev=function(t){gv(n,t);var e=bv(n);function n(t,i){var r;return pv(this,n),(r=e.call(this,t,i,{image:Xf.screenControlsTexture,region:"shadedDark14"})).setOpacity(.25),r.anchorPoint.set(0,0),r.isPaused=!1,r}return yv(n,[{key:"onClick",value:function(t){return this.setOpacity(.5),this.isPaused?(this.isPaused=!1,this.tint.setColor(255,255,255)):(this.isPaused=!0,this.tint.setColor(50,50,0)),yl.triggerKeyEvent(yl.KEY.P,!0),!1}},{key:"onRelease",value:function(t){return this.setOpacity(.25),yl.triggerKeyEvent(yl.KEY.P,!1),!1}}]),n}(lf),Sv=function(t){gv(n,t);var e=bv(n);function n(t,i){var r;return pv(this,n),(r=e.call(this,t,i,{image:Xf.screenControlsTexture,region:"shadedDark35"})).setOpacity(.25),r.anchorPoint.set(0,0),r}return yv(n,[{key:"onClick",value:function(t){return this.setOpacity(.5),yl.triggerKeyEvent(yl.KEY.ESC,!0),!1}},{key:"onRelease",value:function(t){return this.setOpacity(.25),yl.triggerKeyEvent(yl.KEY.ESC,!1),!1}}]),n}(lf),Av=function(t){gv(n,t);var e=bv(n);function n(t,i){var r;return pv(this,n),(r=e.call(this,t,i,{image:Xf.screenControlsTexture,region:"shadedDark36"})).setOpacity(.25),r.anchorPoint.set(0,0),r}return yv(n,[{key:"onClick",value:function(t){return this.setOpacity(.5),yl.triggerKeyEvent(yl.KEY.SHIFT,!0),!1}},{key:"onRelease",value:function(t){return this.setOpacity(.25),yl.triggerKeyEvent(yl.KEY.SHIFT,!1),!1}}]),n}(lf),Pv=function(t){gv(n,t);var e=bv(n);function n(t,i){var r;return pv(this,n),(r=e.call(this,t,i,{image:Xf.screenControlsTexture,region:"shadedDark07",anchorPoint:new Hr(0,0)})).pad=new tc(t,i,{image:Xf.screenControlsTexture,region:"shadedDark01",anchorPoint:new Hr(0,0)}),r.relative=new Hr(r.width/2-r.pad.width/2,r.height/2-r.pad.height/2),r.joypad_offset=new Hr,r.setOpacity(.25),r.cursors={up:!1,down:!1,left:!1,right:!1},yl.registerPointerEvent("pointermove",wv(r),r.pointerMove.bind(wv(r))),r}return yv(n,[{key:"onDestroyEvent",value:function(){yl.releasePointerEvent("pointermove",this)}},{key:"pointerMove",value:function(t){if(!1===this.released){var e=Math.round(t.gameScreenX+t.width/2),n=Math.round(t.gameScreenY+t.height/2);this.getBounds().contains(e,n)?!0!==this.cursors.left&&!0!==this.cursors.right&&!0!==this.cursors.up&&!0!==this.cursors.down||this.checkDirection.call(this,e,n):this.onRelease.call(this,t)}}},{key:"checkDirection",value:function(t,e){t=Math.round(t),e=Math.round(e);var n=t-this.pos.x,i=e-this.pos.y,r=this.width/2,o=this.height/2,s=n-r,a=i-o,u=Math.abs(s)>20,l=Math.abs(a)>20;l&&a<0&&(!1===this.cursors.up&&(yl.triggerKeyEvent(yl.KEY.UP,!0),this.cursors.up=!0,this.joypad_offset.y=-(o-i)%this.pad.height/4),!0===this.cursors.down&&(yl.triggerKeyEvent(yl.KEY.DOWN,!1),this.cursors.down=!1)),l&&a>0&&(!1===this.cursors.down&&(yl.triggerKeyEvent(yl.KEY.DOWN,!0),this.cursors.down=!0,this.joypad_offset.y=+(i-o)%this.pad.height/4),!0===this.cursors.up&&(yl.triggerKeyEvent(yl.KEY.UP,!1),this.cursors.up=!1)),u&&s<0&&(!1===this.cursors.left&&(yl.triggerKeyEvent(yl.KEY.LEFT,!0),this.cursors.left=!0,this.joypad_offset.x=-(r-n)%this.pad.width/4),!0===this.cursors.right&&(yl.triggerKeyEvent(yl.KEY.RIGHT,!1),this.cursors.right=!1)),u&&s>0&&(!1===this.cursors.right&&(yl.triggerKeyEvent(yl.KEY.RIGHT,!0),this.cursors.right=!0,this.joypad_offset.x=+(n-r)%this.pad.width/4),!0===this.cursors.left&&(yl.triggerKeyEvent(yl.KEY.LEFT,!1),this.cursors.left=!1))}},{key:"onClick",value:function(t){var e=t.gameScreenX+t.width/2,n=t.gameScreenY+t.height/2;return this.setOpacity(.5),this.checkDirection.call(this,e,n),!1}},{key:"onRelease",value:function(t){return this.setOpacity(.25),!0===this.cursors.left&&(yl.triggerKeyEvent(yl.KEY.LEFT,!1),this.cursors.left=!1),!0===this.cursors.right&&(yl.triggerKeyEvent(yl.KEY.RIGHT,!1),this.cursors.right=!1),!0===this.cursors.up&&(yl.triggerKeyEvent(yl.KEY.UP,!1),this.cursors.up=!1),!0===this.cursors.down&&(yl.triggerKeyEvent(yl.KEY.DOWN,!1),this.cursors.down=!1),this.joypad_offset.set(0,0),!1}},{key:"draw",value:function(t){fv(_v(n.prototype),"draw",this).call(this,t),this.pad.pos.setV(this.pos).add(this.relative).add(this.joypad_offset),this.pad.draw(t)}}]),n}(lf);const Ov=function(t){gv(n,t);var e=bv(n);function n(){var t;pv(this,n),(t=e.call(this)).isPersistent=!0,t.floating=!0,t.z=1/0,t.name="VirtualJoypad",t.pauseButton=new Ev(20,24),t.exitButton=new Sv(Ul.viewport.width-48-20,24),Qs.isMobile&&(t.actionButton=new kv(Ul.viewport.width-200,Ul.viewport.height-150),t.otherButton=new Av(Ul.viewport.width-120,Ul.viewport.height-200),t.joypad=new Pv(50,Ul.viewport.height-200),t.addChild(t.joypad),t.addChild(t.actionButton),t.addChild(t.otherButton)),Qs.isMobile||(t.fullScreenButton=new Tv(90,24),t.addChild(t.fullScreenButton)),t.addChild(t.pauseButton),t.addChild(t.exitButton);var i=wv(t);return Uo.on(Uo.VIEWPORT_ONRESIZE,(function(t,e){Qs.isMobile&&(i.actionButton.pos.set(t-200,e-150,i.button.pos.z),i.otherButton.pos.set(t-120,e-200,i.button.pos.z)),i.exitButton.pos.set(t-48-20,24,i.button.pos.z)})),t}return yv(n)}(jl);function Cv(t){return Cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cv(t)}function Mv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rv(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Iv(){return Iv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Lv(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},Iv.apply(this,arguments)}function Lv(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Fv(t)););return t}function jv(t,e){return jv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jv(t,e)}function Bv(t,e){if(e&&("object"===Cv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Dv(t)}function Dv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fv(t){return Fv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fv(t)}function Nv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var zv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jv(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Fv(i);if(r){var n=Fv(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Bv(this,t)});function s(){var t;Mv(this,s);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return Nv(Dv(t=o.call.apply(o,[this].concat(n))),"player",void 0),Nv(Dv(t),"enemies",[]),Nv(Dv(t),"hudContainer",null),Nv(Dv(t),"virtualJoypad",null),Nv(Dv(t),"enemyEmitter",{isActive:!1,emitAt:{x:0,y:0},emitEvery:5e3,emitTime:5e3,emitCount:10}),t}return e=s,n=[{key:"onResetEvent",value:function(){console.log("Play.OnEnter()"),this.player=null,this.enemies=[],this.enemyEmitter.isActive=!1,this.setupLevel(),this.hudContainer=new hv(0,0),this.virtualJoypad=new Ov,Ul.world.addChild(this.hudContainer),Ul.world.addChild(this.virtualJoypad),this.handler=Uo.on(Uo.KEYDOWN,(function(t,e,n){ch.isCurrent(ch.PLAY)&&("pause"===t&&(ch.isPaused()?ch.resume():ch.pause()),"exit"===t&&ch.change(ch.MENU),"fullscreen"===t&&(console.log("requesting full screen"),Qs.isFullscreen?Qs.exitFullscreen():Qs.requestFullscreen()))}))}},{key:"onDestroyEvent",value:function(){console.log("Play.OnExit()"),Ul.world.removeChild(this.hudContainer),Ul.world.removeChild(this.virtualJoypad),Uo.off(Uo.KEYDOWN,this.handler)}},{key:"update",value:function(t){if(this.enemyEmitter.isActive&&this.enemyEmitter.emitEvery<=0&&this.enemyEmitter.emitCount>0){this.enemyEmitter.emitCount--,this.enemyEmitter.emitEvery=this.enemyEmitter.emitTime;var e=new fp(this.enemyEmitter.emitAt.x,this.enemyEmitter.emitAt.y);e.name="SpiderX",this.enemies.push(e),Ul.world.addChild(e),e.setPlayer(this.player)}return this.enemyEmitter.emitEvery-=t,Iv(Fv(s.prototype),"update",this).call(this,t)}},{key:"setupLevel",value:function(){var t=this;Wf.getInstance().prepareCurrentLevel(),console.log("PLAYING: "+Dh.getCurrentLevelId()),Dh.getCurrentLevel().getLayers().forEach((function(e){if(console.log(e.name),"Persons"===e.name){console.log("  should be not visible");for(var n=0,i=0;i<e.height;i++)for(var r=0;r<e.width;r++){var o=e.cellAt(r,i);if(null!=o)if(993===o.tileId)t.player=new Kp(r,i),t.player.name="Player",console.log("  player at ("+r+"/"+i+"): "+t.player),Ul.world.addChild(t.player);else if(994===o.tileId){var s=new ip(r,i);s.name="CatEnemy"+n++,Ul.world.addChild(s),t.enemies.push(s),console.log("  enemy at ("+r+"/"+i+"): "+s)}else 995===o.tileId&&(t.enemyEmitter.isActive=!0,t.enemyEmitter.emitAt.x=r+1,t.enemyEmitter.emitAt.y=i+1,t.enemyEmitter.emitCount=e.enemyNumEmitting,t.enemyEmitter.emitEvery=e.enemyTimeEmitting,console.log("  enemyEmitter at ("+r+"/"+i+"): "))}}})),this.enemies.forEach((function(e){return e.setPlayer(t.player)}))}}],n&&Rv(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(Kl);const Uv=zv;function Vv(t){return Vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(t)}function Gv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hv(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Yv(t,e,n){return e&&Hv(t.prototype,e),n&&Hv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wv(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xv(t,e)}function Xv(t,e){return Xv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xv(t,e)}function Kv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Jv(t);if(e){var r=Jv(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return qv(this,n)}}function qv(t,e){if(e&&("object"===Vv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Zv(t)}function Zv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jv(t){return Jv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jv(t)}function Qv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $v=function(t){Wv(n,t);var e=Kv(n);function n(t,i,r,o){var s;return Gv(this,n),(s=e.call(this,t,i,r,o)).setOpacity(1),s.levelName=new tf(4,8,{font:"24Outline",size:"1",fillStyle:"white",textAlign:"left",text:Wf.getInstance().getCurrentLevel().longName,offScreenCanvas:!1}),s.levelDescr=new tf(4,40,{font:"12Outline",size:"1",fillStyle:"white",textAlign:"left",text:Wf.getInstance().getCurrentLevel().description,offScreenCanvas:!1}),s.addChild(s.levelName),s.addChild(s.levelDescr),s}return Yv(n)}(jl),ty=function(t){Wv(n,t);var e=Kv(n);function n(){var t;return Gv(this,n),(t=e.call(this)).isPersistent=!0,t.floating=!0,t.z=10,t.setOpacity(1),t.name="TitleBack",t.backgroundImage=new tc(Ul.viewport.width/2,Ul.viewport.height/2,{image:$h.getImage("sensa_grass")}),t.backgroundImage.scale(Ul.viewport.width/t.backgroundImage.width,Ul.viewport.height/t.backgroundImage.height),t.backgroundImage.setOpacity(.3),t.catLeftImage=new tc(5,Ul.viewport.height-300,{image:$h.getImage("grumpy_cat_right"),anchorPoint:new Hr(0,0)}),t.catRightImage=new tc(Ul.viewport.width-180,Ul.viewport.height-300,{image:$h.getImage("grumpy_cat_left"),anchorPoint:new Hr(0,0)}),t.titleText=new tc(86,0,{image:$h.getImage("title"),anchorPoint:new Hr(0,0)}),t.subTitleText=new tf(126,170,{font:"Shadow",size:"1",fillStyle:"white",textAlign:"left",text:"GET READY",offScreenCanvas:!1}),t.addChild(t.backgroundImage,0),t.addChild(t.catLeftImage,5),t.addChild(t.catRightImage,5),t.addChild(t.titleText,2),t.addChild(t.subTitleText,5),t.addChild(new $v(190,Ul.viewport.height-400),Ul.viewport.width-400,Ul.viewport.height-400),t}return Yv(n)}(jl),ey=function(t){Wv(n,t);var e=Kv(n);function n(){var t;Gv(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Qv(Zv(t=e.call.apply(e,[this].concat(r))),"spiders",[]),t}return Yv(n,[{key:"onResetEvent",value:function(){this.spiders=[],console.log("GetReady.OnEnter()"),this.back=new ty,Ul.world.addChild(this.back),this.emitter=new yf(Ul.viewport.width/2,Ul.viewport.height/2+100,{tint:new Qr(255,0,0),width:64,height:64,totalParticles:30,gravity:.02,angle:0,angleVariation:6.283185307179586,speed:2}),Ul.world.addChild(this.emitter),this.emitter.streamParticles(),yl.bindKey(yl.KEY.ENTER,"enter",!0),yl.bindPointer(yl.pointer.LEFT,yl.KEY.ENTER),this.handler=Uo.on(Uo.KEYDOWN,(function(t,e,n){ch.isCurrent(ch.READY)&&(console.log("GetReady.EventHandler()"),"enter"!==t&&"bomb"!==t||ch.change(ch.PLAY),"exit"===t&&ch.change(ch.MENU))}))}},{key:"onDestroyEvent",value:function(){console.log("GetReady.OnExit()"),yl.unbindKey(yl.KEY.ENTER),yl.unbindPointer(yl.pointer.LEFT),Uo.off(Uo.KEYDOWN,this.handler),Ul.world.removeChild(this.back);for(var t=0;t<this.spiders.length;t++)Ul.world.removeChild(this.spiders[t]);Ul.world.removeChild(this.emitter)}}]),n}(Kl);function ny(t){return ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ny(t)}function iy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ry(t,e){return ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ry(t,e)}function oy(t,e){if(e&&("object"===ny(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function sy(t){return sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sy(t)}var ay=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ry(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=sy(i);if(r){var n=sy(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return oy(this,t)});function s(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,0,0,Ul.viewport.width,Ul.viewport.height)).font=new tf(0,0,{font:"PressStart2P"}),t}return e=s,n=[{key:"update",value:function(t){return!0}},{key:"draw",value:function(t){this.font.textAlign="center",this.font.draw(t,"*** GAME OVER ***",Ul.viewport.width,400),this.font.draw(t,"PRESS ENTER",Ul.viewport.width,Ul.viewport.height),this.font.textAlign="left"}},{key:"onDestroyEvent",value:function(){}}],n&&iy(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(gl);function uy(t){return uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uy(t)}function ly(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function cy(t,e){return cy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cy(t,e)}function fy(t,e){if(e&&("object"===uy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dy(t){return dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dy(t)}const py=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cy(t,e)}(s,t);var e,n,i,r,o=(i=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=dy(i);if(r){var n=dy(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return fy(this,t)});function s(){return ly(this,s),o.apply(this,arguments)}return e=s,(n=[{key:"onResetEvent",value:function(){console.log("GameOver.OnEnter()");var t=new tc(Ul.viewport.width/2,Ul.viewport.height/2,{image:$h.getImage("sensa_nee")});t.setOpacity(.5),Ul.world.addChild(t,1),Ul.world.addChild(new ay,10),yl.bindKey(yl.KEY.ENTER,"enter",!0),yl.bindPointer(yl.pointer.LEFT,yl.KEY.ENTER),this.handler=Uo.on(Uo.KEYDOWN,(function(t,e,n){ch.isCurrent(ch.GAMEOVER)&&(console.log("GameOver.EventHandler()"),"enter"!==t&&"bomb"!==t||ch.change(ch.MENU),"exit"===t&&ch.change(ch.MENU))}))}},{key:"onDestroyEvent",value:function(){console.log("GameOver.OnExit()"),yl.unbindKey(yl.KEY.ENTER),yl.unbindPointer(yl.pointer.LEFT),Uo.off(Uo.KEYDOWN,this.handler)}}])&&hy(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),s}(Kl);function vy(t){return vy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vy(t)}function yy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gy(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function my(t,e,n){return e&&gy(t.prototype,e),n&&gy(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function by(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xy(t,e)}function xy(t,e){return xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xy(t,e)}function wy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Sy(t);if(e){var r=Sy(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return _y(this,n)}}function _y(t,e){if(e&&("object"===vy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ky(t)}function ky(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ty(){return Ty="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=Ey(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},Ty.apply(this,arguments)}function Ey(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sy(t)););return t}function Sy(t){return Sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sy(t)}function Ay(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Py=function(t){by(n,t);var e=wy(n);function n(t,i,r,o,s){var a,u;return yy(this,n),Ay(ky(u=e.call(this,r,o,s,32)),"font",void 0),Ay(ky(u),"scoreEntry",void 0),Ay(ky(u),"nameText",void 0),Ay(ky(u),"dateText",void 0),Ay(ky(u),"scoreText",void 0),u.scoreEntry=t,u.position=i,u.posFont=new tf(r,o,{font:"24Outline",size:1,text:i.toString().padStart(2,"0")+".",anchorPoint:new Hr(0,0)}),u.nameFont=new tf(r,o,{font:"24Outline",size:1,text:"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@",anchorPoint:new Hr(0,0)}),u.dateFont=new tf(r+200,o,{font:"24Outline",size:1,text:u.scoreEntry.time,anchorPoint:new Hr(0,0)}),u.scoreFont=new tf(r+350,o,{font:"24Outline",size:1,fillStyle:"#ffffff",text:u.scoreEntry.score,textAlign:"left",anchorPoint:new Hr(0,0)}),u.fontSize=u.nameFont.measureText(),Ty((a=ky(u),Sy(n.prototype)),"setShape",a).call(a,r,o,s,u.fontSize.height+16),u.border=new Ba(r,o,s,u.fontSize.height+16),u.posFont.pos.x+=8,u.posFont.pos.y+=8,u.nameFont.pos.x+=48,u.nameFont.pos.y+=8,u.dateFont.pos.x+=200,u.dateFont.pos.y+=8,u.scoreFont.pos.x+=320,u.scoreFont.pos.y+=8,u.setName("Wanja Pernath"),u.setTime(u.scoreEntry.time),u.setScore(u.scoreEntry.score),u.posText=i.toString().padStart(2,"0")+".",console.log("("+r+", "+o+", "+s+", "+(u.fontSize.height+16)+")"),u}return my(n,[{key:"draw",value:function(t){t.setGlobalAlpha(.5),t.setColor("#008800"),t.fill(this.border),t.setGlobalAlpha(1),t.setColor("#000000"),t.stroke(this.border),t.setColor("#ffffff"),this.posFont.draw(t,this.posText,this.posFont.pos.x,this.posFont.pos.y),this.nameFont.draw(t,this.nameText,this.nameFont.pos.x,this.nameFont.pos.y),this.dateFont.draw(t,this.dateText,this.dateFont.pos.x,this.dateFont.pos.y),this.scoreFont.draw(t,this.scoreText,this.scoreFont.pos.x,this.scoreFont.pos.y)}},{key:"setName",value:function(t){this.nameText=t,this.isDirty=!0}},{key:"setTime",value:function(t){this.dateText=new Date(t).toLocaleDateString(),this.isDirty=!0}},{key:"setScore",value:function(t){this.scoreText=t.toString().padStart(7,"0"),this.isDirty=!0}},{key:"updateScoreEntry",value:function(t){this.scoreEntry=t,this.setName(t.name),this.setTime(t.time),this.setScore(t.score)}}]),n}(jl),Oy=function(t){by(n,t);var e=wy(n);function n(){var t;yy(this,n),Ay(ky(t=e.call(this)),"highscoreComponent",[]),Ay(ky(t),"highscores",[{pos:0,name:"Wanja",playerId:1,gameId:2,score:1e5,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:9e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:8e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:7e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:6e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:5e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:4e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:3e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:2e4,time:new Date(Date.now())},{pos:0,name:"Wanja",playerId:1,gameId:2,score:1e4,time:new Date(Date.now())}]),t.isPersistent=!0,t.floating=!0,t.z=10,t.setOpacity(1),t.name="TitleBack",t.backgroundImage=new tc(Ul.viewport.width/2,Ul.viewport.height/2,{image:$h.getImage("sensa_grass")}),t.backgroundImage.scale(Ul.viewport.width/t.backgroundImage.width,Ul.viewport.height/t.backgroundImage.height),t.backgroundImage.setOpacity(.4),t.addChild(t.backgroundImage),t.titleText=new tc(86,-10,{image:$h.getImage("title"),anchorPoint:new Hr(0,0)}),t.subTitleText=new tf(126,160,{font:"Shadow",size:"1",fillStyle:"white",textAlign:"left",text:"HIGHSCORES",offScreenCanvas:!1}),t.addChild(t.titleText),t.addChild(t.subTitleText);for(var i=0;i<t.highscores.length;i++){var r=t.highscores[i],o=new Py(r,i+1,50,250+42*i,Ul.viewport.width-100,36);t.highscoreComponent.push(o),t.addChild(o)}return t}return my(n,[{key:"updateHighscores",value:function(t){null!=t&&0!=t.length||(t=this.highscores);for(var e=0;e<t.length;e++){var n=t[e];this.highscoreComponent[e].updateScoreEntry(n)}console.log(t)}}]),n}(jl),Cy=function(t){by(n,t);var e=wy(n);function n(){return yy(this,n),e.apply(this,arguments)}return my(n,[{key:"onResetEvent",value:function(){var t=this;this.highscore=new Oy,Ul.world.addChild(this.highscore),yl.bindPointer(yl.pointer.LEFT,yl.KEY.ESC),this.handler=Uo.on(Uo.KEYDOWN,(function(t,e,n){ch.isCurrent(ch.SCORE)&&"exit"===t&&ch.change(ch.MENU)})),fetch(jf.readHighscoreURL).then((function(t){return t.json()})).then((function(e){return t.highscore.updateHighscores(e)})).catch((function(t){return console.log(t)}))}},{key:"onDestroyEvent",value:function(){Uo.off(Uo.KEYDOWN,this.handler),yl.unbindPointer(yl.pointer.LEFT),Ul.world.removeChild(this.highscore)}}]),n}(Kl);const My=[{name:"screen-controls",type:"image",src:"./data/img/screen-controls.png"},{name:"screen-controls",type:"json",src:"./data/img/screen-controls.json"},{name:"PressStart2P",type:"image",src:"./data/fnt/PressStart2P.png"},{name:"PressStart2P",type:"binary",src:"./data/fnt/PressStart2P.fnt"},{name:"24Outline",type:"image",src:"./data/fnt/24Outline.png"},{name:"24Outline",type:"binary",src:"./data/fnt/24Outline.fnt"},{name:"12Outline",type:"image",src:"./data/fnt/12Outline.png"},{name:"12Outline",type:"binary",src:"./data/fnt/12Outline.fnt"},{name:"18Outline",type:"image",src:"./data/fnt/12Outline.png"},{name:"18Outline",type:"binary",src:"./data/fnt/12Outline.fnt"},{name:"ArialFancy",type:"image",src:"./data/fnt/arialfancy.png"},{name:"ArialFancy",type:"binary",src:"./data/fnt/arialfancy.fnt"},{name:"Shadow",type:"image",src:"./data/fnt/Shadow.png"},{name:"Shadow",type:"binary",src:"./data/fnt/Shadow.fnt"},{name:"grumpy_cat_left",type:"image",src:"./data/img/grumpy_cat_left.png"},{name:"grumpy_cat_right",type:"image",src:"./data/img/grumpy_cat_right.png"},{name:"title",type:"image",src:"./data/img/GrumpyCat-Title.png"},{name:"bombs",type:"image",src:"./data/img/BombExploding.png"},{name:"explosion",type:"image",src:"./data/img/explosion4.png"},{name:"spider-red",type:"image",src:"./data/img/spider-red.png"},{name:"terrain",type:"image",src:"./data/img/terrain.png"},{name:"BombExploding",type:"image",src:"./data/img/BombExploding.png"},{name:"sensa_jaa",type:"image",src:"./data/img/sensa_jaa.png"},{name:"sensa_nee",type:"image",src:"./data/img/sensa_nee.png"},{name:"sensa_grass",type:"image",src:"./data/img/sensa_grass.jpeg"},{name:"player",type:"image",src:"./data/img/player.png"},{name:"cat_left",type:"image",src:"./data/img/cat_left.png"},{name:"cat_right",type:"image",src:"./data/img/cat_right.png"},{name:"Terrain",type:"tsx",src:"./data/map/Terrain.json"}];function Ry(t){return Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ry(t)}function Iy(){Iy=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function a(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var r=e&&e.prototype instanceof c?e:c,o=Object.create(r.prototype),s=new k(i||[]);return o._invoke=function(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=x(s,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var h={};function c(){}function f(){}function d(){}var p={};a(p,r,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(T([])));y&&y!==e&&n.call(y,r)&&(p=y);var g=d.prototype=c.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function i(r,o,s,a){var u=l(t[r],t,o);if("throw"!==u.type){var h=u.arg,c=h.value;return c&&"object"==Ry(c)&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):e.resolve(c).then((function(t){h.value=t,s(h)}),(function(t){return i("throw",t,s,a)}))}a(u.arg)}var r;this._invoke=function(t,n){function o(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(o,o):o()}}function x(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var i=l(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,h;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function T(t){if(t){var e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return f.prototype=d,a(g,"constructor",d),a(d,"constructor",f),f.displayName=a(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,s,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(b.prototype),a(b.prototype,o,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new b(u(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},m(g),a(g,s,"Generator"),a(g,r,(function(){return this})),a(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=T,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;_(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Ly(t,e,n,i,r,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function jy(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function s(t){Ly(o,i,r,s,a,"next",t)}function a(t){Ly(o,i,r,s,a,"throw",t)}s(void 0)}))}}function By(){return(By=jy(Iy().mark((function t(){var e,n,i;return Iy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(jf.fakeNameURL);case 2:return e=t.sent,t.next=5,e.text();case 5:return n=t.sent,console.log("name: "+n),t.next=9,fetch(jf.createGameURL+"/version");case 9:return e=t.sent,t.next=12,e.json();case 12:return Xf.globalServerVersion=t.sent,i={name:n,level:"0",player:{name:n}},i=JSON.stringify(i),console.log(i),t.next=18,fetch(jf.createGameURL,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:i});case 18:return e=t.sent,t.next=21,e.json();case 21:Xf.globalServerGame=t.sent,console.log("   Server API: "+JSON.stringify(Xf.globalServerVersion)),console.log("   New game  : "+JSON.stringify(Xf.globalServerGame));case 24:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Qs.onReady((function(){if(Ic.init(1024,768,{parent:"screen",scaleMethod:"fit",renderer:Ic.AUTO,subPixel:!1,doubleBuffering:!0})){ou.init("mp3,ogg");var t,e=jf.environment;"local"===e?t=jf.local.baseURL:"dev"===e?t=jf.dev.baseURL:"test"===e?t=jf.test.baseURL:"prod"===e&&(t=jf.prod.baseURL),$h.setBaseURL("tmx",t),jf.baseURL=t,jf.readHighscoreURL=t+"highscore/10",jf.writeScoreURL=t+"highscore",jf.createGameURL=t+"game",jf.fakeNameURL=t+"faker",jf.writePlayerMovementURL=t+"movement",jf.readPlayerMovementsURL=t+"movement/",$h.crossOrigin="anonymous",Wf.getInstance().initialize((function(){console.log("  Levels are all loaded and initialized! "),$h.preload(My,(function(){Xf.screenControlsTexture=new nc($h.getJSON("screen-controls"),$h.getImage("screen-controls")),ch.set(ch.MENU,new Od),ch.set(ch.PLAY,new Uv),ch.set(ch.READY,new ey),ch.set(ch.GAMEOVER,new py),ch.set(ch.SCORE,new Cy),ch.transition("fade","#000000",500),Gr.register("player",Kp,!0),Gr.register("enemy",ip,!1),Gr.register("bomb",kp,!0),Gr.register("spider",fp,!0),yl.bindKey(yl.KEY.SHIFT,"barrier"),yl.bindKey(yl.KEY.LEFT,"left"),yl.bindKey(yl.KEY.RIGHT,"right"),yl.bindKey(yl.KEY.UP,"up"),yl.bindKey(yl.KEY.E,"explode",!0),yl.bindKey(yl.KEY.P,"pause",!0),yl.bindKey(yl.KEY.DOWN,"down"),yl.bindKey(yl.KEY.SPACE,"bomb",!0),yl.bindKey(yl.KEY.ESC,"exit",!0),yl.bindKey(yl.KEY.F,"fullscreen",!0),function(){return By.apply(this,arguments)}().then((function(){ch.change(ch.MENU)})).catch((function(t){console.log(t)}))}))}))}else alert("Your browser does not support HTML5 canvas.")}))})()})();